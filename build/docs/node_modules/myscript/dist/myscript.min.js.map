{"version":3,"file":"myscript.min.js","sources":["../src/configuration/Constants.js","../src/configuration/LoggerConfig.js","../node_modules/loglevel/lib/loglevel.js","../node_modules/is-primitive/index.js","../node_modules/assign-symbols/index.js","../node_modules/assign-deep/node_modules/kind-of/index.js","../node_modules/assign-deep/index.js","../src/configuration/DefaultConfiguration.js","../node_modules/json-css/lib/jsoncss.min.js","../src/configuration/DefaultPenStyle.js","../src/configuration/DefaultTheme.js","../src/grabber/PointerEventGrabber.js","../src/renderer/canvas/symbols/StrokeSymbolCanvasRenderer.js","../src/renderer/canvas/symbols/ShapeSymbolCanvasRenderer.js","../src/renderer/canvas/symbols/TextSymbolCanvasRenderer.js","../src/renderer/canvas/symbols/MusicSymbolCanvasRenderer.js","../src/model/StrokeComponent.js","../src/model/Symbol.js","../src/model/InkModel.js","../src/renderer/canvas/CanvasRenderer.js","../src/renderer/QuadraticUtils.js","../src/renderer/canvas/stroker/QuadraticCanvasStroker.js","../node_modules/d3-selection/src/namespaces.js","../node_modules/d3-selection/src/namespace.js","../node_modules/d3-selection/src/creator.js","../node_modules/d3-selection/src/selector.js","../node_modules/d3-selection/src/selectorAll.js","../node_modules/d3-selection/src/matcher.js","../node_modules/d3-selection/src/selection/sparse.js","../node_modules/d3-selection/src/selection/enter.js","../node_modules/d3-selection/src/selection/data.js","../node_modules/d3-selection/src/selection/sort.js","../node_modules/d3-selection/src/window.js","../node_modules/d3-selection/src/selection/classed.js","../node_modules/d3-selection/src/selection/text.js","../node_modules/d3-selection/src/selection/html.js","../node_modules/d3-selection/src/selection/raise.js","../node_modules/d3-selection/src/selection/lower.js","../node_modules/d3-selection/src/selection/insert.js","../node_modules/d3-selection/src/selection/remove.js","../node_modules/d3-selection/src/selection/clone.js","../node_modules/d3-selection/src/selection/on.js","../node_modules/d3-selection/src/selection/dispatch.js","../node_modules/d3-selection/src/selection/index.js","../src/renderer/svg/symbols/StrokeSymbolSVGRenderer.js","../src/renderer/svg/SVGRenderer.js","../node_modules/d3-selection/src/selection/select.js","../node_modules/d3-selection/src/selection/selectAll.js","../node_modules/d3-selection/src/selection/filter.js","../node_modules/d3-selection/src/constant.js","../node_modules/d3-selection/src/selection/exit.js","../node_modules/d3-selection/src/selection/merge.js","../node_modules/d3-selection/src/selection/order.js","../node_modules/d3-selection/src/selection/call.js","../node_modules/d3-selection/src/selection/nodes.js","../node_modules/d3-selection/src/selection/node.js","../node_modules/d3-selection/src/selection/size.js","../node_modules/d3-selection/src/selection/empty.js","../node_modules/d3-selection/src/selection/each.js","../node_modules/d3-selection/src/selection/attr.js","../node_modules/d3-selection/src/selection/style.js","../node_modules/d3-selection/src/selection/property.js","../node_modules/d3-selection/src/selection/append.js","../node_modules/d3-selection/src/selection/datum.js","../node_modules/d3-selection/src/select.js","../src/renderer/svg/stroker/QuadraticSVGStroker.js","../node_modules/crypto-js/core.js","../node_modules/crypto-js/enc-hex.js","../node_modules/crypto-js/x64-core.js","../node_modules/crypto-js/sha512.js","../node_modules/crypto-js/hmac.js","../node_modules/crypto-js/hmac-sha512.js","../src/recognizer/CryptoHelper.js","../src/recognizer/rest/networkInterface.js","../src/model/RecognizerContext.js","../src/recognizer/rest/v3/Cdkv3RestRecognizerUtil.js","../src/recognizer/common/v3/Cdkv3CommonTextRecognizer.js","../src/recognizer/DefaultRecognizer.js","../src/recognizer/rest/v3/Cdkv3RestTextRecognizer.js","../src/recognizer/common/CdkCommonUtil.js","../src/recognizer/common/v3/Cdkv3CommonMathRecognizer.js","../src/recognizer/rest/v3/Cdkv3RestMathRecognizer.js","../src/recognizer/common/v3/Cdkv3CommonShapeRecognizer.js","../src/recognizer/rest/v3/Cdkv3RestAnalyzerRecognizer.js","../src/recognizer/rest/v3/Cdkv3RestShapeRecognizer.js","../src/recognizer/rest/v3/Cdkv3RestMusicRecognizer.js","../src/recognizer/rest/v4/iinkRestRecognizer.js","../src/recognizer/websocket/networkWSInterface.js","../src/recognizer/websocket/v3/Cdkv3WSBuilder.js","../src/recognizer/websocket/CdkWSRecognizerUtil.js","../src/util/PromiseHelper.js","../src/recognizer/websocket/v3/Cdkv3WSMathRecognizer.js","../src/recognizer/websocket/v3/Cdkv3WSTextRecognizer.js","../node_modules/uuid-js/lib/uuid.js","../src/recognizer/websocket/v4/Cdkv4WSBuilder.js","../src/recognizer/websocket/v4/Cdkv4WSIInkRecognizer.js","../src/configuration/DefaultBehaviors.js","../src/callback/EventCallback.js","../src/model/UndoRedoContext.js","../src/model/UndoRedoManager.js","../src/renderer/canvas/ImageRenderer.js","../node_modules/perfect-scrollbar/dist/perfect-scrollbar.esm.js","../node_modules/select/src/select.js","../node_modules/clipboard/lib/clipboard-action.js","../node_modules/tiny-emitter/index.js","../node_modules/good-listener/src/is.js","../node_modules/delegate/src/closest.js","../node_modules/delegate/src/delegate.js","../node_modules/good-listener/src/listen.js","../node_modules/clipboard/lib/clipboard.js","../src/smartguide/SmartGuide.js","../src/eastereggs/InkImporter.js","../src/Editor.js","../src/util/ModelStats.js","../src/EditorFacade.js","../src/myscript.js"],"sourcesContent":["/**\n * @typedef {Object} Constants\n */\n\nconst Constants = {\n  EventType: {\n    IDLE: 'idle',\n    CHANGED: 'changed',\n    IMPORTED: 'imported',\n    EXPORTED: 'exported',\n    CONVERTED: 'converted',\n    RENDERED: 'rendered', // Internal use only\n    LOADED: 'loaded',\n    UNDO: 'undo',\n    REDO: 'redo',\n    CLEAR: 'clear',\n    IMPORT: 'import',\n    SUPPORTED_IMPORT_MIMETYPES: 'supportedImportMimeTypes',\n    EXPORT: 'export',\n    CONVERT: 'convert',\n    ERROR: 'error'\n  },\n  RecognitionType: {\n    TEXT: 'TEXT',\n    MATH: 'MATH',\n    SHAPE: 'SHAPE',\n    MUSIC: 'MUSIC',\n    ANALYZER: 'ANALYZER',\n    DIAGRAM: 'DIAGRAM',\n    NEBO: 'NEBO',\n    RAWCONTENT: 'Raw Content'\n  },\n  Protocol: {\n    WEBSOCKET: 'WEBSOCKET',\n    REST: 'REST'\n  },\n  ModelState: {\n    INITIALIZING: 'INITIALIZING',\n    INITIALIZED: 'INITIALIZED',\n    EXPORTING: 'EXPORTING',\n    EXPORTED: 'EXPORTED',\n    PENDING: 'PENDING',\n    MODIFIED: 'MODIFIED',\n    ERROR: 'ERROR'\n  },\n  Trigger: {\n    QUIET_PERIOD: 'QUIET_PERIOD',\n    POINTER_UP: 'POINTER_UP',\n    DEMAND: 'DEMAND'\n  },\n  Logger: {\n    EDITOR: 'editor',\n    MODEL: 'model',\n    GRABBER: 'grabber',\n    RENDERER: 'renderer',\n    RECOGNIZER: 'recognizer',\n    CALLBACK: 'callback',\n    UTIL: 'util',\n    SMARTGUIDE: 'smartguide'\n  },\n  LogLevel: {\n    TRACE: 'TRACE',\n    DEBUG: 'DEBUG',\n    INFO: 'INFO',\n    WARN: 'WARN',\n    ERROR: 'ERROR'\n  },\n  Languages: {\n    zh_CN: 'Noto Sans CJK tc',\n    zh_HK: 'Noto Sans CJK tc',\n    zh_TW: 'Noto Sans CJK tc',\n    ko_KR: 'Noto Sans CJK kr',\n    ja_JP: 'Noto Sans CJK jp',\n    hy_AM: 'Noto Sans Armenian',\n    default: 'Open Sans'\n  },\n  Error: {\n    NOT_REACHABLE: 'MyScript recognition server is not reachable. Please reload once you are connected.',\n    WRONG_CREDENTIALS: 'Application credentials are invalid. Please check or regenerate your application key and hmackey.',\n    TOO_OLD: 'Session is too old. Max Session Duration Reached.'\n  },\n  Exports: {\n    JIIX: 'application/vnd.myscript.jiix'\n  }\n};\nexport default Constants;\n","import * as loglevel from 'loglevel';\nimport Constants from './Constants';\n\n/**\n * Main log instance\n * @type {Object}\n */\nconst log = loglevel.noConflict();\nexport default log;\n\n/**\n * Log editor events\n * @type {Object}\n */\nexport const editorLogger = log.getLogger(Constants.Logger.EDITOR);\neditorLogger.setDefaultLevel(Constants.LogLevel.ERROR);\n\n/**\n * Log editor events\n * @type {Object}\n */\nexport const smartGuideLogger = log.getLogger(Constants.Logger.SMARTGUIDE);\neditorLogger.setDefaultLevel(Constants.LogLevel.ERROR);\n\n/**\n * Log model events\n * @type {Object}\n */\nexport const modelLogger = log.getLogger(Constants.Logger.MODEL);\nmodelLogger.setDefaultLevel(Constants.LogLevel.ERROR);\n\n/**\n * Log grabber events\n * @type {Object}\n */\nexport const grabberLogger = log.getLogger(Constants.Logger.GRABBER);\ngrabberLogger.setDefaultLevel(Constants.LogLevel.ERROR);\n\n/**\n * Log grabber events\n * @type {Object}\n */\nexport const rendererLogger = log.getLogger(Constants.Logger.RENDERER);\nrendererLogger.setDefaultLevel(Constants.LogLevel.ERROR);\n\n/**\n * Log recognizer events\n * @type {Object}\n */\nexport const recognizerLogger = log.getLogger(Constants.Logger.RECOGNIZER);\nrecognizerLogger.setDefaultLevel(Constants.LogLevel.ERROR);\n\n/**\n * Log callback events\n * @type {Object}\n */\nexport const callbackLogger = log.getLogger(Constants.Logger.CALLBACK);\ncallbackLogger.setDefaultLevel(Constants.LogLevel.ERROR);\n\n/**\n * Log util events\n * @type {Object}\n */\nexport const utilLogger = log.getLogger(Constants.Logger.UTIL);\nutilLogger.setDefaultLevel(Constants.LogLevel.ERROR);\n\n/**\n * Log tests events\n * @type {Object}\n */\nexport const testLogger = log.getLogger('test');\ntestLogger.setDefaultLevel(Constants.LogLevel.ERROR);\n","/*\n* loglevel - https://github.com/pimterry/loglevel\n*\n* Copyright (c) 2013 Tim Perry\n* Licensed under the MIT license.\n*/\n(function (root, definition) {\n    \"use strict\";\n    if (typeof define === 'function' && define.amd) {\n        define(definition);\n    } else if (typeof module === 'object' && module.exports) {\n        module.exports = definition();\n    } else {\n        root.log = definition();\n    }\n}(this, function () {\n    \"use strict\";\n\n    // Slightly dubious tricks to cut down minimized file size\n    var noop = function() {};\n    var undefinedType = \"undefined\";\n\n    var logMethods = [\n        \"trace\",\n        \"debug\",\n        \"info\",\n        \"warn\",\n        \"error\"\n    ];\n\n    // Cross-browser bind equivalent that works at least back to IE6\n    function bindMethod(obj, methodName) {\n        var method = obj[methodName];\n        if (typeof method.bind === 'function') {\n            return method.bind(obj);\n        } else {\n            try {\n                return Function.prototype.bind.call(method, obj);\n            } catch (e) {\n                // Missing bind shim or IE8 + Modernizr, fallback to wrapping\n                return function() {\n                    return Function.prototype.apply.apply(method, [obj, arguments]);\n                };\n            }\n        }\n    }\n\n    // Build the best logging method possible for this env\n    // Wherever possible we want to bind, not wrap, to preserve stack traces\n    function realMethod(methodName) {\n        if (methodName === 'debug') {\n            methodName = 'log';\n        }\n\n        if (typeof console === undefinedType) {\n            return false; // No method possible, for now - fixed later by enableLoggingWhenConsoleArrives\n        } else if (console[methodName] !== undefined) {\n            return bindMethod(console, methodName);\n        } else if (console.log !== undefined) {\n            return bindMethod(console, 'log');\n        } else {\n            return noop;\n        }\n    }\n\n    // These private functions always need `this` to be set properly\n\n    function replaceLoggingMethods(level, loggerName) {\n        /*jshint validthis:true */\n        for (var i = 0; i < logMethods.length; i++) {\n            var methodName = logMethods[i];\n            this[methodName] = (i < level) ?\n                noop :\n                this.methodFactory(methodName, level, loggerName);\n        }\n\n        // Define log.log as an alias for log.debug\n        this.log = this.debug;\n    }\n\n    // In old IE versions, the console isn't present until you first open it.\n    // We build realMethod() replacements here that regenerate logging methods\n    function enableLoggingWhenConsoleArrives(methodName, level, loggerName) {\n        return function () {\n            if (typeof console !== undefinedType) {\n                replaceLoggingMethods.call(this, level, loggerName);\n                this[methodName].apply(this, arguments);\n            }\n        };\n    }\n\n    // By default, we use closely bound real methods wherever possible, and\n    // otherwise we wait for a console to appear, and then try again.\n    function defaultMethodFactory(methodName, level, loggerName) {\n        /*jshint validthis:true */\n        return realMethod(methodName) ||\n               enableLoggingWhenConsoleArrives.apply(this, arguments);\n    }\n\n    function Logger(name, defaultLevel, factory) {\n      var self = this;\n      var currentLevel;\n      var storageKey = \"loglevel\";\n      if (name) {\n        storageKey += \":\" + name;\n      }\n\n      function persistLevelIfPossible(levelNum) {\n          var levelName = (logMethods[levelNum] || 'silent').toUpperCase();\n\n          if (typeof window === undefinedType) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage[storageKey] = levelName;\n              return;\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=\" + levelName + \";\";\n          } catch (ignore) {}\n      }\n\n      function getPersistedLevel() {\n          var storedLevel;\n\n          if (typeof window === undefinedType) return;\n\n          try {\n              storedLevel = window.localStorage[storageKey];\n          } catch (ignore) {}\n\n          // Fallback to cookies if local storage gives us nothing\n          if (typeof storedLevel === undefinedType) {\n              try {\n                  var cookie = window.document.cookie;\n                  var location = cookie.indexOf(\n                      encodeURIComponent(storageKey) + \"=\");\n                  if (location !== -1) {\n                      storedLevel = /^([^;]+)/.exec(cookie.slice(location))[1];\n                  }\n              } catch (ignore) {}\n          }\n\n          // If the stored level is not valid, treat it as if nothing was stored.\n          if (self.levels[storedLevel] === undefined) {\n              storedLevel = undefined;\n          }\n\n          return storedLevel;\n      }\n\n      /*\n       *\n       * Public logger API - see https://github.com/pimterry/loglevel for details\n       *\n       */\n\n      self.name = name;\n\n      self.levels = { \"TRACE\": 0, \"DEBUG\": 1, \"INFO\": 2, \"WARN\": 3,\n          \"ERROR\": 4, \"SILENT\": 5};\n\n      self.methodFactory = factory || defaultMethodFactory;\n\n      self.getLevel = function () {\n          return currentLevel;\n      };\n\n      self.setLevel = function (level, persist) {\n          if (typeof level === \"string\" && self.levels[level.toUpperCase()] !== undefined) {\n              level = self.levels[level.toUpperCase()];\n          }\n          if (typeof level === \"number\" && level >= 0 && level <= self.levels.SILENT) {\n              currentLevel = level;\n              if (persist !== false) {  // defaults to true\n                  persistLevelIfPossible(level);\n              }\n              replaceLoggingMethods.call(self, level, name);\n              if (typeof console === undefinedType && level < self.levels.SILENT) {\n                  return \"No console available for logging\";\n              }\n          } else {\n              throw \"log.setLevel() called with invalid level: \" + level;\n          }\n      };\n\n      self.setDefaultLevel = function (level) {\n          if (!getPersistedLevel()) {\n              self.setLevel(level, false);\n          }\n      };\n\n      self.enableAll = function(persist) {\n          self.setLevel(self.levels.TRACE, persist);\n      };\n\n      self.disableAll = function(persist) {\n          self.setLevel(self.levels.SILENT, persist);\n      };\n\n      // Initialize with the right level\n      var initialLevel = getPersistedLevel();\n      if (initialLevel == null) {\n          initialLevel = defaultLevel == null ? \"WARN\" : defaultLevel;\n      }\n      self.setLevel(initialLevel, false);\n    }\n\n    /*\n     *\n     * Top-level API\n     *\n     */\n\n    var defaultLogger = new Logger();\n\n    var _loggersByName = {};\n    defaultLogger.getLogger = function getLogger(name) {\n        if (typeof name !== \"string\" || name === \"\") {\n          throw new TypeError(\"You must supply a name when creating a logger.\");\n        }\n\n        var logger = _loggersByName[name];\n        if (!logger) {\n          logger = _loggersByName[name] = new Logger(\n            name, defaultLogger.getLevel(), defaultLogger.methodFactory);\n        }\n        return logger;\n    };\n\n    // Grab the current global log variable in case of overwrite\n    var _log = (typeof window !== undefinedType) ? window.log : undefined;\n    defaultLogger.noConflict = function() {\n        if (typeof window !== undefinedType &&\n               window.log === defaultLogger) {\n            window.log = _log;\n        }\n\n        return defaultLogger;\n    };\n\n    defaultLogger.getLoggers = function getLoggers() {\n        return _loggersByName;\n    };\n\n    return defaultLogger;\n}));\n","/*!\n * is-primitive <https://github.com/jonschlinkert/is-primitive>\n *\n * Copyright (c) 2014-2015, Jon Schlinkert.\n * Licensed under the MIT License.\n */\n\n'use strict';\n\n// see http://jsperf.com/testing-value-is-primitive/7\nmodule.exports = function isPrimitive(value) {\n  return value == null || (typeof value !== 'function' && typeof value !== 'object');\n};\n","/*!\n * assign-symbols <https://github.com/jonschlinkert/assign-symbols>\n *\n * Copyright (c) 2015, Jon Schlinkert.\n * Licensed under the MIT License.\n */\n\n'use strict';\n\nmodule.exports = function(receiver, objects) {\n  if (receiver === null || typeof receiver === 'undefined') {\n    throw new TypeError('expected first argument to be an object.');\n  }\n\n  if (typeof objects === 'undefined' || typeof Symbol === 'undefined') {\n    return receiver;\n  }\n\n  if (typeof Object.getOwnPropertySymbols !== 'function') {\n    return receiver;\n  }\n\n  var isEnumerable = Object.prototype.propertyIsEnumerable;\n  var target = Object(receiver);\n  var len = arguments.length, i = 0;\n\n  while (++i < len) {\n    var provider = Object(arguments[i]);\n    var names = Object.getOwnPropertySymbols(provider);\n\n    for (var j = 0; j < names.length; j++) {\n      var key = names[j];\n\n      if (isEnumerable.call(provider, key)) {\n        target[key] = provider[key];\n      }\n    }\n  }\n  return target;\n};\n","var toString = Object.prototype.toString;\n\n/**\n * Get the native `typeof` a value.\n *\n * @param  {*} `val`\n * @return {*} Native javascript type\n */\n\nmodule.exports = function kindOf(val) {\n  var type = typeof val;\n\n  // primitivies\n  if (type === 'undefined') {\n    return 'undefined';\n  }\n  if (val === null) {\n    return 'null';\n  }\n  if (val === true || val === false || val instanceof Boolean) {\n    return 'boolean';\n  }\n  if (type === 'string' || val instanceof String) {\n    return 'string';\n  }\n  if (type === 'number' || val instanceof Number) {\n    return 'number';\n  }\n\n  // functions\n  if (type === 'function' || val instanceof Function) {\n    if (typeof val.constructor.name !== 'undefined' && val.constructor.name.slice(0, 9) === 'Generator') {\n      return 'generatorfunction';\n    }\n    return 'function';\n  }\n\n  // array\n  if (typeof Array.isArray !== 'undefined' && Array.isArray(val)) {\n    return 'array';\n  }\n\n  // check for instances of RegExp and Date before calling `toString`\n  if (val instanceof RegExp) {\n    return 'regexp';\n  }\n  if (val instanceof Date) {\n    return 'date';\n  }\n\n  // other objects\n  type = toString.call(val);\n\n  if (type === '[object RegExp]') {\n    return 'regexp';\n  }\n  if (type === '[object Date]') {\n    return 'date';\n  }\n  if (type === '[object Arguments]') {\n    return 'arguments';\n  }\n  if (type === '[object Error]') {\n    return 'error';\n  }\n  if (type === '[object Promise]') {\n    return 'promise';\n  }\n\n  // buffer\n  if (isBuffer(val)) {\n    return 'buffer';\n  }\n\n  // es6: Map, WeakMap, Set, WeakSet\n  if (type === '[object Set]') {\n    return 'set';\n  }\n  if (type === '[object WeakSet]') {\n    return 'weakset';\n  }\n  if (type === '[object Map]') {\n    return 'map';\n  }\n  if (type === '[object WeakMap]') {\n    return 'weakmap';\n  }\n  if (type === '[object Symbol]') {\n    return 'symbol';\n  }\n  \n  if (type === '[object Map Iterator]') {\n    return 'mapiterator';\n  }\n  if (type === '[object Set Iterator]') {\n    return 'setiterator';\n  }\n  if (type === '[object String Iterator]') {\n    return 'stringiterator';\n  }\n  if (type === '[object Array Iterator]') {\n    return 'arrayiterator';\n  }\n  \n  // typed arrays\n  if (type === '[object Int8Array]') {\n    return 'int8array';\n  }\n  if (type === '[object Uint8Array]') {\n    return 'uint8array';\n  }\n  if (type === '[object Uint8ClampedArray]') {\n    return 'uint8clampedarray';\n  }\n  if (type === '[object Int16Array]') {\n    return 'int16array';\n  }\n  if (type === '[object Uint16Array]') {\n    return 'uint16array';\n  }\n  if (type === '[object Int32Array]') {\n    return 'int32array';\n  }\n  if (type === '[object Uint32Array]') {\n    return 'uint32array';\n  }\n  if (type === '[object Float32Array]') {\n    return 'float32array';\n  }\n  if (type === '[object Float64Array]') {\n    return 'float64array';\n  }\n\n  // must be a plain object\n  return 'object';\n};\n\n/**\n * If you need to support Safari 5-7 (8-10 yr-old browser),\n * take a look at https://github.com/feross/is-buffer\n */\n\nfunction isBuffer(val) {\n  return val.constructor\n    && typeof val.constructor.isBuffer === 'function'\n    && val.constructor.isBuffer(val);\n}\n","/*!\n * assign-deep <https://github.com/jonschlinkert/assign-deep>\n *\n * Copyright (c) 2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n'use strict';\n\nvar isPrimitive = require('is-primitive');\nvar assignSymbols = require('assign-symbols');\nvar typeOf = require('kind-of');\n\nfunction assign(target/*, objects*/) {\n  target = target || {};\n  var len = arguments.length, i = 0;\n  if (len === 1) {\n    return target;\n  }\n  while (++i < len) {\n    var val = arguments[i];\n    if (isPrimitive(target)) {\n      target = val;\n    }\n    if (isObject(val)) {\n      extend(target, val);\n    }\n  }\n  return target;\n}\n\n/**\n * Shallow extend\n */\n\nfunction extend(target, obj) {\n  assignSymbols(target, obj);\n\n  for (var key in obj) {\n    if (key !== '__proto__' && hasOwn(obj, key)) {\n      var val = obj[key];\n      if (isObject(val)) {\n        if (typeOf(target[key]) === 'undefined' && typeOf(val) === 'function') {\n          target[key] = val;\n        }\n        target[key] = assign(target[key] || {}, val);\n      } else {\n        target[key] = val;\n      }\n    }\n  }\n  return target;\n}\n\n/**\n * Returns true if the object is a plain object or a function.\n */\n\nfunction isObject(obj) {\n  return typeOf(obj) === 'object' || typeOf(obj) === 'function';\n}\n\n/**\n * Returns true if the given `key` is an own property of `obj`.\n */\n\nfunction hasOwn(obj, key) {\n  return Object.prototype.hasOwnProperty.call(obj, key);\n}\n\n/**\n * Expose `assign`\n */\n\nmodule.exports = assign;\n","import assign from 'assign-deep';\nimport { editorLogger as logger } from './LoggerConfig';\n\n\n/**\n * Default configuration\n * @type {Configuration}\n * See https://developer.myscript.com/docs/interactive-ink/latest/reference/web/configuration/ for a full documentation of parameters.\n */\nconst defaultConfiguration = {\n  recognitionParams: {\n    type: 'TEXT',\n    protocol: 'WEBSOCKET',\n    apiVersion: 'V4',\n    server: {\n      scheme: 'https',\n      host: 'cloud.myscript.com',\n      applicationKey: undefined,\n      hmacKey: undefined,\n      useWindowLocation: false,\n      websocket: {\n        pingEnabled: true,\n        pingDelay: 30000,\n        maxPingLostCount: 10,\n        autoReconnect: true,\n        maxRetryCount: 2,\n        fileChunkSize: 300000\n      }\n    },\n    v4: {\n      alwaysConnected: true,\n      lang: 'en_US',\n      export: {\n        'image-resolution': 300,\n        jiix: {\n          'bounding-box': false,\n          strokes: false,\n          text: {\n            chars: false,\n            words: true\n          }\n        }\n      },\n      renderer: {\n        debug: {\n          'draw-text-boxes': false,\n          'draw-image-boxes': false\n        }\n      },\n      math: {\n        mimeTypes: ['application/x-latex', 'application/mathml+xml'],\n        solver: {\n          enable: true,\n          'fractional-part-digits': 3,\n          'decimal-separator': '.',\n          'rounding-mode': 'half up',\n          'angle-unit': 'deg'\n        },\n        margin: {\n          bottom: 10,\n          left: 15,\n          right: 15,\n          top: 10\n        }\n      },\n      text: {\n        guides: {\n          enable: true\n        },\n        smartGuide: true,\n        smartGuideFadeOut: {\n          enable: false,\n          duration: 10000\n        },\n        mimeTypes: ['text/plain', 'application/vnd.myscript.jiix'],\n        margin: {\n          top: 20,\n          left: 10,\n          right: 10\n        }\n      },\n      diagram: {\n        mimeTypes: ['application/vnd.myscript.jiix'],\n        margin: {\n          bottom: 10,\n          left: 15,\n          right: 15,\n          top: 10\n        }\n      },\n      'raw-content': {\n        recognition: {\n          text: false,\n          shape: false\n        }\n      }\n    },\n    v3: {\n      mathParameter: {\n        resultTypes: ['LATEX', 'MATHML'],\n        columnarOperation: false,\n        userResources: [],\n        scratchOutDetectionSensitivity: 1,\n      },\n      textParameter: {\n        language: 'en_US',\n        textInputMode: 'CURSIVE',\n        resultDetail: 'TEXT',\n        contentTypes: [],\n        subsetKnowledges: [],\n        userLkWords: [],\n        userResources: [],\n        textProperties: {\n          textCandidateListSize: 1,\n          wordCandidateListSize: undefined,\n          wordPredictionListSize: 0,\n          wordCompletionListSize: 0,\n          characterCandidateListSize: undefined,\n          enableOutOfLexicon: false,\n          discardCaseVariations: false,\n          discardAccentuationVariations: false,\n          glyphDistortion: undefined,\n          enableTagger: false,\n          spellingDistortion: undefined\n        }\n      },\n      shapeParameter: {\n        userResources: undefined,\n        rejectDetectionSensitivity: 1,\n        doBeautification: true\n      },\n      musicParameter: {\n        divisions: 480,\n        resultTypes: ['MUSICXML', 'SCORETREE'],\n        userResources: [],\n        staff: {\n          top: 100,\n          count: 5,\n          gap: 20\n        },\n        clef: {\n          symbol: 'G',\n          octave: 0,\n          line: 2\n        },\n        scratchOutDetectionSensitivity: 1\n      },\n      analyzerParameter: {\n        textParameter: {\n          textProperties: {},\n          language: 'en_US',\n          textInputMode: 'CURSIVE'\n        },\n        coordinateResolution: undefined\n      }\n    }\n  },\n  // @see generated documentation on top\n  listenerOptions: {\n    capture: false,\n    passive: true\n  },\n  undoRedoMaxStackSize: 20,\n  xyFloatPrecision: 0,\n  timestampFloatPrecision: 0,\n  triggerDelay: 2000,\n  processDelay: 0,\n  resizeTriggerDelay: 200,\n  // Configure when the action is triggered.\n  // POINTER_UP : Action is triggered on every PenUP. This is the recommended mode for CDK V3 WebSocket recognitions.\n  // QUIET_PERIOD : Action is triggered after a quiet period in milli-seconds on every pointer up. I value is set to 2000 for example the recognition will be fired  when user stop writing 2 seconds. This is the recommended mode for all REST recognitions.\n  triggers: {\n    exportContent: 'POINTER_UP',\n    addStrokes: 'POINTER_UP'\n  },\n  restConversionState: '',\n  renderingParams: {\n    stroker: 'quadratic',\n    minHeight: 100,\n    minWidth: 100\n  }\n};\n\n/**\n * Generate parameters\n * @param {Configuration} configuration Configuration to be used\n * @return {Configuration} Overridden configuration\n */\nexport function overrideDefaultConfiguration(configuration) {\n  const confRef = configuration;\n  let currentConfiguration;\n  if (confRef && confRef.recognitionParams.server && confRef.recognitionParams.server.useWindowLocation) {\n    confRef.recognitionParams.server.scheme = window.location.protocol.slice(0, -1);\n    confRef.recognitionParams.server.host = window.location.host;\n    currentConfiguration = assign({}, defaultConfiguration, confRef === undefined ? {} : confRef);\n  } else {\n    currentConfiguration = assign({}, defaultConfiguration, configuration === undefined ? {} : configuration);\n  }\n  logger.debug('Override default configuration', currentConfiguration);\n  return currentConfiguration;\n}\n\nexport default defaultConfiguration;\n","!function(t,e){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define([],e):\"object\"==typeof exports?exports.JsonCSS=e():t.JsonCSS=e()}(this,function(){return function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,\"a\",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p=\"\",e(e.s=1)}([function(t,e,n){\"use strict\";function o(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(e,\"__esModule\",{value:!0});var r=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t},i=function t(e){var n=this;o(this,t),this.toJSON=function(t){if(\"string\"!=typeof t)return console.error(\"Need a CSS string but given \",void 0===t?\"undefined\":r(t),t),\"Not a valid CSS..!\";var e={},o=void 0,i=void 0,u=void 0;try{t.split(\"{\").forEach(function(t){if(i=t.trim())if(-1===i.indexOf(\"}\"))e[i]={},o=i;else{i.substring(0,i.indexOf(\"}\")).split(\";\").forEach(function(t){(u=t.split(\":\"))&&2===u.length&&(e[o][u[0].trim().replace(/^\\\"|\\\"$/g,\"\")]=n._trimSemiColon(u[1].trim().replace(/^\\\"|\\\"$/g,\"\")))});try{o=i.split(\"}\")[1].trim(),o&&(e[o]={})}catch(t){}}})}catch(t){return\"Not a valid CSS..!\"}return e},this.toCSS=function(t){if(\"object\"!==(void 0===t?\"undefined\":r(t)))return console.error(\"Need a JSON object but given \",void 0===t?\"undefined\":r(t),t),\"Not a valid JSON..!\";var e=\"\";try{for(var n in t)if(t.hasOwnProperty(n)){e+=n+\" {\\n\";for(var o in t[n])t[n].hasOwnProperty(o)&&(e+=o+\": \"+t[n][o]+\";\\n\");e+=\"}\\n\"}}catch(t){return\"Not a valid JSON..!\"}return e},this._trimSemiColon=function(t){return\";\"===t.slice(-1)?t.slice(0,n.length-1):t}};e.default=i},function(t,e,n){\"use strict\";t.exports=n(0).default}])});","import JsonCSS from 'json-css';\nimport assign from 'assign-deep';\nimport { editorLogger as logger } from './LoggerConfig';\n\n/**\n * @typedef {Object} PenStyle\n * @property {String} color=#000000 Color (supported formats rgb() rgba() hsl() hsla() #rgb #rgba #rrggbb #rrggbbaa)\n * @property {String} -myscript-pen-width=1 Width of strokes and primitives in mm (no other unit is supported yet)\n * @property {String} -myscript-pen-fill-style=none\n * @property {String} -myscript-pen-fill-color=#FFFFFF00 Color filled inside the area delimited by strokes and primitives\n */\n\n/**\n * Default style\n * @type {PenStyle}\n */\nconst defaultPenStyle = undefined;\nconst parser = new JsonCSS();\n\n/**\n * Generate style\n * @param {PenStyle} style Custom style to be applied\n * @return {PenStyle} Overridden style\n */\nexport function overrideDefaultPenStyle(style) {\n  const currentStyle = assign({}, defaultPenStyle, style === undefined ? {} : style);\n  logger.debug('Override default pen style', currentStyle);\n  return currentStyle;\n}\n\nexport function toCSS(penStyle) { // FIXME Ugly hack to parse JSON to CSS inline\n  const css = parser.toCSS({ css: penStyle });\n  return css.substring(6, css.length - 3);\n}\n\nexport function toJSON(penStyle) { // FIXME Ugly hack to parse CSS inline to JSON\n  return parser.toJSON(`css {${penStyle}}`).css;\n}\n\nexport default defaultPenStyle;\n","import JsonCSS from 'json-css';\nimport assign from 'assign-deep';\nimport { editorLogger as logger } from './LoggerConfig';\n\n/**\n * @typedef {PenStyle} InkTheme\n */\n/**\n * @typedef {Object} MathTheme\n * @property {String} font-family=STIXGeneral Font-family to be used\n */\n/**\n * @typedef {Object} GeneratedTheme\n * @property {String} font-family=STIXGeneral Font-family to be used\n * @property {String} color=#A8A8A8FF Color to be used\n */\n/**\n * @typedef {Object} TextTheme\n * @property {String} font-family=OpenSans Font-family to be used\n * @property {Number} font-size=10 Font-size to be used\n */\n/**\n * @typedef {Object} Theme\n * @property {InkTheme} ink General settings\n * @property {MathTheme} .math Math theme\n * @property {GeneratedTheme} .math-solver Theme to be used for generated items\n * @property {TextTheme} .text Text theme\n */\n\n/**\n * Default theme\n * @type {Theme}\n */\nconst defaultTheme = {\n  ink: {\n    color: '#000000',\n    '-myscript-pen-width': 1,\n    '-myscript-pen-fill-style': 'none',\n    '-myscript-pen-fill-color': '#FFFFFF00'\n  },\n  '.math': {\n    'font-family': 'STIXGeneral'\n  },\n  '.math-solved': {\n    'font-family': 'STIXGeneral',\n    color: '#A8A8A8FF'\n  },\n  '.text': {\n    'font-family': 'Open Sans',\n    'font-size': 10\n  }\n};\nconst parser = new JsonCSS();\n\n/**\n * Generate theme\n * @param {Theme} theme Custom theme to be applied\n * @return {Theme} Overridden theme\n */\nexport function overrideDefaultTheme(theme) {\n  const currentTheme = assign({}, defaultTheme, theme === undefined ? {} : theme);\n  logger.debug('Override default theme', currentTheme);\n  return currentTheme;\n}\n\nexport function toCSS(theme) {\n  return parser.toCSS(theme);\n}\n\nexport function toJSON(theme) {\n  return parser.toJSON(theme);\n}\n\nexport default defaultTheme;\n","import { grabberLogger as logger } from '../configuration/LoggerConfig';\n\n/**\n * Grab pointerDown, pointerMove and pointerUp events\n * @typedef {Object} Grabber\n * @property {function(element: Element, editor: Editor): GrabberContext} attach Attach events and decide when to call editor pointerDown/Move/Up methods\n * @property {function(element: Element, context: GrabberContext)} detach Detach the grabber\n */\n\n/**\n * Grabber listener\n * @typedef {Object} GrabberListener\n * @property {Array<String>} types Event types to listen\n * @property {function(event: Event)} listener Event listener for these events\n */\n\n/**\n * Grabber context\n * @typedef {Object} GrabberContext\n * @property {Boolean|Object} options Options object that specifies characteristics about the event listener. (@see addEventListener.options for detail)\n * @property {Array<GrabberListener>} listeners Registered listeners\n */\n\nconst floatPrecisionArray = [1, 10, 100, 1000, 10000, 100000, 1000000, 10000000, 100000000, 1000000000];\n\nfunction roundFloat(oneFloat, requestedFloatPrecision) {\n  if (requestedFloatPrecision || requestedFloatPrecision === 0) {\n    let floatPrecision;\n    if (requestedFloatPrecision > 10) {\n      floatPrecision = floatPrecisionArray[10];\n    } else {\n      floatPrecision = floatPrecisionArray[requestedFloatPrecision];\n    }\n    return Math.round(oneFloat * floatPrecision) / floatPrecision;\n  }\n  return oneFloat;\n}\n\nfunction extractPoint(event, domElement, configuration, offsetTop = 0, offsetLeft = 0) {\n  let eventRef = event;\n  if (eventRef.changedTouches) {\n    eventRef = eventRef.changedTouches[0];\n  }\n  const rect = domElement.getBoundingClientRect();\n  return {\n    x: roundFloat(eventRef.clientX - rect.left - domElement.clientLeft - offsetLeft, configuration.xyFloatPrecision),\n    y: roundFloat(eventRef.clientY - rect.top - domElement.clientTop - offsetTop, configuration.xyFloatPrecision),\n    t: roundFloat(Date.now(), configuration.timestampFloatPrecision)\n  };\n}\n\n/**\n * Listen for the desired events\n * @param {Element} element DOM element to attach events listeners\n * @param {Editor} editor Editor to received down/move/up events\n * @param {Number} [offsetTop=0]\n * @param {Number} [offsetLeft=0]\n * @return {GrabberContext} Grabber context\n * @listens {Event} pointermove: a pointer moves, similar to touchmove or mousemove.\n * @listens {Event} pointerdown: a pointer is activated, or a device button held.\n * @listens {Event} pointerup: a pointer is deactivated, or a device button released.\n * @listens {Event} pointerover: a pointer has moved onto an element.\n * @listens {Event} pointerout: a pointer is no longer on an element it once was.\n * @listens {Event} pointerenter: a pointer enters the bounding box of an element.\n * @listens {Event} pointerleave: a pointer leaves the bounding box of an element.\n * @listens {Event} pointercancel: a pointer will no longer generate events.\n */\nexport function attach(element, editor, offsetTop = 0, offsetLeft = 0) {\n  let mMaxDiffX = 0;\n\n  function unfocus() {\n    if (window.getSelection().type !== 'None') {\n      window.getSelection().removeAllRanges();\n    }\n  }\n\n  function hideMenu(evt) {\n    const moreMenuInDocument = document.querySelector('.more-menu');\n    if (!evt.target.classList.contains('ellipsis') && !evt.target.classList.contains('more-menu') && !evt.target.classList.contains('options-label-button') && moreMenuInDocument && moreMenuInDocument.style.display !== 'none') {\n      moreMenuInDocument.style.display = 'none';\n      return true;\n    }\n    return false;\n  }\n\n  function hideCandidates(evt) {\n    const candidatesInDocument = document.querySelector('.candidates');\n    if (!evt.target.classList.contains('candidates') && !(evt.target.tagName === 'SPAN') && candidatesInDocument && candidatesInDocument.style.display !== 'none') {\n      candidatesInDocument.style.display = 'none';\n      return true;\n    }\n    return false;\n  }\n\n  function pointerDownHandler(evt) { // Trigger a pointerDown\n    const pointerDownOnEditor = evt.target.id === editor.domElement.id || evt.target.classList.contains('ms-canvas');\n    if (this.activePointerId !== undefined) {\n      if (this.activePointerId === evt.pointerId) {\n        logger.trace(`${evt.type} event with the same id without any pointer up`, evt.pointerId);\n      }\n    } else if ((evt.button !== 2) && (evt.buttons !== 2) && pointerDownOnEditor) { // Ignore right click\n      if (!hideMenu(evt) && !hideCandidates(evt)) {\n        this.activePointerId = evt.pointerId;\n        // Hack for iOS 9 Safari : pointerId has to be int so -1 if > max value\n        const pointerId = evt.pointerId > 2147483647 ? -1 : evt.pointerId;\n        unfocus();\n        evt.stopPropagation();\n        editor.pointerDown(extractPoint(evt, element, editor.configuration, offsetTop, offsetLeft), evt.pointerType, pointerId);\n      }\n    } else if (evt.target.classList.contains('ellipsis') || evt.target.classList.contains('tag-icon')) {\n      hideMenu(evt);\n      hideCandidates(evt);\n    } else { // FIXME add more complete verification to pointer down on smartguide\n      hideMenu(evt);\n      hideCandidates(evt);\n      this.smartGuidePointerDown = true;\n      this.downSmartGuidePoint = extractPoint(evt, element, editor.configuration);\n    }\n  }\n\n  function pointerMoveHandler(evt) { // Trigger a pointerMove\n    // Only considering the active pointer\n    if (this.activePointerId !== undefined && this.activePointerId === evt.pointerId) {\n      unfocus();\n      editor.pointerMove(extractPoint(evt, element, editor.configuration, offsetTop, offsetLeft));\n    } else if (this.smartGuidePointerDown) {\n      const point = extractPoint(evt, element, editor.configuration, offsetTop, offsetLeft);\n      const diffX = Math.abs(this.downSmartGuidePoint.x - point.x);\n      const diffY = Math.abs(this.downSmartGuidePoint.y - point.y);\n      mMaxDiffX = Math.max(diffX, mMaxDiffX);\n      const cond1 = diffX < 5 && diffY > 5 && mMaxDiffX < 15;\n      const cond2 = diffX > 5 && diffY > 5 && mMaxDiffX < 15;\n      if (cond1 || cond2) {\n        this.activePointerId = evt.pointerId;\n        // Hack for iOS 9 Safari : pointerId has to be int so -1 if > max value\n        const pointerId = evt.pointerId > 2147483647 ? -1 : evt.pointerId;\n        unfocus();\n        editor.pointerDown(this.downSmartGuidePoint, evt.pointerType, pointerId);\n      }\n    } else {\n      logger.trace(`${evt.type} event from another pointerid (${evt.pointerId})`, this.activePointerId);\n    }\n  }\n\n  function pointerUpHandler(evt) { // Trigger a pointerUp\n    mMaxDiffX = 0;\n    this.smartGuidePointerDown = false;\n    const smartGuideIds = ['smartguide', 'prompter-text-container', 'prompter-text', 'tag-icon', 'ellipsis'];\n    const scrollbarClasses = ['ps__rail-x', 'ps__thumb-x'];\n    // Check if pointer entered into any smartguide elements or scrollbar\n    // Use case : when the pointer is entering the smartguide or scrollbar, a pointerout (or leave) is fired.\n    // The related target is then the DOM element that was left.\n    // We don't want this to cause editor.pointerUp because the stroke isn't finished.\n    const pointerEnteredSmartGuide = evt.relatedTarget && (smartGuideIds.includes(evt.relatedTarget.className) || scrollbarClasses.includes(evt.relatedTarget.className));\n    // Check if pointer didn't stay in the smartguide and pointer exited the smartguide or scrollbar\n    // Use case : when the pointer is leaving the smartguide or scrollbar, a pointerout (or leave) is fired.\n    // The related target is then the DOM element that was left (the smart guide)\n    // We are entering again the editor\n    // We don't want this to cause editor.pointerUp because the stroke isn't finished.\n    const pointerExitedSmartGuide = evt.relatedTarget && evt.target && (smartGuideIds.includes(evt.target.className) || scrollbarClasses.includes(evt.target.className));\n    // Check if pointer moved between words in smartguide\n    // Same use case as pointerEnteredSmartGuide but for the words in the smartguide (each word is a span).\n    const pointerMovedWords = evt.relatedTarget && evt.target && (evt.target.tagName === 'SPAN' || evt.relatedTarget.tagName === 'SPAN');\n    if (pointerEnteredSmartGuide || pointerExitedSmartGuide || pointerMovedWords) {\n      evt.stopPropagation();\n    } else if (this.activePointerId !== undefined && this.activePointerId === evt.pointerId) { // Only considering the active pointer\n      this.activePointerId = undefined; // Managing the active pointer\n      evt.stopPropagation();\n      editor.pointerUp(extractPoint(evt, element, editor.configuration, offsetTop, offsetLeft));\n    } else {\n      logger.trace(`${evt.type} event from another pointerid (${evt.pointerId})`, this.activePointerId);\n    }\n  }\n\n  const context = {\n    options: editor.configuration.listenerOptions,\n    listeners: [{\n      types: ['pointerdown'],\n      listener: pointerDownHandler\n    }, {\n      types: ['pointermove'],\n      listener: pointerMoveHandler\n    }, {\n      types: ['pointerup', 'pointerout', 'pointerleave', 'pointercancel'],\n      listener: pointerUpHandler\n    }]\n  };\n\n  logger.debug('attaching listeners', context);\n  context.listeners.forEach((item) => {\n    item.types.forEach(type => element.addEventListener(type, item.listener, context.options));\n  });\n  return context;\n}\n\nexport function detach(element, context) {\n  logger.debug('detaching listeners', context);\n  context.listeners.forEach((item) => {\n    item.types.forEach(type => element.removeEventListener(type, item.listener, context.options));\n  });\n}\n","/**\n * Draw a stroke symbol\n * @param {Object} context Current rendering context\n * @param {Stroke} stroke Stroke to be drawn\n * @param {Stroker} stroker Stroker to use to render a stroke\n */\nexport function drawStroke(context, stroke, stroker) {\n  if (stroker) {\n    stroker.drawStroke(context, stroke);\n  }\n}\n","import { rendererLogger as logger } from '../../../configuration/LoggerConfig';\n\n/**\n * @type {{table: String, shape: String, recognizedShape: String, ellipse: String, line: String}}\n */\nexport const ShapeSymbols = {\n  table: 'table',\n  shape: 'shape',\n  recognizedShape: 'recognizedShape',\n  ellipse: 'ellipse',\n  line: 'line'\n};\n\nfunction phi(angle) {\n  let returnedAngle = ((angle + Math.PI) % (Math.PI * 2)) - Math.PI;\n  if (returnedAngle < -Math.PI) {\n    returnedAngle += Math.PI * 2;\n  }\n  return returnedAngle;\n}\n\nfunction drawEllipseArc(context, centerPoint, maxRadius, minRadius, orientation, startAngle, sweepAngle) {\n  const angleStep = 0.02; // angle delta between interpolated\n\n  let z1 = Math.cos(orientation);\n  let z3 = Math.sin(orientation);\n  let z2 = z1;\n  let z4 = z3;\n  z1 *= maxRadius;\n  z2 *= minRadius;\n  z3 *= maxRadius;\n  z4 *= minRadius;\n\n  const n = Math.floor(Math.abs(sweepAngle) / angleStep);\n\n  const boundariesPoints = [];\n\n  context.save();\n  try {\n    context.beginPath();\n\n    for (let i = 0; i <= n; i++) {\n      const angle = startAngle + ((i / n) * sweepAngle); // points on the arc, in radian\n      const alpha = Math.atan2(Math.sin(angle) / minRadius, Math.cos(angle) / maxRadius);\n\n      const cosAlpha = Math.cos(alpha);\n      const sinAlpha = Math.sin(alpha);\n\n      // current point\n      const x = (centerPoint.x + (z1 * cosAlpha)) - (z4 * sinAlpha);\n      const y = (centerPoint.y + (z2 * sinAlpha)) + (z3 * cosAlpha);\n      if (i === 0) {\n        context.moveTo(x, y);\n      } else {\n        context.lineTo(x, y);\n      }\n\n      if (i === 0 || i === n) {\n        boundariesPoints.push({ x, y });\n      }\n    }\n\n    context.stroke();\n  } finally {\n    context.restore();\n  }\n\n  return boundariesPoints;\n}\n\nfunction drawArrowHead(context, headPoint, angle, length) {\n  const alpha = phi(angle + (Math.PI * (7 / 8)));\n  const beta = phi(angle - (Math.PI * (7 / 8)));\n\n  const contextReference = context;\n  contextReference.save();\n  try {\n    contextReference.fillStyle = contextReference.strokeStyle;\n\n    contextReference.moveTo(headPoint.x, headPoint.y);\n    contextReference.beginPath();\n    contextReference.lineTo(headPoint.x + (length * Math.cos(alpha)), headPoint.y + (length * Math.sin(alpha)));\n    contextReference.lineTo(headPoint.x + (length * Math.cos(beta)), headPoint.y + (length * Math.sin(beta)));\n    contextReference.lineTo(headPoint.x, headPoint.y);\n    contextReference.fill();\n  } finally {\n    contextReference.restore();\n  }\n}\n\nfunction drawShapeEllipse(context, shapeEllipse) {\n  const points = drawEllipseArc(\n    context,\n    shapeEllipse.center,\n    shapeEllipse.maxRadius,\n    shapeEllipse.minRadius,\n    shapeEllipse.orientation,\n    shapeEllipse.startAngle,\n    shapeEllipse.sweepAngle);\n\n  if (shapeEllipse.beginDecoration && shapeEllipse.beginDecoration === 'ARROW_HEAD') {\n    drawArrowHead(context, points[0], shapeEllipse.beginTangentAngle, 12.0);\n  }\n  if (shapeEllipse.endDecoration && shapeEllipse.endDecoration === 'ARROW_HEAD') {\n    drawArrowHead(context, points[1], shapeEllipse.endTangentAngle, 12.0);\n  }\n}\n\n/**\n * Draw a line\n * @param {Object} context Current rendering context\n * @param {{x: Number, y: Number}} p1 Origin point\n * @param {{x: Number, y: Number}} p2 Destination point\n */\nexport function drawLine(context, p1, p2) {\n  context.save();\n  try {\n    context.beginPath();\n    context.moveTo(p1.x, p1.y);\n    context.lineTo(p2.x, p2.y);\n    context.stroke();\n  } finally {\n    context.restore();\n  }\n}\n\nfunction drawShapeLine(context, shapeLine) {\n  drawLine(context, shapeLine.firstPoint, shapeLine.lastPoint);\n  if (shapeLine.beginDecoration === 'ARROW_HEAD') {\n    drawArrowHead(context, shapeLine.firstPoint, shapeLine.beginTangentAngle, 12.0);\n  }\n  if (shapeLine.endDecoration === 'ARROW_HEAD') {\n    drawArrowHead(context, shapeLine.lastPoint, shapeLine.endTangentAngle, 12.0);\n  }\n}\n\n/**\n * Draw a shape symbol\n * @param {Object} context Current rendering context\n * @param {Object} symbol Symbol to draw\n */\nexport function drawShapeSymbol(context, symbol) {\n  logger.debug(`draw ${symbol.type} symbol`);\n  const contextReference = context;\n  contextReference.save();\n  try {\n    contextReference.lineWidth = symbol.width;\n    contextReference.strokeStyle = symbol.color;\n\n    if (symbol.elementType) {\n      switch (symbol.elementType) {\n        case ShapeSymbols.shape:\n          drawShapeSymbol(contextReference, symbol.candidates[symbol.selectedCandidateIndex]);\n          break;\n        case ShapeSymbols.table:\n          symbol.lines.forEach(line => drawShapeSymbol(contextReference, line));\n          break;\n        case ShapeSymbols.line:\n          drawLine(contextReference, symbol.data.p1, symbol.data.p2);\n          break;\n        default:\n          logger.error(`${symbol.elementType} not implemented`);\n          break;\n      }\n    } else {\n      switch (symbol.type) {\n        case ShapeSymbols.ellipse:\n          drawShapeEllipse(contextReference, symbol);\n          break;\n        case ShapeSymbols.line:\n          drawShapeLine(contextReference, symbol);\n          break;\n        case ShapeSymbols.recognizedShape:\n          symbol.primitives.forEach(primitive => drawShapeSymbol(contextReference, primitive));\n          break;\n        default:\n          logger.error(`${symbol.type} not implemented`);\n          break;\n      }\n    }\n  } finally {\n    contextReference.restore();\n  }\n}\n","import { rendererLogger as logger } from '../../../configuration/LoggerConfig';\nimport { drawLine } from './ShapeSymbolCanvasRenderer';\n\n/**\n * @type {{inputCharacter: String, char: String, string: String, textLine: String}}\n */\nexport const TextSymbols = {\n  inputCharacter: 'inputCharacter',\n  char: 'char',\n  string: 'string',\n  textLine: 'textLine'\n};\n\nfunction drawUnderline(context, underline, label, data) {\n  const delta = data.width / label.length;\n  const p1 = {\n    x: data.topLeftPoint.x + (underline.data.firstCharacter * delta),\n    y: data.topLeftPoint.y + data.height\n  };\n  const p2 = {\n    x: data.topLeftPoint.x + (underline.data.lastCharacter * delta),\n    y: data.topLeftPoint.y + data.height\n  };\n  drawLine(context, p1, p2);\n}\n\nfunction drawText(context, label, data) {\n  const contextReference = context;\n  contextReference.save();\n  try {\n    contextReference.font = `${data.textHeight}px serif`;\n    contextReference.textAlign = (data.justificationType === 'CENTER') ? 'center' : 'left';\n    contextReference.textBaseline = 'bottom';\n    contextReference.fillStyle = contextReference.strokeStyle;\n    contextReference.fillText(label, data.topLeftPoint.x, (data.topLeftPoint.y + data.height));\n  } finally {\n    contextReference.restore();\n  }\n}\n\nfunction drawTextLine(context, textLine) {\n  drawText(context, textLine.label, textLine.data);\n  textLine.underlineList.forEach((underline) => {\n    drawUnderline(context, underline, textLine.label, textLine.data);\n  });\n}\n\n/**\n * Draw a text symbol\n * @param {Object} context Current rendering context\n * @param {Object} symbol Symbol to draw\n */\nexport function drawTextSymbol(context, symbol) {\n  logger.debug(`draw ${symbol.type} symbol`);\n  const contextReference = context;\n  contextReference.save();\n  try {\n    contextReference.lineWidth = symbol.width;\n    contextReference.strokeStyle = symbol.color;\n\n    if (symbol.elementType) {\n      switch (symbol.elementType) {\n        case TextSymbols.textLine:\n          drawTextLine(contextReference, symbol);\n          break;\n        default:\n          logger.error(`${symbol.elementType} not implemented`);\n          break;\n      }\n    } else {\n      switch (symbol.type) {\n        case TextSymbols.textLine:\n          drawTextLine(contextReference, symbol);\n          break;\n        default:\n          logger.error(`${symbol.type} not implemented`);\n      }\n    }\n  } finally {\n    contextReference.restore();\n  }\n}\n","import { rendererLogger as logger } from '../../../configuration/LoggerConfig';\nimport { drawLine } from './ShapeSymbolCanvasRenderer';\n\n/**\n * @type {{F: {svg: String, getBoundingBox: function}, C: {svg: String, getBoundingBox: function}, G: {svg: String, getBoundingBox: function}}}\n */\nexport const MusicClefs = { // constants was calculated from the svg image, so it should remains together\n  F: {\n    svg: '<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.0\" width=\"18\" height=\"20\"><g transform=\"translate(6.600000e-3,3.125356e-3)\"><path d=\"M17.3 3.1 C17.3 3.5 17.1 3.8 16.8 4.1 C16.5 4.4 15.9 4.5 15.5 4.3 C15 4.1 14.7 3.7 14.7 3.2 C14.6 2.8 14.8 2.5 15 2.2 C15.3 1.9 15.7 1.8 16 1.8 C16.4 1.8 16.8 2 17 2.3 C17.2 2.5 17.3 2.8 17.3 3.1 z\"/><path d=\"M17.3 8.9 C17.3 9.3 17.1 9.7 16.8 9.9 C16.5 10.3 15.9 10.3 15.5 10.2 C15 10 14.7 9.5 14.7 9.1 C14.6 8.7 14.8 8.3 15 8 C15.3 7.8 15.7 7.6 16 7.6 C16.5 7.7 17 8 17.2 8.4 C17.2 8.6 17.3 8.8 17.3 8.9 z\"/><path d=\"M13 7.2 C13 10 11.8 12.7 9.8 14.7 C7.3 17.2 4 18.8 0.7 19.8 C0.3 20.1 -0.4 19.8 0.3 19.4 C1.6 18.8 3 18.3 4.2 17.5 C7 15.8 9.3 13.1 9.8 9.9 C10.1 8 10.1 5.9 9.6 4 C9.2 2.6 8.2 1.1 6.7 0.9 C5.3 0.7 3.7 1.2 2.7 2.2 C2.5 2.4 2 3.2 2 4 C2.6 3.6 2.6 3.6 3.1 3.4 C4.2 2.9 5.7 3.6 6 4.9 C6.3 6 6.1 7.5 5 8.1 C3.8 8.7 2 8.5 1.4 7.2 C0.3 5.3 0.9 2.6 2.6 1.2 C4.4 -0.3 7.1 -0.3 9.2 0.4 C11.4 1.3 12.7 3.5 12.9 5.8 C13 6.2 13 6.7 13 7.2 z\"/></g></svg>',\n    getBoundingBox: (gap, xAnchor, yAnchor) => ({\n      height: gap * 3,\n      width: (gap * 3) * (18 / 20),\n      x: xAnchor,\n      y: yAnchor - gap\n    })\n  },\n  C: {\n    svg: '<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.0\" width=\"18\" height=\"25\"><g transform=\"matrix(1,0,0,1.030698,-309.364,-543.8647)\"><path d=\"M 325.9 546.8 C 325.8 548.7 324.7 550.7 322.8 551.5 C 321.1 552.1 319.1 552.2 317.6 551 C 316.6 550.2 316.2 548.4 317.3 547.5 C 318.3 546.5 320.4 547.4 320.3 548.9 C 320.7 549.9 318.5 550.5 319.7 551.3 C 321 551.6 322.3 550.5 322.6 549.3 C 323.1 547.5 323.1 545.6 322.7 543.8 C 322.4 542.9 321.9 541.5 320.7 541.9 C 319.2 542.2 318.3 543.8 317.9 545.1 C 317.6 543.2 316.4 541.5 315 540.2 C 315 544.1 315 548 315 551.9 L 314.1 551.9 C 314.1 543.9 314.1 535.7 314.1 527.7 L 315 527.7 C 315 531.5 315 535.5 315 539.4 C 316.4 538.1 317.6 536.4 317.8 534.5 C 318.3 535.9 319.3 537.5 321 537.8 C 322.2 537.8 322.5 536.3 322.8 535.4 C 323.1 533.7 323.1 531.8 322.6 530.1 C 322.2 529 320.9 528 319.6 528.3 C 318.6 529 320.6 529.6 320.3 530.6 C 320.5 532 318.8 533 317.6 532.3 C 316.3 531.6 316.4 529.7 317.4 528.8 C 318 528.1 319.3 527.7 320.3 527.7 C 321.2 527.7 321.8 527.7 322.6 528 C 324.6 528.7 325.7 530.7 325.9 532.7 C 326.2 534.9 324.9 537.3 322.8 538.2 C 321.5 538.7 319.9 538.3 318.8 537.3 C 318.7 538.3 318.2 539.2 317.7 539.9 C 318.1 540.6 318.6 541.8 318.8 542.1 C 320.1 540.9 322.5 540.8 323.8 542 C 325.2 543.1 326.1 545 325.9 546.8 z \"/></g><g transform=\"matrix(1,0,0,1.030928,-309.364,-543.9805)\"><path d=\"M 312.2 551.9 L 309.4 551.9 L 309.4 527.7 L 312.2 527.7 L 312.2 551.9 z \"/></g></svg>',\n    getBoundingBox: (gap, xAnchor, yAnchor) => ({\n      height: gap * 3,\n      width: (gap * 3) * (18 / 25),\n      x: xAnchor,\n      y: yAnchor - (gap * (3 / 2))\n    })\n  },\n  G: {\n    svg: '<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.0\" width=\"15\" height=\"40\"><g><path d=\"m 12 3.4 c 0.3 3.1 -2 5.6 -4.1 7.6 -0.9 0.9 -0.2 0.1 -0.6 0.6 -0.1 -0.5 -0.3 -1.7 -0.3 -2.1 0.1 -2.6 2.3 -6.5 4.2 -7.9 0.3 0.6 0.6 0.6 0.8 1.8 z m 0.7 15.9 c -1.2 -0.9 -2.8 -1.1 -4.3 -0.9 -0.2 -1.2 -0.4 -2.5 -0.6 -3.7 2.4 -2.3 4.9 -4.9 5 -8.4 0.1 -2.2 -0.3 -4.6 -1.7 -6.4 C 9.5 0.1 8.3 2.1 7.4 3.3 c -1.5 2.6 -1.1 5.8 -0.6 8.6 -0.8 0.9 -1.9 1.7 -2.7 2.7 -2.4 2.3 -4.4 5.3 -4 8.7 0.2 3.3 2.6 6.3 5.9 7.1 1.2 0.3 2.6 0.3 3.8 0.1 0.2 2.2 1 4.5 0.1 6.7 -0.7 1.6 -2.8 2.9 -4.3 2.2 -0.6 -0.3 -0.1 -0.1 -0.5 -0.2 1.1 -0.3 2 -1 2.3 -1.5 0.8 -1.4 -0.4 -3.6 -2.2 -3.3 -2.3 0 -3.2 3.1 -1.7 4.6 1.3 1.5 3.8 1.3 5.4 0.3 1.8 -1.2 2 -3.5 1.8 -5.5 -0.1 -0.7 -0.4 -2.6 -0.4 -3.3 0.7 -0.2 0.2 -0.1 1.2 -0.4 2.7 -1 4.4 -4.2 3.6 -7 -0.3 -1.4 -1 -2.9 -2.3 -3.7 z m 0.6 5.7 c 0.2 2 -1.1 4.2 -3.1 4.9 -0.1 -0.8 -0.2 -1 -0.3 -1.4 -0.5 -2.4 -0.7 -4.9 -1.1 -7.3 1.6 -0.2 3.5 0.5 4 2.1 0.2 0.6 0.3 1.2 0.4 1.8 z m -5.1 5.1 c -2.5 0.1 -5 -1.6 -5.6 -4 -0.7 -2.1 -0.5 -4.5 0.8 -6.4 1.1 -1.7 2.6 -3 4 -4.5 0.2 1.1 0.4 2.2 0.5 3.3 -3 0.8 -5 4.6 -3.2 7.3 0.5 0.8 2 2.2 2.8 1.6 -1.1 -0.7 -2 -1.8 -1.8 -3.2 -0.1 -1.3 1.4 -2.9 2.7 -3.1 0.4 2.8 0.9 6 1.4 8.8 -0.5 0.1 -1 0.1 -1.5 0.1 z\"/></g></svg>',\n    getBoundingBox: (gap, xAnchor, yAnchor) => ({\n      height: gap * (15 / 2),\n      width: (gap * (15 / 2)) * (15 / 40),\n      x: xAnchor,\n      y: yAnchor - (gap * (9 / 2))\n    })\n  }\n};\n\n/**\n * @type {{accidental: String, arpeggiate: String, bar: String, beam: String, clef: String, decoration: String, dots: String, head: String, ledgerLine: String, rest: String, staff: String, stem: String, tieOrSlur: String, timeSignature: String}}\n */\nexport const MusicSymbols = {\n  accidental: 'accidental',\n  arpeggiate: 'arpeggiate',\n  bar: 'bar',\n  beam: 'beam',\n  clef: 'clef',\n  decoration: 'decoration',\n  dots: 'dots',\n  head: 'head',\n  ledgerLine: 'ledgerLine',\n  rest: 'rest',\n  staff: 'staff',\n  stem: 'stem',\n  tieOrSlur: 'tieOrSlur',\n  timeSignature: 'timeSignature',\n};\n\nfunction createImage(clef, src) {\n  // eslint-disable-next-line no-undef\n  const browserDocument = document;\n  const img = browserDocument.createElement('img');\n  img.dataset.clef = clef;\n  img.src = src;\n  img.style.display = 'none';\n  return img;\n}\n\n/**\n * Retrieve music symbols elements\n * @return {Array<Element>} music symbols elements to attach\n */\nexport function getMusicClefElements() {\n  return Object.keys(MusicClefs)\n    .map(key => createImage(key, `data:image/svg+xml,${MusicClefs[key].svg}`));\n}\n\nfunction drawStaff(context, staff) {\n  for (let i = 0; i < staff.count; i++) {\n    const p1 = { x: 0, y: staff.top + (i * staff.gap) };\n    const p2 = { x: context.canvas.width, y: staff.top + (i * staff.gap) };\n    drawLine(context, p1, p2);\n  }\n}\n\nfunction drawClef(context, clef) {\n  // eslint-disable-next-line no-undef\n  context.drawImage(context.canvas.parentElement.querySelector(`img[data-clef=${clef.value.symbol}]`), clef.boundingBox.x, clef.boundingBox.y, clef.boundingBox.width, clef.boundingBox.height);\n}\n\n/**\n * Draw a music symbol\n * @param {Object} context Current rendering context\n * @param {Object} symbol Symbol to draw\n */\nexport function drawMusicSymbol(context, symbol) {\n  logger.debug(`draw ${symbol.type} symbol`);\n  switch (symbol.type) {\n    case MusicSymbols.clef:\n      drawClef(context, symbol);\n      break;\n    case MusicSymbols.staff:\n      drawStaff(context, symbol);\n      break;\n    default:\n      logger.error(`${symbol.type} not implemented`);\n  }\n}\n","import { modelLogger as logger } from '../configuration/LoggerConfig';\n\n/**\n * Stroke symbol\n * @typedef {Object} Stroke\n * @property {String} type=stroke Symbol type, 'stroke' for stroke\n * @property {String} pointerType=undefined Pointer type\n * @property {Number} pointerId=undefined Pointer id\n * @property {Array<Number>} x=[] X coordinates\n * @property {Array<Number>} y=[] Y coordinates\n * @property {Array<Number>} t=[] Timestamps matching x,y coordinates\n * @property {Array<Number>} p=[] Pressure\n * @property {Array<Number>} l=[] Length from origin\n * @property {Number} width=0 (for rendering) Pen/brush width\n * @property {String} color=undefined (for rendering) Pen/brush color\n */\n\n/**\n * pointerEvents symbol\n * @typedef {Object} pointerEvents\n * @property {String} type=pointerEvents Symbol type, 'pointerEvents' for pointerEvents\n * @property {Boolean} processGestures=False indicates if the gestures have to be processed\n * @property {Array<Stroke>} events=[] the events to process\n */\n\nfunction computeDistance(x, y, xArray, yArray, lastIndexPoint) {\n  const distance = Math.sqrt(Math.pow((y - yArray[lastIndexPoint - 1]), 2) + Math.pow((x - xArray[lastIndexPoint - 1]), 2));\n  return isNaN(distance) ? 0 : distance;\n}\n\nfunction computeLength(x, y, xArray, yArray, lArray, lastIndexPoint) {\n  const length = lArray[lastIndexPoint - 1] + computeDistance(x, y, xArray, yArray, lastIndexPoint);\n  return isNaN(length) ? 0 : length;\n}\n\nfunction computePressure(x, y, xArray, yArray, lArray, lastIndexPoint) {\n  let ratio = 1.0;\n  const distance = computeDistance(x, y, xArray, yArray, lastIndexPoint);\n  const length = computeLength(x, y, xArray, yArray, lArray, lastIndexPoint);\n\n  if (length === 0) {\n    ratio = 0.5;\n  } else if (distance === length) {\n    ratio = 1.0;\n  } else if (distance < 10) {\n    ratio = 0.2 + Math.pow(0.1 * distance, 0.4);\n  } else if (distance > length - 10) {\n    ratio = 0.2 + Math.pow(0.1 * (length - distance), 0.4);\n  }\n  const pressure = ratio * Math.max(0.1, 1.0 - (0.1 * Math.sqrt(distance)));\n  return isNaN(parseFloat(pressure)) ? 0.5 : pressure;\n}\n\nfunction filterPointByAcquisitionDelta(x, y, xArray, yArray, width) {\n  const delta = (2 + (width / 4));\n  let ret = false;\n  if (xArray.length === 0 || yArray.length === 0 || Math.abs(xArray[xArray.length - 1] - x) >= delta || Math.abs(yArray[yArray.length - 1] - y) >= delta) {\n    ret = true;\n  }\n  return ret;\n}\n\n/**\n * Create a new stroke\n * @param {Object} properties Properties to be applied to the stroke.\n * @return {Stroke} New stroke with properties for quadratics draw\n */\nexport function createStrokeComponent(properties) {\n  const defaultStroke = {\n    type: 'stroke',\n    x: [],\n    y: [],\n    t: [],\n    p: [],\n    l: [],\n    width: 0\n  };\n  return Object.assign({}, defaultStroke, properties);\n}\n\n/**\n * Get a JSON copy of a stroke by filtering its properties\n * @param {Stroke} stroke Current stroke\n * @return {{type: String, x: Array<Number>, y: Array<Number>, t: Array<Number>}} Simplified stroke object\n */\nexport function toJSON(stroke) {\n  return { type: stroke.type, x: stroke.x, y: stroke.y, t: stroke.t };\n}\n\n/**\n * Get a JSON copy of a stroke by filtering its properties\n * @param {Stroke} stroke Current stroke\n * @return {{x: Array<Number>, y: Array<Number>, t: Array<Number>}} Simplified stroke object\n */\nexport function toJSONV4(stroke) {\n  return { x: stroke.x, y: stroke.y, t: stroke.t };\n}\n\n/**\n * Mutate a stroke by adding a point to it.\n * @param {Stroke} stroke Current stroke\n * @param {{x: Number, y: Number, t: Number}} point Point to add\n * @return {Stroke} Updated stroke\n */\nexport function addPoint(stroke, point) {\n  const strokeReference = stroke;\n  if (filterPointByAcquisitionDelta(point.x, point.y, strokeReference.x, strokeReference.y, strokeReference.width)) {\n    strokeReference.x.push(point.x);\n    strokeReference.y.push(point.y);\n    strokeReference.t.push(point.t);\n    strokeReference.p.push(computePressure(point.x, point.y, strokeReference.x, strokeReference.y, strokeReference.l, strokeReference.x.length - 1));\n    strokeReference.l.push(computeLength(point.x, point.y, strokeReference.x, strokeReference.y, strokeReference.l, strokeReference.x.length - 1));\n  } else {\n    logger.trace('ignore filtered point', point);\n  }\n  return strokeReference;\n}\n\n/**\n * Slice a stroke and return the sliced part of it\n * @param {Stroke} stroke Current stroke\n * @param {Number} [start=0] Zero-based index at which to begin extraction\n * @param {Number} [end=length] Zero-based index at which to end extraction\n * @return {Stroke} Sliced stroke\n */\nexport function slice(stroke, start = 0, end = stroke.x.length) {\n  const slicedStroke = createStrokeComponent({ color: stroke.color, width: stroke.width });\n  for (let i = start; i < end; i++) {\n    addPoint(slicedStroke, {\n      x: stroke.x[i],\n      y: stroke.y[i],\n      t: stroke.t[i]\n    });\n  }\n  return slicedStroke;\n}\n\n/**\n * Extract point by index\n * @param {Stroke} stroke Current stroke\n * @param {Number} index Zero-based index\n * @return {{x: Number, y: Number, t: Number, p: Number, l: Number}} Point with properties for quadratics draw\n */\nexport function getPointByIndex(stroke, index) {\n  let point;\n  if (index !== undefined && index >= 0 && index < stroke.x.length) {\n    point = {\n      x: stroke.x[index],\n      y: stroke.y[index],\n      t: stroke.t[index],\n      p: stroke.p[index],\n      l: stroke.l[index]\n    };\n  }\n  return point;\n}\n","import { MusicClefs } from '../renderer/canvas/symbols/MusicSymbolCanvasRenderer';\nimport Constants from '../configuration/Constants';\n\nfunction mergeBounds(boundsA, boundsB) {\n  return {\n    minX: Math.min(boundsA.minX, boundsB.minX),\n    maxX: Math.max(boundsA.maxX, boundsB.maxX),\n    minY: Math.min(boundsA.minY, boundsB.minY),\n    maxY: Math.max(boundsA.maxY, boundsB.maxY)\n  };\n}\n\nfunction getLineBounds(line) {\n  return {\n    minX: Math.min(line.firstPoint.x, line.lastPoint.x),\n    maxX: Math.max(line.firstPoint.x, line.lastPoint.x),\n    minY: Math.min(line.firstPoint.y, line.lastPoint.y),\n    maxY: Math.max(line.firstPoint.y, line.lastPoint.y)\n  };\n}\n\nfunction getEllipseBounds(ellipse) {\n  const angleStep = 0.02; // angle delta between interpolated points on the arc, in radian\n\n  let z1 = Math.cos(ellipse.orientation);\n  let z3 = Math.sin(ellipse.orientation);\n  let z2 = z1;\n  let z4 = z3;\n  z1 *= ellipse.maxRadius;\n  z2 *= ellipse.minRadius;\n  z3 *= ellipse.maxRadius;\n  z4 *= ellipse.minRadius;\n\n  const n = Math.abs(ellipse.sweepAngle) / angleStep;\n\n  const x = [];\n  const y = [];\n\n  for (let i = 0; i <= n; i++) {\n    const angle = ellipse.startAngle + ((i / n) * ellipse.sweepAngle);\n    const alpha = Math.atan2(Math.sin(angle) / ellipse.minRadius, Math.cos(angle) / ellipse.maxRadius);\n\n    const cosAlpha = Math.cos(alpha);\n    const sinAlpha = Math.sin(alpha);\n\n    x.push(ellipse.center.x + ((z1 * cosAlpha) - (z4 * sinAlpha)));\n    y.push(ellipse.center.y + ((z2 * sinAlpha) + (z3 * cosAlpha)));\n  }\n\n  return {\n    minX: Math.min(...x),\n    maxX: Math.max(...x),\n    minY: Math.min(...y),\n    maxY: Math.max(...y)\n  };\n}\n\nfunction getTextLineBounds(textLine) {\n  return {\n    minX: textLine.data.topLeftPoint.x,\n    maxX: textLine.data.topLeftPoint.x + textLine.data.width,\n    minY: textLine.data.topLeftPoint.y,\n    maxY: textLine.data.topLeftPoint.y + textLine.data.height\n  };\n}\n\nfunction getClefBounds(clef) {\n  return {\n    minX: clef.boundingBox.x,\n    maxX: clef.boundingBox.x + clef.boundingBox.width,\n    minY: clef.boundingBox.y,\n    maxY: clef.boundingBox.y + clef.boundingBox.height\n  };\n}\n\nfunction getStrokeBounds(stroke) {\n  return {\n    minX: Math.min(...stroke.x),\n    maxX: Math.max(...stroke.x),\n    minY: Math.min(...stroke.y),\n    maxY: Math.max(...stroke.y)\n  };\n}\n\n/**\n * Get the box enclosing the given symbols\n * @param {Array} symbols Symbols to extract bounds from\n * @param {Bounds} [bounds] Starting bounds for recursion\n * @return {Bounds} Bounding box enclosing symbols\n */\nexport function getSymbolsBounds(symbols, bounds = { minX: Number.MAX_VALUE, maxX: Number.MIN_VALUE, minY: Number.MAX_VALUE, maxY: Number.MIN_VALUE }) {\n  let boundsRef = bounds;\n  boundsRef = symbols\n    .filter(symbol => symbol.type === 'stroke')\n    .map(getStrokeBounds)\n    .reduce(mergeBounds, boundsRef);\n  boundsRef = symbols\n    .filter(symbol => symbol.type === 'clef')\n    .map(getClefBounds)\n    .reduce(mergeBounds, boundsRef);\n  boundsRef = symbols\n    .filter(symbol => symbol.type === 'line')\n    .map(getLineBounds)\n    .reduce(mergeBounds, boundsRef);\n  boundsRef = symbols\n    .filter(symbol => symbol.type === 'ellipse')\n    .map(getEllipseBounds)\n    .reduce(mergeBounds, boundsRef);\n  boundsRef = symbols\n    .filter(symbol => symbol.type === 'textLine')\n    .map(getTextLineBounds)\n    .reduce(mergeBounds, boundsRef);\n  return boundsRef;\n}\n\nfunction getDefaultMusicSymbols(configuration) {\n  const defaultStaff = Object.assign({}, { type: 'staff' }, configuration.recognitionParams.v3.musicParameter.staff);\n  const defaultClef = {\n    type: 'clef',\n    value: Object.assign({}, configuration.recognitionParams.v3.musicParameter.clef)\n  };\n  defaultClef.value.yAnchor = defaultStaff.top + (defaultStaff.gap * (defaultStaff.count - defaultClef.value.line));\n  delete defaultClef.value.line;\n  defaultClef.boundingBox = MusicClefs[defaultClef.value.symbol].getBoundingBox(defaultStaff.gap, 0, defaultClef.value.yAnchor);\n  return [defaultStaff, defaultClef];\n}\n\n/**\n * Get the default symbols for the current recognition type\n * @param {Configuration} configuration Current recognition parameters from which extract default symbols\n * @return {Array} Symbols matching configuration\n */\nexport function getDefaultSymbols(configuration) {\n  switch (configuration.recognitionParams.type) {\n    case Constants.RecognitionType.MUSIC:\n      return getDefaultMusicSymbols(configuration);\n    default:\n      return [];\n  }\n}\n","import { modelLogger as logger } from '../configuration/LoggerConfig';\nimport * as StrokeComponent from './StrokeComponent';\nimport { getSymbolsBounds, getDefaultSymbols } from './Symbol';\n\n/**\n * Recognition positions\n * @typedef {Object} RecognitionPositions\n * @property {Number} [lastSentPosition=-1] Index of the last sent stroke.\n * @property {Number} [lastReceivedPosition=-1] Index of the last received stroke.\n * @property {Number} [lastRenderedPosition=-1] Last rendered recognized symbol position\n */\n\n/**\n * Raw results\n * @typedef {Object} RawResults\n * @property {Object} convert=undefined The convert result\n * @property {Object} exports=undefined The exports output as return by the recognition service.\n */\n\n/**\n * Editor model\n * @typedef {Object} Model\n * @property {Stroke} currentStroke=undefined Stroke in building process.\n * @property {Array<Stroke>} rawStrokes=[] List of captured strokes.\n * @property {Array} strokeGroups=[] Group of strokes with same pen style.\n * @property {RecognitionPositions} lastPositions Last recognition sent/received stroke indexes.\n * @property {Array<Object>} defaultSymbols=[] Default symbols, relative to the current recognition type.\n * @property {Array<Object>} recognizedSymbols=undefined Symbols to render (e.g. stroke, shape primitives, string, characters...).\n * @property {Object} exports=undefined Result of the export (e.g. mathml, latex, text...).\n * @property {RawResults} rawResults The recognition output as return by the recognition service.\n * @property {Number} creationTime Date of creation timestamp.\n * @property {Number} modificationTime=undefined Date of lastModification.\n */\n\n/**\n * Bounding box\n * @typedef {Object} Bounds\n * @property {Number} minX Minimal x coordinate\n * @property {Number} maxX Maximal x coordinate\n * @property {Number} minY Minimal y coordinate\n * @property {Number} maxY Maximal y coordinate\n */\n\n/**\n * Create a new model\n * @param {Configuration} [configuration] Parameters to use to populate default recognition symbols\n * @return {Model} New model\n */\nexport function createModel(configuration) {\n  // see @typedef documentation on top\n  return {\n    currentStroke: undefined,\n    rawStrokes: [],\n    strokeGroups: [],\n    lastPositions: {\n      lastSentPosition: -1,\n      lastReceivedPosition: -1,\n      lastRenderedPosition: -1\n    },\n    defaultSymbols: configuration ? getDefaultSymbols(configuration) : [],\n    recognizedSymbols: undefined,\n    exports: undefined,\n    rawResults: {\n      convert: undefined,\n      exports: undefined\n    },\n    creationTime: new Date().getTime(),\n    modificationTime: undefined\n  };\n}\n\n/**\n * Clear the model.\n * @param {Model} model Current model\n * @return {Model} Cleared model\n */\nexport function clearModel(model) {\n  const modelReference = model;\n  modelReference.currentStroke = undefined;\n  modelReference.rawStrokes = [];\n  modelReference.strokeGroups = [];\n  modelReference.lastPositions.lastSentPosition = -1;\n  modelReference.lastPositions.lastReceivedPosition = -1;\n  modelReference.lastPositions.lastRenderedPosition = -1;\n  modelReference.recognizedSymbols = undefined;\n  modelReference.exports = undefined;\n  modelReference.rawResults.convert = undefined;\n  modelReference.rawResults.exports = undefined;\n  return modelReference;\n}\n\n/**\n * Check if the model needs to be redrawn.\n * @param {Model} model Current model\n * @return {Boolean} True if the model needs to be redrawn, false otherwise\n */\nexport function needRedraw(model) {\n  return model.recognizedSymbols ? (model.rawStrokes.length !== model.recognizedSymbols.filter(symbol => symbol.type === 'stroke').length) : false;\n}\n\n/**\n * Mutate the model given in parameter by adding the new strokeToAdd.\n * @param {Model} model Current model\n * @param {Stroke} stroke Stroke to be added to pending ones\n * @return {Model} Updated model\n */\nexport function addStroke(model, stroke) {\n  // We use a reference to the model. The purpose here is to update the pending stroke only.\n  const modelReference = model;\n  logger.debug('addStroke', stroke);\n  modelReference.rawStrokes.push(stroke);\n  return modelReference;\n}\n\n/**\n * Mutate the model given in parameter by adding the new strokeToAdd and the penstyle. Used for iink REST.\n * @param {Model} model Current model\n * @param {Stroke} stroke Stroke to be added to pending ones\n * @param {PenStyle} strokePenStyle\n * @return {Model} Updated model\n */\nexport function addStrokeToGroup(model, stroke, strokePenStyle) {\n  // We use a reference to the model. The purpose here is to update the pending stroke only.\n  const modelReference = model;\n  logger.debug('addStroke', stroke);\n  const lastGroup = modelReference.strokeGroups.length - 1;\n  if (modelReference.strokeGroups[lastGroup] && modelReference.strokeGroups[lastGroup].penStyle === strokePenStyle) {\n    modelReference.strokeGroups[lastGroup].strokes.push(stroke);\n  } else {\n    const newStrokeGroup = {\n      penStyle: strokePenStyle,\n      strokes: []\n    };\n    const strokeCopy = {};\n    Object.assign(strokeCopy, stroke);\n    newStrokeGroup.strokes.push(strokeCopy);\n    modelReference.strokeGroups.push(newStrokeGroup);\n  }\n  return modelReference;\n}\n\n/**\n * Get the strokes that needs to be recognized\n * @param {Model} model Current model\n * @param {Number} [position=lastReceived] Index from where to extract strokes\n * @return {Array<Stroke>} Pending strokes\n */\nexport function extractPendingStrokes(model, position = model.lastPositions.lastReceivedPosition + 1) {\n  return model.rawStrokes.slice(position);\n}\n\n/**\n * Mutate the model by adding a point and close the current stroke.\n * @param {Model} model Current model\n * @param {{x: Number, y: Number, t: Number}} point Captured point to create current stroke\n * @param {Object} properties Properties to be applied to the current stroke\n * @param {Number} [dpi=96] The screen dpi resolution\n * @return {Model} Updated model\n */\nexport function initPendingStroke(model, point, properties, dpi = 96) {\n  if (properties && properties['-myscript-pen-width']) {\n    const pxWidth = (properties['-myscript-pen-width'] * dpi) / 25.4;\n    Object.assign(properties, { width: pxWidth / 2 }); // FIXME hack to get better render\n  }\n  const modelReference = model;\n  logger.trace('initPendingStroke', point);\n  // Setting the current stroke to an empty one\n  modelReference.currentStroke = StrokeComponent.createStrokeComponent(properties);\n  modelReference.currentStroke = StrokeComponent.addPoint(modelReference.currentStroke, point);\n  return modelReference;\n}\n\n/**\n * Mutate the model by adding a point to the current pending stroke.\n * @param {Model} model Current model\n * @param {{x: Number, y: Number, t: Number}} point Captured point to be append to the current stroke\n * @return {Model} Updated model\n */\nexport function appendToPendingStroke(model, point) {\n  const modelReference = model;\n  if (modelReference.currentStroke) {\n    logger.trace('appendToPendingStroke', point);\n    modelReference.currentStroke = StrokeComponent.addPoint(modelReference.currentStroke, point);\n  }\n  return modelReference;\n}\n\n/**\n * Mutate the model by adding the new point on a initPendingStroke.\n * @param {Model} model Current model\n * @param {{x: Number, y: Number, t: Number}} point Captured point to be append to the current stroke\n * @param {PenStyle} penStyle\n * @return {Model} Updated model\n */\nexport function endPendingStroke(model, point, penStyle) {\n  const modelReference = model;\n  if (modelReference.currentStroke) {\n    logger.trace('endPendingStroke', point);\n    const currentStroke = StrokeComponent.addPoint(modelReference.currentStroke, point);\n    // Mutating pending strokes\n    addStroke(modelReference, currentStroke);\n    addStrokeToGroup(modelReference, currentStroke, penStyle);\n    // Resetting the current stroke to an undefined one\n    delete modelReference.currentStroke;\n  }\n  return modelReference;\n}\n\n/**\n * Get the bounds of the current model.\n * @param {Model} model Current model\n * @return {Bounds} Bounding box enclosing the current drawn model\n */\nexport function getBorderCoordinates(model) {\n  let modelBounds = { minX: Number.MAX_VALUE, maxX: Number.MIN_VALUE, minY: Number.MAX_VALUE, maxY: Number.MIN_VALUE };\n\n  // Default symbols\n  if (model.defaultSymbols && model.defaultSymbols.length > 0) {\n    modelBounds = getSymbolsBounds(model.defaultSymbols, modelBounds);\n  }\n  // Recognized symbols\n  if (model.recognizedSymbols && model.recognizedSymbols.length > 0) {\n    modelBounds = getSymbolsBounds(model.recognizedSymbols, modelBounds);\n    // Pending strokes\n    modelBounds = getSymbolsBounds(extractPendingStrokes(model), modelBounds);\n  } else {\n    modelBounds = getSymbolsBounds(model.rawStrokes, modelBounds);\n  }\n  return modelBounds;\n}\n\n/**\n * Extract strokes from an ink range\n * @param {Model} model Current model\n * @param {Number} firstStroke First stroke index to extract\n * @param {Number} lastStroke Last stroke index to extract\n * @param {Number} firstPoint First point index to extract\n * @param {Number} lastPoint Last point index to extract\n * @return {Array<Stroke>} The extracted strokes\n */\nexport function extractStrokesFromInkRange(model, firstStroke, lastStroke, firstPoint, lastPoint) {\n  return model.rawStrokes.slice(firstStroke, lastStroke + 1).map((stroke, index, slicedStrokes) => {\n    if (slicedStrokes.length < 2) {\n      return StrokeComponent.slice(stroke, firstPoint, lastPoint + 1);\n    }\n    if (index === 0) {\n      return StrokeComponent.slice(stroke, firstPoint);\n    }\n    if (index === (slicedStrokes.length - 1)) {\n      return StrokeComponent.slice(stroke, 0, lastPoint + 1);\n    }\n    return stroke;\n  });\n}\n\n/**\n * Update model lastSentPosition\n * @param {Model} model\n * @param {Number} [position]\n * @return {Model}\n */\nexport function updateModelSentPosition(model, position = model.rawStrokes.length - 1) {\n  const modelReference = model;\n  modelReference.lastPositions.lastSentPosition = position;\n  return modelReference;\n}\n\n/**\n * Update model lastReceivedPosition regarding to lastSentPosition\n * @param {Model} model\n * @return {Model}\n */\nexport function updateModelReceivedPosition(model) {\n  const modelReference = model;\n  modelReference.lastPositions.lastReceivedPosition = modelReference.lastPositions.lastSentPosition;\n  return modelReference;\n}\n\n/**\n * Reset model lastReceivedPosition and lastSentPosition\n * @param {Model} model\n * @return {Model}\n */\nexport function resetModelPositions(model) {\n  const modelReference = model;\n  modelReference.lastPositions.lastSentPosition = -1;\n  modelReference.lastPositions.lastReceivedPosition = -1;\n  return modelReference;\n}\n\n/**\n * Reset model lastRenderedPosition\n * @param {Model} model\n * @return {Model}\n */\nexport function resetModelRendererPosition(model) {\n  const modelReference = model;\n  modelReference.lastPositions.lastRenderedPosition = -1;\n  return modelReference;\n}\n\n/**\n * Update model lastRenderedPosition\n * @param {Model} model\n * @param {Number} [position]\n * @return {Model}\n */\nexport function updateModelRenderedPosition(model, position = model.recognizedSymbols ? model.recognizedSymbols.length - 1 : -1) {\n  const modelReference = model;\n  modelReference.lastPositions.lastRenderedPosition = position;\n  return modelReference;\n}\n\n/**\n * Get the symbols that needs to be rendered\n * @param {Model} model Current model\n * @param {Number} [position=lastRendered] Index from where to extract symbols\n * @return {Array<Object>}\n */\nexport function extractPendingRecognizedSymbols(model, position = model.lastPositions.lastRenderedPosition + 1) {\n  return model.recognizedSymbols ? model.recognizedSymbols.slice(position) : [];\n}\n\n/**\n * Clone model\n * @param {Model} model Current model\n * @return {Model} Clone of the current model\n */\nexport function cloneModel(model) {\n  const clonedModel = Object.assign({}, model);\n  // We clone the properties that need to be. Take care of arrays.\n  clonedModel.defaultSymbols = [...model.defaultSymbols];\n  clonedModel.currentStroke = model.currentStroke ? Object.assign({}, model.currentStroke) : undefined;\n  clonedModel.rawStrokes = [...model.rawStrokes];\n  clonedModel.strokeGroups = JSON.parse(JSON.stringify(model.strokeGroups));\n  clonedModel.lastPositions = Object.assign({}, model.lastPositions);\n  clonedModel.exports = model.exports ? Object.assign({}, model.exports) : undefined;\n  clonedModel.rawResults = Object.assign({}, model.rawResults);\n  clonedModel.recognizedSymbols = model.recognizedSymbols ? [...model.recognizedSymbols] : undefined;\n  return clonedModel;\n}\n\n/**\n * Merge models\n * @param {...Model} models Models to merge (ordered)\n * @return {Model} Updated model\n */\nexport function mergeModels(...models) {\n  return models.reduce((a, b) => {\n    const modelRef = a;\n    modelRef.recognizedSymbols = b.recognizedSymbols;\n    modelRef.lastPositions.lastSentPosition = b.lastPositions.lastSentPosition;\n    modelRef.lastPositions.lastReceivedPosition = b.lastPositions.lastReceivedPosition;\n    modelRef.lastPositions.lastRenderedPosition = b.lastPositions.lastRenderedPosition;\n    modelRef.rawResults = b.rawResults;\n    modelRef.exports = b.exports;\n    return modelRef;\n  });\n}\n","import { rendererLogger as logger } from '../../configuration/LoggerConfig';\nimport { drawStroke } from './symbols/StrokeSymbolCanvasRenderer';\nimport { drawTextSymbol, TextSymbols } from './symbols/TextSymbolCanvasRenderer';\nimport { drawShapeSymbol, ShapeSymbols } from './symbols/ShapeSymbolCanvasRenderer';\nimport {\n  drawMusicSymbol,\n  getMusicClefElements,\n  MusicSymbols\n} from './symbols/MusicSymbolCanvasRenderer';\nimport * as InkModel from '../../model/InkModel';\n\n/**\n * Renderer info\n * @typedef {Object} RendererInfo\n * @property {String} type Renderer type.\n * @property {String} apiVersion Supported api version.\n */\n\n/**\n * Default renderer\n * @typedef {Object} Renderer\n * @property {function(): RendererInfo} getInfo Get some information about this renderer\n * @property {function(element: Element, minHeight: Number, minWidth: Number): Object} attach Populate the DOM element to create rendering area.\n * @property {function(element: Element, context: Object)} detach Remove rendering area from the DOM element.\n * @property {function(context: Object, model: Model, stroker: Stroker)} resize Explicitly resize the rendering area.\n * @property {function(context: Object, model: Model, stroker: Stroker): Model} drawCurrentStroke Draw the model currentStroke.\n * @property {function(context: Object, model: Model, stroker: Stroker): Model} drawModel Draw the model defaultSymbols and recognizedSymbols.\n */\n\n/**\n * Get info\n * @return {RendererInfo} Information about this renderer\n */\nexport function getInfo() {\n  return {\n    type: 'canvas',\n    apiVersion: 'V3'\n  };\n}\n\nfunction getPixelRatio(canvas) {\n  if (canvas) {\n    const context = canvas.getContext('2d');\n    // we are using a browser object\n    // eslint-disable-next-line no-undef\n    const devicePixelRatio = window.devicePixelRatio || 1;\n    const backingStoreRatio = context.webkitBackingStorePixelRatio ||\n        context.mozBackingStorePixelRatio ||\n        context.msBackingStorePixelRatio ||\n        context.oBackingStorePixelRatio ||\n        context.backingStorePixelRatio || 1;\n    return devicePixelRatio / backingStoreRatio;\n  }\n  return 1;\n}\n\nfunction detectPixelRatio(element) {\n  // we are using a browser object\n  // eslint-disable-next-line no-undef\n  const tempCanvas = document.createElement('canvas');\n  const canvasRatio = getPixelRatio(tempCanvas);\n  // document.removeChild(tempCanvas);\n  return canvasRatio;\n}\n\nfunction createCanvas(element, type) {\n  // eslint-disable-next-line no-undef\n  const browserDocument = document;\n  const canvas = browserDocument.createElement('canvas');\n  canvas.classList.add(type);\n  canvas.classList.add('ms-canvas');\n  element.appendChild(canvas);\n  logger.debug('canvas created', canvas);\n  return canvas;\n}\n\nfunction resizeContent(context) {\n  const elements = [context.renderingCanvas, context.capturingCanvas];\n  elements.forEach((canvas) => {\n    const domElement = canvas.parentNode;\n    const width = domElement.clientWidth < context.minWidth ? context.minWidth : domElement.clientWidth;\n    const height = domElement.clientHeight < context.minHeight ? context.minHeight : domElement.clientHeight;\n    /* eslint-disable no-param-reassign */\n    canvas.width = width * context.pixelRatio;\n    canvas.height = height * context.pixelRatio;\n    canvas.style.width = `${width}px`;\n    canvas.style.height = `${height}px`;\n    /* eslint-enable no-param-reassign */\n    canvas.getContext('2d').scale(context.pixelRatio, context.pixelRatio);\n    logger.debug('canvas size changed', canvas);\n  });\n  return context;\n}\n\n/**\n * Attach the renderer to the DOM element\n * @param {Element} element DOM element to attach the rendering elements\n * @param {Number} [minHeight=0] Minimal height of the editor\n * @param {Number} [minWidth=0] Minimal width of the editor\n * @return {Object} The renderer context to give as parameter when a draw model will be call\n */\nexport function attach(element, minHeight = 0, minWidth = 0) {\n  logger.debug('attach renderer', element);\n  const pixelRatio = detectPixelRatio(element);\n  const resources = getMusicClefElements();\n  resources.forEach(clef => element.appendChild(clef));\n\n  const renderingCanvas = createCanvas(element, 'ms-rendering-canvas');\n  const capturingCanvas = createCanvas(element, 'ms-capture-canvas');\n\n  const context = {\n    pixelRatio,\n    minHeight,\n    minWidth,\n    renderingCanvas,\n    renderingCanvasContext: renderingCanvas.getContext('2d'),\n    capturingCanvas,\n    capturingCanvasContext: capturingCanvas.getContext('2d'),\n    resources\n  };\n\n  return resizeContent(context);\n}\n\n/**\n * Detach the renderer from the DOM element\n * @param {Element} element DOM element to attach the rendering elements\n * @param {Object} context Current rendering context\n */\nexport function detach(element, context) {\n  logger.debug('detach renderer', element);\n  context.resources.forEach(res => element.removeChild(res));\n  element.removeChild(context.renderingCanvas);\n  element.removeChild(context.capturingCanvas);\n}\n\n/**\n * Update the rendering context size\n * @param {Object} context Current rendering context\n * @param {Model} model Current model\n * @param {Stroker} stroker Current stroker\n * @return {Model}\n */\nexport function resize(context, model, stroker) {\n  return this.drawModel(resizeContent(context), model, stroker);\n}\n\nfunction drawSymbol(context, symbol, stroker) {\n  const type = symbol.elementType ? symbol.elementType : symbol.type;\n  logger.trace(`attempting to draw ${type} symbol`);\n  if (type === 'stroke') {\n    drawStroke(context, symbol, stroker);\n  } else if (TextSymbols[type]) {\n    drawTextSymbol(context, symbol);\n  } else if (ShapeSymbols[type]) {\n    drawShapeSymbol(context, symbol);\n  } else if (MusicSymbols[type]) {\n    drawMusicSymbol(context, symbol);\n  } else {\n    logger.warn(`impossible to draw ${type} symbol`);\n  }\n}\n\n/**\n * Draw the current stroke from the model\n * @param {Object} context Current rendering context\n * @param {Model} model Current model\n * @param {Stroker} stroker Current stroker\n * @return {Model}\n */\nexport function drawCurrentStroke(context, model, stroker) {\n  // Render the current stroke\n  context.capturingCanvasContext.clearRect(0, 0, context.capturingCanvas.width, context.capturingCanvas.height);\n  logger.trace('drawing current stroke ', model.currentStroke);\n  drawStroke(context.capturingCanvasContext, model.currentStroke, stroker);\n  return model;\n}\n\n/**\n * Draw all symbols contained into the model\n * @param {Object} context Current rendering context\n * @param {Model} model Current model\n * @param {Stroker} stroker Current stroker\n * @return {Model}\n */\nexport function drawModel(context, model, stroker) {\n  context.renderingCanvasContext.clearRect(0, 0, context.renderingCanvas.width, context.renderingCanvas.height);\n  // Displaying the default symbols and pending strokes\n  const symbols = [...model.defaultSymbols];\n  // Displaying the recognition symbols or raw strokes\n  if (model.recognizedSymbols) {\n    symbols.push(...model.recognizedSymbols);\n    symbols.push(...InkModel.extractPendingStrokes(model));\n  } else {\n    symbols.push(...model.rawStrokes);\n  }\n  symbols.forEach(symbol => drawSymbol(context.renderingCanvasContext, symbol, stroker));\n  context.capturingCanvasContext.clearRect(0, 0, context.capturingCanvas.width, context.capturingCanvas.height);\n  return model;\n}\n","/** ===============================================================================================\n * Compute quadratics control points\n * ============================================================================================= */\n\n/**\n *\n * @param {{x: Number, y: Number, p: Number}} point\n * @param angle\n * @param width\n * @return {[{x: Number, y: Number},{x: Number, y: Number}]}\n */\nexport function computeLinksPoints(point, angle, width) {\n  const radius = point.p * width;\n  return [{\n    x: (point.x - (Math.sin(angle) * radius)),\n    y: (point.y + (Math.cos(angle) * radius))\n  }, {\n    x: (point.x + (Math.sin(angle) * radius)),\n    y: (point.y - (Math.cos(angle) * radius))\n  }];\n}\n\n/**\n *\n * @param {{x: Number, y: Number, p: Number}} point1\n * @param {{x: Number, y: Number, p: Number}} point2\n * @return {{x: Number, y: Number, p: Number}}\n */\nexport function computeMiddlePoint(point1, point2) {\n  return {\n    x: ((point2.x + point1.x) / 2),\n    y: ((point2.y + point1.y) / 2),\n    p: ((point2.p + point1.p) / 2)\n  };\n}\n\n/**\n *\n * @param {{x: Number, y: Number}} begin\n * @param {{x: Number, y: Number}} end\n * @return {Number}\n */\nexport function computeAxeAngle(begin, end) {\n  return Math.atan2(end.y - begin.y, end.x - begin.x);\n}\n","import * as StrokeComponent from '../../../model/StrokeComponent';\nimport { computeLinksPoints, computeMiddlePoint, computeAxeAngle } from '../../QuadraticUtils';\n\n/**\n * Stroker info\n * @typedef {Object} StrokerInfo\n * @property {String} type Renderer type.\n * @property {String} name Stroker name.\n * @property {String} apiVersion Supported api version.\n */\n\n/**\n * Define how a stroke should be drawn\n * @typedef {Object} Stroker\n * @property {function(): StrokerInfo} getInfo Get some information about this stroker\n * @property {function(context: Object, stroke: Stroke)} drawStroke Render a stroke on the current context.\n */\n\n/**\n * Get info\n * @return {StrokerInfo} Information about this stroker\n */\nexport function getInfo() {\n  return {\n    type: 'canvas',\n    name: 'quadratic',\n    apiVersion: 'V3'\n  };\n}\n\nfunction renderArc(context, center, radius) {\n  context.arc(center.x, center.y, radius, 0, Math.PI * 2, true);\n}\n\nfunction renderLine(context, begin, end, width) {\n  const linkPoints1 = computeLinksPoints(begin, computeAxeAngle(begin, end), width);\n  const linkPoints2 = computeLinksPoints(end, computeAxeAngle(begin, end), width);\n\n  context.moveTo(linkPoints1[0].x, linkPoints1[0].y);\n  context.lineTo(linkPoints2[0].x, linkPoints2[0].y);\n  context.lineTo(linkPoints2[1].x, linkPoints2[1].y);\n  context.lineTo(linkPoints1[1].x, linkPoints1[1].y);\n}\n\nfunction renderFinal(context, begin, end, width) {\n  const ARCSPLIT = 6;\n  const angle = computeAxeAngle(begin, end);\n  const linkPoints = computeLinksPoints(end, angle, width);\n  context.moveTo(linkPoints[0].x, linkPoints[0].y);\n  for (let i = 1; i <= ARCSPLIT; i++) {\n    const newAngle = angle - ((i * Math.PI) / ARCSPLIT);\n    context.lineTo(end.x - ((end.p * width) * Math.sin(newAngle)), end.y + (end.p * width * Math.cos(newAngle)));\n  }\n}\n\nfunction renderQuadratic(context, begin, end, ctrl, width) {\n  const linkPoints1 = computeLinksPoints(begin, computeAxeAngle(begin, ctrl), width);\n  const linkPoints2 = computeLinksPoints(end, computeAxeAngle(ctrl, end), width);\n  const linkPoints3 = computeLinksPoints(ctrl, computeAxeAngle(begin, end), width);\n\n  context.moveTo(linkPoints1[0].x, linkPoints1[0].y);\n  context.quadraticCurveTo(linkPoints3[0].x, linkPoints3[0].y, linkPoints2[0].x, linkPoints2[0].y);\n  context.lineTo(linkPoints2[1].x, linkPoints2[1].y);\n  context.quadraticCurveTo(linkPoints3[1].x, linkPoints3[1].y, linkPoints1[1].x, linkPoints1[1].y);\n}\n\n/**\n * Draw a stroke on a canvas, using quadratics\n * @param {Object} context Current rendering context\n * @param {Stroke} stroke Current stroke to be drawn\n */\nexport function drawStroke(context, stroke) {\n  const contextReference = context;\n  const length = stroke.x.length;\n  const width = stroke.width > 0 ? stroke.width : contextReference.lineWidth;\n  const color = stroke.color ? stroke.color : contextReference.strokeStyle;\n  const firstPoint = StrokeComponent.getPointByIndex(stroke, 0);\n  const nbquadratics = length - 2;\n\n  contextReference.save();\n  try {\n    contextReference.beginPath();\n    if (length < 3) {\n      renderArc(contextReference, firstPoint, width * 0.6);\n    } else {\n      renderArc(contextReference, firstPoint, width * firstPoint.p);\n      renderLine(contextReference, firstPoint, computeMiddlePoint(firstPoint, StrokeComponent.getPointByIndex(stroke, 1)), width);\n\n      // Possibility to try this (the start looks better when the ink is large)\n      // var first = computeMiddlePoint(stroke[0], stroke[1]);\n      // contextReference.arc(first.x, first.y, width * first.p, 0, Math.PI * 2, true);\n\n      for (let i = 0; i < nbquadratics; i++) {\n        renderQuadratic(contextReference, computeMiddlePoint(StrokeComponent.getPointByIndex(stroke, i), StrokeComponent.getPointByIndex(stroke, i + 1)), computeMiddlePoint(StrokeComponent.getPointByIndex(stroke, i + 1), StrokeComponent.getPointByIndex(stroke, i + 2)), StrokeComponent.getPointByIndex(stroke, i + 1), width);\n      }\n      renderLine(contextReference, computeMiddlePoint(StrokeComponent.getPointByIndex(stroke, length - 2), StrokeComponent.getPointByIndex(stroke, length - 1)), StrokeComponent.getPointByIndex(stroke, length - 1), width);\n      renderFinal(contextReference, StrokeComponent.getPointByIndex(stroke, length - 2), StrokeComponent.getPointByIndex(stroke, length - 1), width);\n    }\n    contextReference.closePath();\n    if (color !== undefined) {\n      contextReference.fillStyle = color;\n      contextReference.fill();\n    }\n  } finally {\n    contextReference.restore();\n  }\n}\n","export var xhtml = \"http://www.w3.org/1999/xhtml\";\n\nexport default {\n  svg: \"http://www.w3.org/2000/svg\",\n  xhtml: xhtml,\n  xlink: \"http://www.w3.org/1999/xlink\",\n  xml: \"http://www.w3.org/XML/1998/namespace\",\n  xmlns: \"http://www.w3.org/2000/xmlns/\"\n};\n","import namespaces from \"./namespaces\";\n\nexport default function(name) {\n  var prefix = name += \"\", i = prefix.indexOf(\":\");\n  if (i >= 0 && (prefix = name.slice(0, i)) !== \"xmlns\") name = name.slice(i + 1);\n  return namespaces.hasOwnProperty(prefix) ? {space: namespaces[prefix], local: name} : name;\n}\n","import namespace from \"./namespace\";\nimport {xhtml} from \"./namespaces\";\n\nfunction creatorInherit(name) {\n  return function() {\n    var document = this.ownerDocument,\n        uri = this.namespaceURI;\n    return uri === xhtml && document.documentElement.namespaceURI === xhtml\n        ? document.createElement(name)\n        : document.createElementNS(uri, name);\n  };\n}\n\nfunction creatorFixed(fullname) {\n  return function() {\n    return this.ownerDocument.createElementNS(fullname.space, fullname.local);\n  };\n}\n\nexport default function(name) {\n  var fullname = namespace(name);\n  return (fullname.local\n      ? creatorFixed\n      : creatorInherit)(fullname);\n}\n","function none() {}\n\nexport default function(selector) {\n  return selector == null ? none : function() {\n    return this.querySelector(selector);\n  };\n}\n","function empty() {\n  return [];\n}\n\nexport default function(selector) {\n  return selector == null ? empty : function() {\n    return this.querySelectorAll(selector);\n  };\n}\n","var matcher = function(selector) {\n  return function() {\n    return this.matches(selector);\n  };\n};\n\nif (typeof document !== \"undefined\") {\n  var element = document.documentElement;\n  if (!element.matches) {\n    var vendorMatches = element.webkitMatchesSelector\n        || element.msMatchesSelector\n        || element.mozMatchesSelector\n        || element.oMatchesSelector;\n    matcher = function(selector) {\n      return function() {\n        return vendorMatches.call(this, selector);\n      };\n    };\n  }\n}\n\nexport default matcher;\n","export default function(update) {\n  return new Array(update.length);\n}\n","import sparse from \"./sparse\";\nimport {Selection} from \"./index\";\n\nexport default function() {\n  return new Selection(this._enter || this._groups.map(sparse), this._parents);\n}\n\nexport function EnterNode(parent, datum) {\n  this.ownerDocument = parent.ownerDocument;\n  this.namespaceURI = parent.namespaceURI;\n  this._next = null;\n  this._parent = parent;\n  this.__data__ = datum;\n}\n\nEnterNode.prototype = {\n  constructor: EnterNode,\n  appendChild: function(child) { return this._parent.insertBefore(child, this._next); },\n  insertBefore: function(child, next) { return this._parent.insertBefore(child, next); },\n  querySelector: function(selector) { return this._parent.querySelector(selector); },\n  querySelectorAll: function(selector) { return this._parent.querySelectorAll(selector); }\n};\n","import {Selection} from \"./index\";\nimport {EnterNode} from \"./enter\";\nimport constant from \"../constant\";\n\nvar keyPrefix = \"$\"; // Protect against keys like “__proto__”.\n\nfunction bindIndex(parent, group, enter, update, exit, data) {\n  var i = 0,\n      node,\n      groupLength = group.length,\n      dataLength = data.length;\n\n  // Put any non-null nodes that fit into update.\n  // Put any null nodes into enter.\n  // Put any remaining data into enter.\n  for (; i < dataLength; ++i) {\n    if (node = group[i]) {\n      node.__data__ = data[i];\n      update[i] = node;\n    } else {\n      enter[i] = new EnterNode(parent, data[i]);\n    }\n  }\n\n  // Put any non-null nodes that don’t fit into exit.\n  for (; i < groupLength; ++i) {\n    if (node = group[i]) {\n      exit[i] = node;\n    }\n  }\n}\n\nfunction bindKey(parent, group, enter, update, exit, data, key) {\n  var i,\n      node,\n      nodeByKeyValue = {},\n      groupLength = group.length,\n      dataLength = data.length,\n      keyValues = new Array(groupLength),\n      keyValue;\n\n  // Compute the key for each node.\n  // If multiple nodes have the same key, the duplicates are added to exit.\n  for (i = 0; i < groupLength; ++i) {\n    if (node = group[i]) {\n      keyValues[i] = keyValue = keyPrefix + key.call(node, node.__data__, i, group);\n      if (keyValue in nodeByKeyValue) {\n        exit[i] = node;\n      } else {\n        nodeByKeyValue[keyValue] = node;\n      }\n    }\n  }\n\n  // Compute the key for each datum.\n  // If there a node associated with this key, join and add it to update.\n  // If there is not (or the key is a duplicate), add it to enter.\n  for (i = 0; i < dataLength; ++i) {\n    keyValue = keyPrefix + key.call(parent, data[i], i, data);\n    if (node = nodeByKeyValue[keyValue]) {\n      update[i] = node;\n      node.__data__ = data[i];\n      nodeByKeyValue[keyValue] = null;\n    } else {\n      enter[i] = new EnterNode(parent, data[i]);\n    }\n  }\n\n  // Add any remaining nodes that were not bound to data to exit.\n  for (i = 0; i < groupLength; ++i) {\n    if ((node = group[i]) && (nodeByKeyValue[keyValues[i]] === node)) {\n      exit[i] = node;\n    }\n  }\n}\n\nexport default function(value, key) {\n  if (!value) {\n    data = new Array(this.size()), j = -1;\n    this.each(function(d) { data[++j] = d; });\n    return data;\n  }\n\n  var bind = key ? bindKey : bindIndex,\n      parents = this._parents,\n      groups = this._groups;\n\n  if (typeof value !== \"function\") value = constant(value);\n\n  for (var m = groups.length, update = new Array(m), enter = new Array(m), exit = new Array(m), j = 0; j < m; ++j) {\n    var parent = parents[j],\n        group = groups[j],\n        groupLength = group.length,\n        data = value.call(parent, parent && parent.__data__, j, parents),\n        dataLength = data.length,\n        enterGroup = enter[j] = new Array(dataLength),\n        updateGroup = update[j] = new Array(dataLength),\n        exitGroup = exit[j] = new Array(groupLength);\n\n    bind(parent, group, enterGroup, updateGroup, exitGroup, data, key);\n\n    // Now connect the enter nodes to their following update node, such that\n    // appendChild can insert the materialized enter node before this node,\n    // rather than at the end of the parent node.\n    for (var i0 = 0, i1 = 0, previous, next; i0 < dataLength; ++i0) {\n      if (previous = enterGroup[i0]) {\n        if (i0 >= i1) i1 = i0 + 1;\n        while (!(next = updateGroup[i1]) && ++i1 < dataLength);\n        previous._next = next || null;\n      }\n    }\n  }\n\n  update = new Selection(update, parents);\n  update._enter = enter;\n  update._exit = exit;\n  return update;\n}\n","import {Selection} from \"./index\";\n\nexport default function(compare) {\n  if (!compare) compare = ascending;\n\n  function compareNode(a, b) {\n    return a && b ? compare(a.__data__, b.__data__) : !a - !b;\n  }\n\n  for (var groups = this._groups, m = groups.length, sortgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, sortgroup = sortgroups[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        sortgroup[i] = node;\n      }\n    }\n    sortgroup.sort(compareNode);\n  }\n\n  return new Selection(sortgroups, this._parents).order();\n}\n\nfunction ascending(a, b) {\n  return a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;\n}\n","export default function(node) {\n  return (node.ownerDocument && node.ownerDocument.defaultView) // node is a Node\n      || (node.document && node) // node is a Window\n      || node.defaultView; // node is a Document\n}\n","function classArray(string) {\n  return string.trim().split(/^|\\s+/);\n}\n\nfunction classList(node) {\n  return node.classList || new ClassList(node);\n}\n\nfunction ClassList(node) {\n  this._node = node;\n  this._names = classArray(node.getAttribute(\"class\") || \"\");\n}\n\nClassList.prototype = {\n  add: function(name) {\n    var i = this._names.indexOf(name);\n    if (i < 0) {\n      this._names.push(name);\n      this._node.setAttribute(\"class\", this._names.join(\" \"));\n    }\n  },\n  remove: function(name) {\n    var i = this._names.indexOf(name);\n    if (i >= 0) {\n      this._names.splice(i, 1);\n      this._node.setAttribute(\"class\", this._names.join(\" \"));\n    }\n  },\n  contains: function(name) {\n    return this._names.indexOf(name) >= 0;\n  }\n};\n\nfunction classedAdd(node, names) {\n  var list = classList(node), i = -1, n = names.length;\n  while (++i < n) list.add(names[i]);\n}\n\nfunction classedRemove(node, names) {\n  var list = classList(node), i = -1, n = names.length;\n  while (++i < n) list.remove(names[i]);\n}\n\nfunction classedTrue(names) {\n  return function() {\n    classedAdd(this, names);\n  };\n}\n\nfunction classedFalse(names) {\n  return function() {\n    classedRemove(this, names);\n  };\n}\n\nfunction classedFunction(names, value) {\n  return function() {\n    (value.apply(this, arguments) ? classedAdd : classedRemove)(this, names);\n  };\n}\n\nexport default function(name, value) {\n  var names = classArray(name + \"\");\n\n  if (arguments.length < 2) {\n    var list = classList(this.node()), i = -1, n = names.length;\n    while (++i < n) if (!list.contains(names[i])) return false;\n    return true;\n  }\n\n  return this.each((typeof value === \"function\"\n      ? classedFunction : value\n      ? classedTrue\n      : classedFalse)(names, value));\n}\n","function textRemove() {\n  this.textContent = \"\";\n}\n\nfunction textConstant(value) {\n  return function() {\n    this.textContent = value;\n  };\n}\n\nfunction textFunction(value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    this.textContent = v == null ? \"\" : v;\n  };\n}\n\nexport default function(value) {\n  return arguments.length\n      ? this.each(value == null\n          ? textRemove : (typeof value === \"function\"\n          ? textFunction\n          : textConstant)(value))\n      : this.node().textContent;\n}\n","function htmlRemove() {\n  this.innerHTML = \"\";\n}\n\nfunction htmlConstant(value) {\n  return function() {\n    this.innerHTML = value;\n  };\n}\n\nfunction htmlFunction(value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    this.innerHTML = v == null ? \"\" : v;\n  };\n}\n\nexport default function(value) {\n  return arguments.length\n      ? this.each(value == null\n          ? htmlRemove : (typeof value === \"function\"\n          ? htmlFunction\n          : htmlConstant)(value))\n      : this.node().innerHTML;\n}\n","function raise() {\n  if (this.nextSibling) this.parentNode.appendChild(this);\n}\n\nexport default function() {\n  return this.each(raise);\n}\n","function lower() {\n  if (this.previousSibling) this.parentNode.insertBefore(this, this.parentNode.firstChild);\n}\n\nexport default function() {\n  return this.each(lower);\n}\n","import creator from \"../creator\";\nimport selector from \"../selector\";\n\nfunction constantNull() {\n  return null;\n}\n\nexport default function(name, before) {\n  var create = typeof name === \"function\" ? name : creator(name),\n      select = before == null ? constantNull : typeof before === \"function\" ? before : selector(before);\n  return this.select(function() {\n    return this.insertBefore(create.apply(this, arguments), select.apply(this, arguments) || null);\n  });\n}\n","function remove() {\n  var parent = this.parentNode;\n  if (parent) parent.removeChild(this);\n}\n\nexport default function() {\n  return this.each(remove);\n}\n","function selection_cloneShallow() {\n  return this.parentNode.insertBefore(this.cloneNode(false), this.nextSibling);\n}\n\nfunction selection_cloneDeep() {\n  return this.parentNode.insertBefore(this.cloneNode(true), this.nextSibling);\n}\n\nexport default function(deep) {\n  return this.select(deep ? selection_cloneDeep : selection_cloneShallow);\n}\n","var filterEvents = {};\n\nexport var event = null;\n\nif (typeof document !== \"undefined\") {\n  var element = document.documentElement;\n  if (!(\"onmouseenter\" in element)) {\n    filterEvents = {mouseenter: \"mouseover\", mouseleave: \"mouseout\"};\n  }\n}\n\nfunction filterContextListener(listener, index, group) {\n  listener = contextListener(listener, index, group);\n  return function(event) {\n    var related = event.relatedTarget;\n    if (!related || (related !== this && !(related.compareDocumentPosition(this) & 8))) {\n      listener.call(this, event);\n    }\n  };\n}\n\nfunction contextListener(listener, index, group) {\n  return function(event1) {\n    var event0 = event; // Events can be reentrant (e.g., focus).\n    event = event1;\n    try {\n      listener.call(this, this.__data__, index, group);\n    } finally {\n      event = event0;\n    }\n  };\n}\n\nfunction parseTypenames(typenames) {\n  return typenames.trim().split(/^|\\s+/).map(function(t) {\n    var name = \"\", i = t.indexOf(\".\");\n    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);\n    return {type: t, name: name};\n  });\n}\n\nfunction onRemove(typename) {\n  return function() {\n    var on = this.__on;\n    if (!on) return;\n    for (var j = 0, i = -1, m = on.length, o; j < m; ++j) {\n      if (o = on[j], (!typename.type || o.type === typename.type) && o.name === typename.name) {\n        this.removeEventListener(o.type, o.listener, o.capture);\n      } else {\n        on[++i] = o;\n      }\n    }\n    if (++i) on.length = i;\n    else delete this.__on;\n  };\n}\n\nfunction onAdd(typename, value, capture) {\n  var wrap = filterEvents.hasOwnProperty(typename.type) ? filterContextListener : contextListener;\n  return function(d, i, group) {\n    var on = this.__on, o, listener = wrap(value, i, group);\n    if (on) for (var j = 0, m = on.length; j < m; ++j) {\n      if ((o = on[j]).type === typename.type && o.name === typename.name) {\n        this.removeEventListener(o.type, o.listener, o.capture);\n        this.addEventListener(o.type, o.listener = listener, o.capture = capture);\n        o.value = value;\n        return;\n      }\n    }\n    this.addEventListener(typename.type, listener, capture);\n    o = {type: typename.type, name: typename.name, value: value, listener: listener, capture: capture};\n    if (!on) this.__on = [o];\n    else on.push(o);\n  };\n}\n\nexport default function(typename, value, capture) {\n  var typenames = parseTypenames(typename + \"\"), i, n = typenames.length, t;\n\n  if (arguments.length < 2) {\n    var on = this.node().__on;\n    if (on) for (var j = 0, m = on.length, o; j < m; ++j) {\n      for (i = 0, o = on[j]; i < n; ++i) {\n        if ((t = typenames[i]).type === o.type && t.name === o.name) {\n          return o.value;\n        }\n      }\n    }\n    return;\n  }\n\n  on = value ? onAdd : onRemove;\n  if (capture == null) capture = false;\n  for (i = 0; i < n; ++i) this.each(on(typenames[i], value, capture));\n  return this;\n}\n\nexport function customEvent(event1, listener, that, args) {\n  var event0 = event;\n  event1.sourceEvent = event;\n  event = event1;\n  try {\n    return listener.apply(that, args);\n  } finally {\n    event = event0;\n  }\n}\n","import defaultView from \"../window\";\n\nfunction dispatchEvent(node, type, params) {\n  var window = defaultView(node),\n      event = window.CustomEvent;\n\n  if (typeof event === \"function\") {\n    event = new event(type, params);\n  } else {\n    event = window.document.createEvent(\"Event\");\n    if (params) event.initEvent(type, params.bubbles, params.cancelable), event.detail = params.detail;\n    else event.initEvent(type, false, false);\n  }\n\n  node.dispatchEvent(event);\n}\n\nfunction dispatchConstant(type, params) {\n  return function() {\n    return dispatchEvent(this, type, params);\n  };\n}\n\nfunction dispatchFunction(type, params) {\n  return function() {\n    return dispatchEvent(this, type, params.apply(this, arguments));\n  };\n}\n\nexport default function(type, params) {\n  return this.each((typeof params === \"function\"\n      ? dispatchFunction\n      : dispatchConstant)(type, params));\n}\n","import selection_select from \"./select\";\nimport selection_selectAll from \"./selectAll\";\nimport selection_filter from \"./filter\";\nimport selection_data from \"./data\";\nimport selection_enter from \"./enter\";\nimport selection_exit from \"./exit\";\nimport selection_merge from \"./merge\";\nimport selection_order from \"./order\";\nimport selection_sort from \"./sort\";\nimport selection_call from \"./call\";\nimport selection_nodes from \"./nodes\";\nimport selection_node from \"./node\";\nimport selection_size from \"./size\";\nimport selection_empty from \"./empty\";\nimport selection_each from \"./each\";\nimport selection_attr from \"./attr\";\nimport selection_style from \"./style\";\nimport selection_property from \"./property\";\nimport selection_classed from \"./classed\";\nimport selection_text from \"./text\";\nimport selection_html from \"./html\";\nimport selection_raise from \"./raise\";\nimport selection_lower from \"./lower\";\nimport selection_append from \"./append\";\nimport selection_insert from \"./insert\";\nimport selection_remove from \"./remove\";\nimport selection_clone from \"./clone\";\nimport selection_datum from \"./datum\";\nimport selection_on from \"./on\";\nimport selection_dispatch from \"./dispatch\";\n\nexport var root = [null];\n\nexport function Selection(groups, parents) {\n  this._groups = groups;\n  this._parents = parents;\n}\n\nfunction selection() {\n  return new Selection([[document.documentElement]], root);\n}\n\nSelection.prototype = selection.prototype = {\n  constructor: Selection,\n  select: selection_select,\n  selectAll: selection_selectAll,\n  filter: selection_filter,\n  data: selection_data,\n  enter: selection_enter,\n  exit: selection_exit,\n  merge: selection_merge,\n  order: selection_order,\n  sort: selection_sort,\n  call: selection_call,\n  nodes: selection_nodes,\n  node: selection_node,\n  size: selection_size,\n  empty: selection_empty,\n  each: selection_each,\n  attr: selection_attr,\n  style: selection_style,\n  property: selection_property,\n  classed: selection_classed,\n  text: selection_text,\n  html: selection_html,\n  raise: selection_raise,\n  lower: selection_lower,\n  append: selection_append,\n  insert: selection_insert,\n  remove: selection_remove,\n  clone: selection_clone,\n  datum: selection_datum,\n  on: selection_on,\n  dispatch: selection_dispatch\n};\n\nexport default selection;\n","/**\n * Draw a stroke symbol\n * @param {Object} context Current rendering context\n * @param {Stroke} stroke Stroke to be drawn\n * @param {Stroker} stroker Stroker to use to render a stroke\n */\nexport function drawStroke(context, stroke, stroker) {\n  if (stroker) {\n    stroker.drawStroke(context, stroke);\n  }\n}\n","import * as d3 from 'd3-selection';\nimport { rendererLogger as logger } from '../../configuration/LoggerConfig';\nimport { drawStroke } from './symbols/StrokeSymbolSVGRenderer';\nimport * as InkModel from '../../model/InkModel';\n\n\n/**\n * Get info\n * @return {RendererInfo} Information about this renderer\n */\nexport function getInfo() {\n  return {\n    type: 'svg',\n    apiVersion: 'V4'\n  };\n}\n\n/**\n * Populate the dom element\n * @param {Element} element DOM element to attach the rendering elements\n * @return {Object} The renderer context to give as parameter when a draw model will be call\n */\nexport function attach(element) {\n  const elementRef = element;\n  logger.debug('populate root element', elementRef);\n  elementRef.style.fontSize = '10px';\n  return d3.select(elementRef);\n}\n\n/**\n * Detach the renderer from the DOM element\n * @param {Element} element DOM element to attach the rendering elements\n * @param {Object} context Current rendering context\n */\nexport function detach(element, context) {\n  logger.debug('detach renderer', element);\n  context.select('svg').remove();\n}\n\n/**\n * Update the rendering context size\n * @param {Object} context Current rendering context\n * @param {Model} model Current model\n * @param {Stroker} stroker Current stroker\n * @param {Number} minHeight Minimal height for resize\n * @param {Number} minWidth Minimal Width for resize\n * @return {Model}\n */\nexport function resize(context, model, stroker, minHeight, minWidth) {\n  const rect = context.node().getBoundingClientRect();\n  const svg = context.selectAll('svg');\n  const width = rect.width < minWidth ? minWidth : rect.width;\n  const height = rect.height < minHeight ? minHeight : rect.height;\n  svg.attr('viewBox', `0 0 ${width}, ${height}`);\n  svg.attr('width', `${width}px`);\n  svg.attr('height', `${height}px`);\n  logger.debug('svg viewBox changed', svg);\n  return model;\n}\n\n/**\n * Draw the current stroke from the model\n * @param {Object} context Current rendering context\n * @param {Model} model Current model\n * @param {Stroker} stroker Current stroker\n * @return {Model}\n */\nexport function drawCurrentStroke(context, model, stroker) {\n  const modelRef = model;\n  // Add a pending id for pending strokes rendering\n  modelRef.currentStroke.id = `pendingStroke-${model.rawStrokes.length}`;\n  // Render the current stroke\n  logger.trace('drawing current stroke ', model.currentStroke);\n  context.select(`#pendingStrokes #${modelRef.currentStroke.id}`).remove();\n  drawStroke(context.select('#pendingStrokes').append('path').attr('id', model.currentStroke.id), model.currentStroke, stroker);\n  return modelRef;\n}\n\nfunction insertAdjacentSVG(element, position, html) {\n  const container = element.ownerDocument.createElementNS('http://www.w3.org/2000/svg', '_');\n  container.innerHTML = html;\n\n  switch (position.toLowerCase()) {\n    case 'beforebegin':\n      element.parentNode.insertBefore(container.firstChild, element);\n      break;\n    case 'afterbegin':\n      element.insertBefore(container.lastChild, element.firstChild);\n      break;\n    case 'beforeend':\n      element.appendChild(container.firstChild);\n      break;\n    case 'afterend':\n      element.parentNode.insertBefore(container.lastChild, element.nextSibling);\n      break;\n    default:\n      logger.warn('Invalid insertAdjacentHTML position');\n      break;\n  }\n}\n\n/**\n * Draw all symbols contained into the model\n * @param {Object} context Current rendering context\n * @param {Model} model Current model\n * @param {Stroker} stroker Current stroker\n * @return {Model}\n */\nexport function drawModel(context, model, stroker) {\n  const drawSymbol = (symbol, symbolContext) => {\n    logger.trace(`attempting to draw ${symbol.type} symbol`);\n    if (symbol.type === 'stroke' && !symbolContext.select('id', symbol.id)) {\n      drawStroke(symbolContext.append('path').attr('id', symbol.id), symbol, stroker);\n    } else {\n      logger.warn(`impossible to draw ${symbol.type} symbol`);\n    }\n  };\n\n  const updateView = (patchUpdate) => {\n    // We only add in the stack patch with updates\n    patchUpdate.updates.forEach((update) => {\n      try {\n        const svgElementSelector = 'svg[data-layer=\"' + patchUpdate.layer + '\"]';\n        switch (update.type) {\n          case 'REPLACE_ALL': {\n            context.select(svgElementSelector).remove();\n            const parent = context.node();\n            if (parent.insertAdjacentHTML) {\n              parent.insertAdjacentHTML('beforeEnd', update.svg);\n            } else {\n              insertAdjacentSVG(parent, 'beforeEnd', update.svg);\n            }\n            if (patchUpdate.layer === 'MODEL') {\n              context.select(svgElementSelector).append('g').attr('id', 'pendingStrokes');\n            }\n          }\n            break;\n          case 'REMOVE_ELEMENT': {\n            if (update.id.includes('s') || update.id.includes('MODEL')) {\n              context.select(`#${update.id}`).remove();\n            } else {\n              context.select(`#${update.id}`).attr('class', 'removed-stroke');\n              setTimeout(() => {\n                context.select(`#${update.id}`).remove();\n              }, 100);\n            }\n            break;\n          }\n          case 'REPLACE_ELEMENT': {\n            const parent = context.select(`#${update.id}`).node().parentNode;\n            context.select(`#${update.id}`).remove();\n            if (parent.insertAdjacentHTML) {\n              parent.insertAdjacentHTML('beforeEnd', update.svg);\n            } else {\n              insertAdjacentSVG(parent, 'beforeEnd', update.svg);\n              context.node().insertAdjacentHTML('beforeEnd', context.select(svgElementSelector).remove().node().outerHTML);\n            }\n          }\n            break;\n          case 'REMOVE_CHILD':\n            context.select(`#${update.parentId} > *:nth-child(${update.index + 1})`).remove();\n            break;\n          case 'APPEND_CHILD': {\n            const parent = context.select(update.parentId ? `#${update.parentId}` : svgElementSelector).node();\n            if (parent.insertAdjacentHTML) {\n              parent.insertAdjacentHTML('beforeEnd', update.svg);\n            } else {\n              insertAdjacentSVG(parent, 'beforeEnd', update.svg);\n              context.node().insertAdjacentHTML('beforeEnd', context.select(svgElementSelector).remove().node().outerHTML);\n            }\n          }\n            break;\n          case 'INSERT_BEFORE': {\n            const parent = context.select(`#${update.refId}`).node();\n            if (parent.insertAdjacentHTML) {\n              parent.insertAdjacentHTML('beforeBegin', update.svg);\n            } else {\n              insertAdjacentSVG(parent, 'beforeBegin', update.svg);\n              context.node().insertAdjacentHTML('beforeEnd', context.select(svgElementSelector).remove().node().outerHTML);\n            }\n          }\n            break;\n          case 'REMOVE_ATTRIBUTE':\n            context.selectAll(update.id ? `#${update.id}` : 'svg').attr(update.name, null);\n            break;\n          case 'SET_ATTRIBUTE': {\n            // We ignore setAttributes on the svg element because we handle the resize elsewhere to prevent a blink effect\n            // that occurs if we are waiting for the server to resize.\n            if (update.id) {\n              context.selectAll(`#${update.id}`).attr(update.name, update.value);\n            }\n            break;\n          }\n          default:\n            logger.debug(`unknown update ${update.type} action`);\n            break;\n        }\n      } catch (e) {\n        logger.error(`Invalid update ${update.type}`, update);\n        logger.error('Error on svg patch', e);\n      }\n    });\n  };\n\n  const pendingRecognizedSymbols = InkModel.extractPendingRecognizedSymbols(model);\n  if (pendingRecognizedSymbols) {\n    pendingRecognizedSymbols.forEach(patch => updateView(patch));\n    InkModel.updateModelRenderedPosition(model);\n  }\n\n  const pendingStrokes = InkModel.extractPendingStrokes(model);\n  if (pendingStrokes) {\n    pendingStrokes.forEach(stroke => drawSymbol(stroke, context.select('#pendingStrokes')));\n  }\n  return model;\n}\n","import {Selection} from \"./index\";\nimport selector from \"../selector\";\n\nexport default function(select) {\n  if (typeof select !== \"function\") select = selector(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = new Array(n), node, subnode, i = 0; i < n; ++i) {\n      if ((node = group[i]) && (subnode = select.call(node, node.__data__, i, group))) {\n        if (\"__data__\" in node) subnode.__data__ = node.__data__;\n        subgroup[i] = subnode;\n      }\n    }\n  }\n\n  return new Selection(subgroups, this._parents);\n}\n","import {Selection} from \"./index\";\nimport selectorAll from \"../selectorAll\";\n\nexport default function(select) {\n  if (typeof select !== \"function\") select = selectorAll(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        subgroups.push(select.call(node, node.__data__, i, group));\n        parents.push(node);\n      }\n    }\n  }\n\n  return new Selection(subgroups, parents);\n}\n","import {Selection} from \"./index\";\nimport matcher from \"../matcher\";\n\nexport default function(match) {\n  if (typeof match !== \"function\") match = matcher(match);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = [], node, i = 0; i < n; ++i) {\n      if ((node = group[i]) && match.call(node, node.__data__, i, group)) {\n        subgroup.push(node);\n      }\n    }\n  }\n\n  return new Selection(subgroups, this._parents);\n}\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","import sparse from \"./sparse\";\nimport {Selection} from \"./index\";\n\nexport default function() {\n  return new Selection(this._exit || this._groups.map(sparse), this._parents);\n}\n","import {Selection} from \"./index\";\n\nexport default function(selection) {\n\n  for (var groups0 = this._groups, groups1 = selection._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {\n    for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge = merges[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group0[i] || group1[i]) {\n        merge[i] = node;\n      }\n    }\n  }\n\n  for (; j < m0; ++j) {\n    merges[j] = groups0[j];\n  }\n\n  return new Selection(merges, this._parents);\n}\n","export default function() {\n\n  for (var groups = this._groups, j = -1, m = groups.length; ++j < m;) {\n    for (var group = groups[j], i = group.length - 1, next = group[i], node; --i >= 0;) {\n      if (node = group[i]) {\n        if (next && next !== node.nextSibling) next.parentNode.insertBefore(node, next);\n        next = node;\n      }\n    }\n  }\n\n  return this;\n}\n","export default function() {\n  var callback = arguments[0];\n  arguments[0] = this;\n  callback.apply(null, arguments);\n  return this;\n}\n","export default function() {\n  var nodes = new Array(this.size()), i = -1;\n  this.each(function() { nodes[++i] = this; });\n  return nodes;\n}\n","export default function() {\n\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length; i < n; ++i) {\n      var node = group[i];\n      if (node) return node;\n    }\n  }\n\n  return null;\n}\n","export default function() {\n  var size = 0;\n  this.each(function() { ++size; });\n  return size;\n}\n","export default function() {\n  return !this.node();\n}\n","export default function(callback) {\n\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length, node; i < n; ++i) {\n      if (node = group[i]) callback.call(node, node.__data__, i, group);\n    }\n  }\n\n  return this;\n}\n","import namespace from \"../namespace\";\n\nfunction attrRemove(name) {\n  return function() {\n    this.removeAttribute(name);\n  };\n}\n\nfunction attrRemoveNS(fullname) {\n  return function() {\n    this.removeAttributeNS(fullname.space, fullname.local);\n  };\n}\n\nfunction attrConstant(name, value) {\n  return function() {\n    this.setAttribute(name, value);\n  };\n}\n\nfunction attrConstantNS(fullname, value) {\n  return function() {\n    this.setAttributeNS(fullname.space, fullname.local, value);\n  };\n}\n\nfunction attrFunction(name, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.removeAttribute(name);\n    else this.setAttribute(name, v);\n  };\n}\n\nfunction attrFunctionNS(fullname, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.removeAttributeNS(fullname.space, fullname.local);\n    else this.setAttributeNS(fullname.space, fullname.local, v);\n  };\n}\n\nexport default function(name, value) {\n  var fullname = namespace(name);\n\n  if (arguments.length < 2) {\n    var node = this.node();\n    return fullname.local\n        ? node.getAttributeNS(fullname.space, fullname.local)\n        : node.getAttribute(fullname);\n  }\n\n  return this.each((value == null\n      ? (fullname.local ? attrRemoveNS : attrRemove) : (typeof value === \"function\"\n      ? (fullname.local ? attrFunctionNS : attrFunction)\n      : (fullname.local ? attrConstantNS : attrConstant)))(fullname, value));\n}\n","import defaultView from \"../window\";\n\nfunction styleRemove(name) {\n  return function() {\n    this.style.removeProperty(name);\n  };\n}\n\nfunction styleConstant(name, value, priority) {\n  return function() {\n    this.style.setProperty(name, value, priority);\n  };\n}\n\nfunction styleFunction(name, value, priority) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.style.removeProperty(name);\n    else this.style.setProperty(name, v, priority);\n  };\n}\n\nexport default function(name, value, priority) {\n  return arguments.length > 1\n      ? this.each((value == null\n            ? styleRemove : typeof value === \"function\"\n            ? styleFunction\n            : styleConstant)(name, value, priority == null ? \"\" : priority))\n      : styleValue(this.node(), name);\n}\n\nexport function styleValue(node, name) {\n  return node.style.getPropertyValue(name)\n      || defaultView(node).getComputedStyle(node, null).getPropertyValue(name);\n}\n","function propertyRemove(name) {\n  return function() {\n    delete this[name];\n  };\n}\n\nfunction propertyConstant(name, value) {\n  return function() {\n    this[name] = value;\n  };\n}\n\nfunction propertyFunction(name, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) delete this[name];\n    else this[name] = v;\n  };\n}\n\nexport default function(name, value) {\n  return arguments.length > 1\n      ? this.each((value == null\n          ? propertyRemove : typeof value === \"function\"\n          ? propertyFunction\n          : propertyConstant)(name, value))\n      : this.node()[name];\n}\n","import creator from \"../creator\";\n\nexport default function(name) {\n  var create = typeof name === \"function\" ? name : creator(name);\n  return this.select(function() {\n    return this.appendChild(create.apply(this, arguments));\n  });\n}\n","export default function(value) {\n  return arguments.length\n      ? this.property(\"__data__\", value)\n      : this.node().__data__;\n}\n","import {Selection, root} from \"./selection/index\";\n\nexport default function(selector) {\n  return typeof selector === \"string\"\n      ? new Selection([[document.querySelector(selector)]], [document.documentElement])\n      : new Selection([[selector]], root);\n}\n","import * as StrokeComponent from '../../../model/StrokeComponent';\nimport { computeLinksPoints, computeMiddlePoint, computeAxeAngle } from '../../QuadraticUtils';\n\n/**\n * Get info\n * @return {StrokerInfo} Information about this stroker\n */\nexport function getInfo() {\n  return {\n    type: 'svg',\n    name: 'quadratic',\n    apiVersion: 'V4'\n  };\n}\n\nfunction renderArc(context, center, radius) {\n  const svgPath = [\n    `M ${center.x},${center.y}`,\n    `m ${-radius},0`,\n    `a ${radius},${radius} 0 1 0 ${radius * 2},0`,\n    `a ${radius},${radius} 0 1 0 ${-(radius * 2)},0`\n  ].join(' ');\n  return svgPath;\n}\n\nfunction renderLine(context, begin, end, width) {\n  const linkPoints1 = computeLinksPoints(begin, computeAxeAngle(begin, end), width);\n  const linkPoints2 = computeLinksPoints(end, computeAxeAngle(begin, end), width);\n\n  const svgPath = [\n    `M ${linkPoints1[0].x},${linkPoints1[0].y}`,\n    `L ${linkPoints2[0].x},${linkPoints2[0].y}`,\n    `L ${linkPoints2[1].x},${linkPoints2[1].y}`,\n    `L ${linkPoints1[1].x},${linkPoints1[1].y}`\n  ].join(' ');\n  return svgPath;\n}\n\nfunction renderFinal(context, begin, end, width) {\n  const ARCSPLIT = 6;\n  const angle = computeAxeAngle(begin, end);\n  const linkPoints = computeLinksPoints(end, angle, width);\n\n  const parts = [`M ${linkPoints[0].x},${linkPoints[0].y}`];\n  for (let i = 1; i <= ARCSPLIT; i++) {\n    const newAngle = angle - (i * (Math.PI / ARCSPLIT));\n    parts.push(`L ${end.x - (end.p * width * Math.sin(newAngle))},${end.y + (end.p * width * Math.cos(newAngle))}`);\n  }\n  const svgPath = parts.join(' ');\n  return svgPath;\n}\n\nfunction renderQuadratic(context, begin, end, ctrl, width) {\n  const linkPoints1 = computeLinksPoints(begin, computeAxeAngle(begin, ctrl), width);\n  const linkPoints2 = computeLinksPoints(end, computeAxeAngle(ctrl, end), width);\n  const linkPoints3 = computeLinksPoints(ctrl, computeAxeAngle(begin, end), width);\n\n  const svgPath = [\n    `M ${linkPoints1[0].x},${linkPoints1[0].y}`,\n    `Q ${linkPoints3[0].x},${linkPoints3[0].y} ${linkPoints2[0].x},${linkPoints2[0].y}`,\n    `L ${linkPoints2[1].x},${linkPoints2[1].y}`,\n    `Q ${linkPoints3[1].x},${linkPoints3[1].y} ${linkPoints1[1].x},${linkPoints1[1].y}`\n  ].join(' ');\n  return svgPath;\n}\n\n/**\n * Draw a stroke on a svg tag, using quadratics\n * @param {Object} context Current rendering context\n * @param {Stroke} stroke Current stroke to be drawn\n */\nexport function drawStroke(context, stroke) {\n  const length = stroke.x.length;\n  const width = stroke.width;\n  const firstPoint = StrokeComponent.getPointByIndex(stroke, 0);\n  const nbquadratics = length - 2;\n\n  const parts = [];\n  if (length < 3) {\n    parts.push(renderArc(context, firstPoint, width * 0.6));\n  } else {\n    parts.push(renderArc(context, firstPoint, width * firstPoint.p));\n    parts.push(renderLine(context, firstPoint, computeMiddlePoint(firstPoint, StrokeComponent.getPointByIndex(stroke, 1)), width));\n\n    for (let i = 0; i < nbquadratics; i++) {\n      parts.push(renderQuadratic(context, computeMiddlePoint(StrokeComponent.getPointByIndex(stroke, i), StrokeComponent.getPointByIndex(stroke, i + 1)), computeMiddlePoint(StrokeComponent.getPointByIndex(stroke, i + 1), StrokeComponent.getPointByIndex(stroke, i + 2)), StrokeComponent.getPointByIndex(stroke, i + 1), width));\n    }\n    parts.push(renderLine(context, computeMiddlePoint(StrokeComponent.getPointByIndex(stroke, length - 2), StrokeComponent.getPointByIndex(stroke, length - 1)), StrokeComponent.getPointByIndex(stroke, length - 1), width));\n    parts.push(renderFinal(context, StrokeComponent.getPointByIndex(stroke, length - 2), StrokeComponent.getPointByIndex(stroke, length - 1), width));\n  }\n  const svgPath = parts.join(' ');\n\n  context\n    .attr('color', stroke.color)\n    .style('fill', stroke.color)\n    .style('stroke', 'transparent')\n    .classed('pending-stroke', true)\n    .attr('d', `${svgPath}Z`);\n}\n",";(function (root, factory) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory();\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\troot.CryptoJS = factory();\n\t}\n}(this, function () {\n\n\t/**\n\t * CryptoJS core components.\n\t */\n\tvar CryptoJS = CryptoJS || (function (Math, undefined) {\n\t    /*\n\t     * Local polyfil of Object.create\n\t     */\n\t    var create = Object.create || (function () {\n\t        function F() {};\n\n\t        return function (obj) {\n\t            var subtype;\n\n\t            F.prototype = obj;\n\n\t            subtype = new F();\n\n\t            F.prototype = null;\n\n\t            return subtype;\n\t        };\n\t    }())\n\n\t    /**\n\t     * CryptoJS namespace.\n\t     */\n\t    var C = {};\n\n\t    /**\n\t     * Library namespace.\n\t     */\n\t    var C_lib = C.lib = {};\n\n\t    /**\n\t     * Base object for prototypal inheritance.\n\t     */\n\t    var Base = C_lib.Base = (function () {\n\n\n\t        return {\n\t            /**\n\t             * Creates a new object that inherits from this object.\n\t             *\n\t             * @param {Object} overrides Properties to copy into the new object.\n\t             *\n\t             * @return {Object} The new object.\n\t             *\n\t             * @static\n\t             *\n\t             * @example\n\t             *\n\t             *     var MyType = CryptoJS.lib.Base.extend({\n\t             *         field: 'value',\n\t             *\n\t             *         method: function () {\n\t             *         }\n\t             *     });\n\t             */\n\t            extend: function (overrides) {\n\t                // Spawn\n\t                var subtype = create(this);\n\n\t                // Augment\n\t                if (overrides) {\n\t                    subtype.mixIn(overrides);\n\t                }\n\n\t                // Create default initializer\n\t                if (!subtype.hasOwnProperty('init') || this.init === subtype.init) {\n\t                    subtype.init = function () {\n\t                        subtype.$super.init.apply(this, arguments);\n\t                    };\n\t                }\n\n\t                // Initializer's prototype is the subtype object\n\t                subtype.init.prototype = subtype;\n\n\t                // Reference supertype\n\t                subtype.$super = this;\n\n\t                return subtype;\n\t            },\n\n\t            /**\n\t             * Extends this object and runs the init method.\n\t             * Arguments to create() will be passed to init().\n\t             *\n\t             * @return {Object} The new object.\n\t             *\n\t             * @static\n\t             *\n\t             * @example\n\t             *\n\t             *     var instance = MyType.create();\n\t             */\n\t            create: function () {\n\t                var instance = this.extend();\n\t                instance.init.apply(instance, arguments);\n\n\t                return instance;\n\t            },\n\n\t            /**\n\t             * Initializes a newly created object.\n\t             * Override this method to add some logic when your objects are created.\n\t             *\n\t             * @example\n\t             *\n\t             *     var MyType = CryptoJS.lib.Base.extend({\n\t             *         init: function () {\n\t             *             // ...\n\t             *         }\n\t             *     });\n\t             */\n\t            init: function () {\n\t            },\n\n\t            /**\n\t             * Copies properties into this object.\n\t             *\n\t             * @param {Object} properties The properties to mix in.\n\t             *\n\t             * @example\n\t             *\n\t             *     MyType.mixIn({\n\t             *         field: 'value'\n\t             *     });\n\t             */\n\t            mixIn: function (properties) {\n\t                for (var propertyName in properties) {\n\t                    if (properties.hasOwnProperty(propertyName)) {\n\t                        this[propertyName] = properties[propertyName];\n\t                    }\n\t                }\n\n\t                // IE won't copy toString using the loop above\n\t                if (properties.hasOwnProperty('toString')) {\n\t                    this.toString = properties.toString;\n\t                }\n\t            },\n\n\t            /**\n\t             * Creates a copy of this object.\n\t             *\n\t             * @return {Object} The clone.\n\t             *\n\t             * @example\n\t             *\n\t             *     var clone = instance.clone();\n\t             */\n\t            clone: function () {\n\t                return this.init.prototype.extend(this);\n\t            }\n\t        };\n\t    }());\n\n\t    /**\n\t     * An array of 32-bit words.\n\t     *\n\t     * @property {Array} words The array of 32-bit words.\n\t     * @property {number} sigBytes The number of significant bytes in this word array.\n\t     */\n\t    var WordArray = C_lib.WordArray = Base.extend({\n\t        /**\n\t         * Initializes a newly created word array.\n\t         *\n\t         * @param {Array} words (Optional) An array of 32-bit words.\n\t         * @param {number} sigBytes (Optional) The number of significant bytes in the words.\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.lib.WordArray.create();\n\t         *     var wordArray = CryptoJS.lib.WordArray.create([0x00010203, 0x04050607]);\n\t         *     var wordArray = CryptoJS.lib.WordArray.create([0x00010203, 0x04050607], 6);\n\t         */\n\t        init: function (words, sigBytes) {\n\t            words = this.words = words || [];\n\n\t            if (sigBytes != undefined) {\n\t                this.sigBytes = sigBytes;\n\t            } else {\n\t                this.sigBytes = words.length * 4;\n\t            }\n\t        },\n\n\t        /**\n\t         * Converts this word array to a string.\n\t         *\n\t         * @param {Encoder} encoder (Optional) The encoding strategy to use. Default: CryptoJS.enc.Hex\n\t         *\n\t         * @return {string} The stringified word array.\n\t         *\n\t         * @example\n\t         *\n\t         *     var string = wordArray + '';\n\t         *     var string = wordArray.toString();\n\t         *     var string = wordArray.toString(CryptoJS.enc.Utf8);\n\t         */\n\t        toString: function (encoder) {\n\t            return (encoder || Hex).stringify(this);\n\t        },\n\n\t        /**\n\t         * Concatenates a word array to this word array.\n\t         *\n\t         * @param {WordArray} wordArray The word array to append.\n\t         *\n\t         * @return {WordArray} This word array.\n\t         *\n\t         * @example\n\t         *\n\t         *     wordArray1.concat(wordArray2);\n\t         */\n\t        concat: function (wordArray) {\n\t            // Shortcuts\n\t            var thisWords = this.words;\n\t            var thatWords = wordArray.words;\n\t            var thisSigBytes = this.sigBytes;\n\t            var thatSigBytes = wordArray.sigBytes;\n\n\t            // Clamp excess bits\n\t            this.clamp();\n\n\t            // Concat\n\t            if (thisSigBytes % 4) {\n\t                // Copy one byte at a time\n\t                for (var i = 0; i < thatSigBytes; i++) {\n\t                    var thatByte = (thatWords[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff;\n\t                    thisWords[(thisSigBytes + i) >>> 2] |= thatByte << (24 - ((thisSigBytes + i) % 4) * 8);\n\t                }\n\t            } else {\n\t                // Copy one word at a time\n\t                for (var i = 0; i < thatSigBytes; i += 4) {\n\t                    thisWords[(thisSigBytes + i) >>> 2] = thatWords[i >>> 2];\n\t                }\n\t            }\n\t            this.sigBytes += thatSigBytes;\n\n\t            // Chainable\n\t            return this;\n\t        },\n\n\t        /**\n\t         * Removes insignificant bits.\n\t         *\n\t         * @example\n\t         *\n\t         *     wordArray.clamp();\n\t         */\n\t        clamp: function () {\n\t            // Shortcuts\n\t            var words = this.words;\n\t            var sigBytes = this.sigBytes;\n\n\t            // Clamp\n\t            words[sigBytes >>> 2] &= 0xffffffff << (32 - (sigBytes % 4) * 8);\n\t            words.length = Math.ceil(sigBytes / 4);\n\t        },\n\n\t        /**\n\t         * Creates a copy of this word array.\n\t         *\n\t         * @return {WordArray} The clone.\n\t         *\n\t         * @example\n\t         *\n\t         *     var clone = wordArray.clone();\n\t         */\n\t        clone: function () {\n\t            var clone = Base.clone.call(this);\n\t            clone.words = this.words.slice(0);\n\n\t            return clone;\n\t        },\n\n\t        /**\n\t         * Creates a word array filled with random bytes.\n\t         *\n\t         * @param {number} nBytes The number of random bytes to generate.\n\t         *\n\t         * @return {WordArray} The random word array.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.lib.WordArray.random(16);\n\t         */\n\t        random: function (nBytes) {\n\t            var words = [];\n\n\t            var r = (function (m_w) {\n\t                var m_w = m_w;\n\t                var m_z = 0x3ade68b1;\n\t                var mask = 0xffffffff;\n\n\t                return function () {\n\t                    m_z = (0x9069 * (m_z & 0xFFFF) + (m_z >> 0x10)) & mask;\n\t                    m_w = (0x4650 * (m_w & 0xFFFF) + (m_w >> 0x10)) & mask;\n\t                    var result = ((m_z << 0x10) + m_w) & mask;\n\t                    result /= 0x100000000;\n\t                    result += 0.5;\n\t                    return result * (Math.random() > .5 ? 1 : -1);\n\t                }\n\t            });\n\n\t            for (var i = 0, rcache; i < nBytes; i += 4) {\n\t                var _r = r((rcache || Math.random()) * 0x100000000);\n\n\t                rcache = _r() * 0x3ade67b7;\n\t                words.push((_r() * 0x100000000) | 0);\n\t            }\n\n\t            return new WordArray.init(words, nBytes);\n\t        }\n\t    });\n\n\t    /**\n\t     * Encoder namespace.\n\t     */\n\t    var C_enc = C.enc = {};\n\n\t    /**\n\t     * Hex encoding strategy.\n\t     */\n\t    var Hex = C_enc.Hex = {\n\t        /**\n\t         * Converts a word array to a hex string.\n\t         *\n\t         * @param {WordArray} wordArray The word array.\n\t         *\n\t         * @return {string} The hex string.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var hexString = CryptoJS.enc.Hex.stringify(wordArray);\n\t         */\n\t        stringify: function (wordArray) {\n\t            // Shortcuts\n\t            var words = wordArray.words;\n\t            var sigBytes = wordArray.sigBytes;\n\n\t            // Convert\n\t            var hexChars = [];\n\t            for (var i = 0; i < sigBytes; i++) {\n\t                var bite = (words[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff;\n\t                hexChars.push((bite >>> 4).toString(16));\n\t                hexChars.push((bite & 0x0f).toString(16));\n\t            }\n\n\t            return hexChars.join('');\n\t        },\n\n\t        /**\n\t         * Converts a hex string to a word array.\n\t         *\n\t         * @param {string} hexStr The hex string.\n\t         *\n\t         * @return {WordArray} The word array.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.enc.Hex.parse(hexString);\n\t         */\n\t        parse: function (hexStr) {\n\t            // Shortcut\n\t            var hexStrLength = hexStr.length;\n\n\t            // Convert\n\t            var words = [];\n\t            for (var i = 0; i < hexStrLength; i += 2) {\n\t                words[i >>> 3] |= parseInt(hexStr.substr(i, 2), 16) << (24 - (i % 8) * 4);\n\t            }\n\n\t            return new WordArray.init(words, hexStrLength / 2);\n\t        }\n\t    };\n\n\t    /**\n\t     * Latin1 encoding strategy.\n\t     */\n\t    var Latin1 = C_enc.Latin1 = {\n\t        /**\n\t         * Converts a word array to a Latin1 string.\n\t         *\n\t         * @param {WordArray} wordArray The word array.\n\t         *\n\t         * @return {string} The Latin1 string.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var latin1String = CryptoJS.enc.Latin1.stringify(wordArray);\n\t         */\n\t        stringify: function (wordArray) {\n\t            // Shortcuts\n\t            var words = wordArray.words;\n\t            var sigBytes = wordArray.sigBytes;\n\n\t            // Convert\n\t            var latin1Chars = [];\n\t            for (var i = 0; i < sigBytes; i++) {\n\t                var bite = (words[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff;\n\t                latin1Chars.push(String.fromCharCode(bite));\n\t            }\n\n\t            return latin1Chars.join('');\n\t        },\n\n\t        /**\n\t         * Converts a Latin1 string to a word array.\n\t         *\n\t         * @param {string} latin1Str The Latin1 string.\n\t         *\n\t         * @return {WordArray} The word array.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.enc.Latin1.parse(latin1String);\n\t         */\n\t        parse: function (latin1Str) {\n\t            // Shortcut\n\t            var latin1StrLength = latin1Str.length;\n\n\t            // Convert\n\t            var words = [];\n\t            for (var i = 0; i < latin1StrLength; i++) {\n\t                words[i >>> 2] |= (latin1Str.charCodeAt(i) & 0xff) << (24 - (i % 4) * 8);\n\t            }\n\n\t            return new WordArray.init(words, latin1StrLength);\n\t        }\n\t    };\n\n\t    /**\n\t     * UTF-8 encoding strategy.\n\t     */\n\t    var Utf8 = C_enc.Utf8 = {\n\t        /**\n\t         * Converts a word array to a UTF-8 string.\n\t         *\n\t         * @param {WordArray} wordArray The word array.\n\t         *\n\t         * @return {string} The UTF-8 string.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var utf8String = CryptoJS.enc.Utf8.stringify(wordArray);\n\t         */\n\t        stringify: function (wordArray) {\n\t            try {\n\t                return decodeURIComponent(escape(Latin1.stringify(wordArray)));\n\t            } catch (e) {\n\t                throw new Error('Malformed UTF-8 data');\n\t            }\n\t        },\n\n\t        /**\n\t         * Converts a UTF-8 string to a word array.\n\t         *\n\t         * @param {string} utf8Str The UTF-8 string.\n\t         *\n\t         * @return {WordArray} The word array.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.enc.Utf8.parse(utf8String);\n\t         */\n\t        parse: function (utf8Str) {\n\t            return Latin1.parse(unescape(encodeURIComponent(utf8Str)));\n\t        }\n\t    };\n\n\t    /**\n\t     * Abstract buffered block algorithm template.\n\t     *\n\t     * The property blockSize must be implemented in a concrete subtype.\n\t     *\n\t     * @property {number} _minBufferSize The number of blocks that should be kept unprocessed in the buffer. Default: 0\n\t     */\n\t    var BufferedBlockAlgorithm = C_lib.BufferedBlockAlgorithm = Base.extend({\n\t        /**\n\t         * Resets this block algorithm's data buffer to its initial state.\n\t         *\n\t         * @example\n\t         *\n\t         *     bufferedBlockAlgorithm.reset();\n\t         */\n\t        reset: function () {\n\t            // Initial values\n\t            this._data = new WordArray.init();\n\t            this._nDataBytes = 0;\n\t        },\n\n\t        /**\n\t         * Adds new data to this block algorithm's buffer.\n\t         *\n\t         * @param {WordArray|string} data The data to append. Strings are converted to a WordArray using UTF-8.\n\t         *\n\t         * @example\n\t         *\n\t         *     bufferedBlockAlgorithm._append('data');\n\t         *     bufferedBlockAlgorithm._append(wordArray);\n\t         */\n\t        _append: function (data) {\n\t            // Convert string to WordArray, else assume WordArray already\n\t            if (typeof data == 'string') {\n\t                data = Utf8.parse(data);\n\t            }\n\n\t            // Append\n\t            this._data.concat(data);\n\t            this._nDataBytes += data.sigBytes;\n\t        },\n\n\t        /**\n\t         * Processes available data blocks.\n\t         *\n\t         * This method invokes _doProcessBlock(offset), which must be implemented by a concrete subtype.\n\t         *\n\t         * @param {boolean} doFlush Whether all blocks and partial blocks should be processed.\n\t         *\n\t         * @return {WordArray} The processed data.\n\t         *\n\t         * @example\n\t         *\n\t         *     var processedData = bufferedBlockAlgorithm._process();\n\t         *     var processedData = bufferedBlockAlgorithm._process(!!'flush');\n\t         */\n\t        _process: function (doFlush) {\n\t            // Shortcuts\n\t            var data = this._data;\n\t            var dataWords = data.words;\n\t            var dataSigBytes = data.sigBytes;\n\t            var blockSize = this.blockSize;\n\t            var blockSizeBytes = blockSize * 4;\n\n\t            // Count blocks ready\n\t            var nBlocksReady = dataSigBytes / blockSizeBytes;\n\t            if (doFlush) {\n\t                // Round up to include partial blocks\n\t                nBlocksReady = Math.ceil(nBlocksReady);\n\t            } else {\n\t                // Round down to include only full blocks,\n\t                // less the number of blocks that must remain in the buffer\n\t                nBlocksReady = Math.max((nBlocksReady | 0) - this._minBufferSize, 0);\n\t            }\n\n\t            // Count words ready\n\t            var nWordsReady = nBlocksReady * blockSize;\n\n\t            // Count bytes ready\n\t            var nBytesReady = Math.min(nWordsReady * 4, dataSigBytes);\n\n\t            // Process blocks\n\t            if (nWordsReady) {\n\t                for (var offset = 0; offset < nWordsReady; offset += blockSize) {\n\t                    // Perform concrete-algorithm logic\n\t                    this._doProcessBlock(dataWords, offset);\n\t                }\n\n\t                // Remove processed words\n\t                var processedWords = dataWords.splice(0, nWordsReady);\n\t                data.sigBytes -= nBytesReady;\n\t            }\n\n\t            // Return processed words\n\t            return new WordArray.init(processedWords, nBytesReady);\n\t        },\n\n\t        /**\n\t         * Creates a copy of this object.\n\t         *\n\t         * @return {Object} The clone.\n\t         *\n\t         * @example\n\t         *\n\t         *     var clone = bufferedBlockAlgorithm.clone();\n\t         */\n\t        clone: function () {\n\t            var clone = Base.clone.call(this);\n\t            clone._data = this._data.clone();\n\n\t            return clone;\n\t        },\n\n\t        _minBufferSize: 0\n\t    });\n\n\t    /**\n\t     * Abstract hasher template.\n\t     *\n\t     * @property {number} blockSize The number of 32-bit words this hasher operates on. Default: 16 (512 bits)\n\t     */\n\t    var Hasher = C_lib.Hasher = BufferedBlockAlgorithm.extend({\n\t        /**\n\t         * Configuration options.\n\t         */\n\t        cfg: Base.extend(),\n\n\t        /**\n\t         * Initializes a newly created hasher.\n\t         *\n\t         * @param {Object} cfg (Optional) The configuration options to use for this hash computation.\n\t         *\n\t         * @example\n\t         *\n\t         *     var hasher = CryptoJS.algo.SHA256.create();\n\t         */\n\t        init: function (cfg) {\n\t            // Apply config defaults\n\t            this.cfg = this.cfg.extend(cfg);\n\n\t            // Set initial values\n\t            this.reset();\n\t        },\n\n\t        /**\n\t         * Resets this hasher to its initial state.\n\t         *\n\t         * @example\n\t         *\n\t         *     hasher.reset();\n\t         */\n\t        reset: function () {\n\t            // Reset data buffer\n\t            BufferedBlockAlgorithm.reset.call(this);\n\n\t            // Perform concrete-hasher logic\n\t            this._doReset();\n\t        },\n\n\t        /**\n\t         * Updates this hasher with a message.\n\t         *\n\t         * @param {WordArray|string} messageUpdate The message to append.\n\t         *\n\t         * @return {Hasher} This hasher.\n\t         *\n\t         * @example\n\t         *\n\t         *     hasher.update('message');\n\t         *     hasher.update(wordArray);\n\t         */\n\t        update: function (messageUpdate) {\n\t            // Append\n\t            this._append(messageUpdate);\n\n\t            // Update the hash\n\t            this._process();\n\n\t            // Chainable\n\t            return this;\n\t        },\n\n\t        /**\n\t         * Finalizes the hash computation.\n\t         * Note that the finalize operation is effectively a destructive, read-once operation.\n\t         *\n\t         * @param {WordArray|string} messageUpdate (Optional) A final message update.\n\t         *\n\t         * @return {WordArray} The hash.\n\t         *\n\t         * @example\n\t         *\n\t         *     var hash = hasher.finalize();\n\t         *     var hash = hasher.finalize('message');\n\t         *     var hash = hasher.finalize(wordArray);\n\t         */\n\t        finalize: function (messageUpdate) {\n\t            // Final message update\n\t            if (messageUpdate) {\n\t                this._append(messageUpdate);\n\t            }\n\n\t            // Perform concrete-hasher logic\n\t            var hash = this._doFinalize();\n\n\t            return hash;\n\t        },\n\n\t        blockSize: 512/32,\n\n\t        /**\n\t         * Creates a shortcut function to a hasher's object interface.\n\t         *\n\t         * @param {Hasher} hasher The hasher to create a helper for.\n\t         *\n\t         * @return {Function} The shortcut function.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var SHA256 = CryptoJS.lib.Hasher._createHelper(CryptoJS.algo.SHA256);\n\t         */\n\t        _createHelper: function (hasher) {\n\t            return function (message, cfg) {\n\t                return new hasher.init(cfg).finalize(message);\n\t            };\n\t        },\n\n\t        /**\n\t         * Creates a shortcut function to the HMAC's object interface.\n\t         *\n\t         * @param {Hasher} hasher The hasher to use in this HMAC helper.\n\t         *\n\t         * @return {Function} The shortcut function.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var HmacSHA256 = CryptoJS.lib.Hasher._createHmacHelper(CryptoJS.algo.SHA256);\n\t         */\n\t        _createHmacHelper: function (hasher) {\n\t            return function (message, key) {\n\t                return new C_algo.HMAC.init(hasher, key).finalize(message);\n\t            };\n\t        }\n\t    });\n\n\t    /**\n\t     * Algorithm namespace.\n\t     */\n\t    var C_algo = C.algo = {};\n\n\t    return C;\n\t}(Math));\n\n\n\treturn CryptoJS;\n\n}));",";(function (root, factory) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\treturn CryptoJS.enc.Hex;\n\n}));",";(function (root, factory) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\t(function (undefined) {\n\t    // Shortcuts\n\t    var C = CryptoJS;\n\t    var C_lib = C.lib;\n\t    var Base = C_lib.Base;\n\t    var X32WordArray = C_lib.WordArray;\n\n\t    /**\n\t     * x64 namespace.\n\t     */\n\t    var C_x64 = C.x64 = {};\n\n\t    /**\n\t     * A 64-bit word.\n\t     */\n\t    var X64Word = C_x64.Word = Base.extend({\n\t        /**\n\t         * Initializes a newly created 64-bit word.\n\t         *\n\t         * @param {number} high The high 32 bits.\n\t         * @param {number} low The low 32 bits.\n\t         *\n\t         * @example\n\t         *\n\t         *     var x64Word = CryptoJS.x64.Word.create(0x00010203, 0x04050607);\n\t         */\n\t        init: function (high, low) {\n\t            this.high = high;\n\t            this.low = low;\n\t        }\n\n\t        /**\n\t         * Bitwise NOTs this word.\n\t         *\n\t         * @return {X64Word} A new x64-Word object after negating.\n\t         *\n\t         * @example\n\t         *\n\t         *     var negated = x64Word.not();\n\t         */\n\t        // not: function () {\n\t            // var high = ~this.high;\n\t            // var low = ~this.low;\n\n\t            // return X64Word.create(high, low);\n\t        // },\n\n\t        /**\n\t         * Bitwise ANDs this word with the passed word.\n\t         *\n\t         * @param {X64Word} word The x64-Word to AND with this word.\n\t         *\n\t         * @return {X64Word} A new x64-Word object after ANDing.\n\t         *\n\t         * @example\n\t         *\n\t         *     var anded = x64Word.and(anotherX64Word);\n\t         */\n\t        // and: function (word) {\n\t            // var high = this.high & word.high;\n\t            // var low = this.low & word.low;\n\n\t            // return X64Word.create(high, low);\n\t        // },\n\n\t        /**\n\t         * Bitwise ORs this word with the passed word.\n\t         *\n\t         * @param {X64Word} word The x64-Word to OR with this word.\n\t         *\n\t         * @return {X64Word} A new x64-Word object after ORing.\n\t         *\n\t         * @example\n\t         *\n\t         *     var ored = x64Word.or(anotherX64Word);\n\t         */\n\t        // or: function (word) {\n\t            // var high = this.high | word.high;\n\t            // var low = this.low | word.low;\n\n\t            // return X64Word.create(high, low);\n\t        // },\n\n\t        /**\n\t         * Bitwise XORs this word with the passed word.\n\t         *\n\t         * @param {X64Word} word The x64-Word to XOR with this word.\n\t         *\n\t         * @return {X64Word} A new x64-Word object after XORing.\n\t         *\n\t         * @example\n\t         *\n\t         *     var xored = x64Word.xor(anotherX64Word);\n\t         */\n\t        // xor: function (word) {\n\t            // var high = this.high ^ word.high;\n\t            // var low = this.low ^ word.low;\n\n\t            // return X64Word.create(high, low);\n\t        // },\n\n\t        /**\n\t         * Shifts this word n bits to the left.\n\t         *\n\t         * @param {number} n The number of bits to shift.\n\t         *\n\t         * @return {X64Word} A new x64-Word object after shifting.\n\t         *\n\t         * @example\n\t         *\n\t         *     var shifted = x64Word.shiftL(25);\n\t         */\n\t        // shiftL: function (n) {\n\t            // if (n < 32) {\n\t                // var high = (this.high << n) | (this.low >>> (32 - n));\n\t                // var low = this.low << n;\n\t            // } else {\n\t                // var high = this.low << (n - 32);\n\t                // var low = 0;\n\t            // }\n\n\t            // return X64Word.create(high, low);\n\t        // },\n\n\t        /**\n\t         * Shifts this word n bits to the right.\n\t         *\n\t         * @param {number} n The number of bits to shift.\n\t         *\n\t         * @return {X64Word} A new x64-Word object after shifting.\n\t         *\n\t         * @example\n\t         *\n\t         *     var shifted = x64Word.shiftR(7);\n\t         */\n\t        // shiftR: function (n) {\n\t            // if (n < 32) {\n\t                // var low = (this.low >>> n) | (this.high << (32 - n));\n\t                // var high = this.high >>> n;\n\t            // } else {\n\t                // var low = this.high >>> (n - 32);\n\t                // var high = 0;\n\t            // }\n\n\t            // return X64Word.create(high, low);\n\t        // },\n\n\t        /**\n\t         * Rotates this word n bits to the left.\n\t         *\n\t         * @param {number} n The number of bits to rotate.\n\t         *\n\t         * @return {X64Word} A new x64-Word object after rotating.\n\t         *\n\t         * @example\n\t         *\n\t         *     var rotated = x64Word.rotL(25);\n\t         */\n\t        // rotL: function (n) {\n\t            // return this.shiftL(n).or(this.shiftR(64 - n));\n\t        // },\n\n\t        /**\n\t         * Rotates this word n bits to the right.\n\t         *\n\t         * @param {number} n The number of bits to rotate.\n\t         *\n\t         * @return {X64Word} A new x64-Word object after rotating.\n\t         *\n\t         * @example\n\t         *\n\t         *     var rotated = x64Word.rotR(7);\n\t         */\n\t        // rotR: function (n) {\n\t            // return this.shiftR(n).or(this.shiftL(64 - n));\n\t        // },\n\n\t        /**\n\t         * Adds this word with the passed word.\n\t         *\n\t         * @param {X64Word} word The x64-Word to add with this word.\n\t         *\n\t         * @return {X64Word} A new x64-Word object after adding.\n\t         *\n\t         * @example\n\t         *\n\t         *     var added = x64Word.add(anotherX64Word);\n\t         */\n\t        // add: function (word) {\n\t            // var low = (this.low + word.low) | 0;\n\t            // var carry = (low >>> 0) < (this.low >>> 0) ? 1 : 0;\n\t            // var high = (this.high + word.high + carry) | 0;\n\n\t            // return X64Word.create(high, low);\n\t        // }\n\t    });\n\n\t    /**\n\t     * An array of 64-bit words.\n\t     *\n\t     * @property {Array} words The array of CryptoJS.x64.Word objects.\n\t     * @property {number} sigBytes The number of significant bytes in this word array.\n\t     */\n\t    var X64WordArray = C_x64.WordArray = Base.extend({\n\t        /**\n\t         * Initializes a newly created word array.\n\t         *\n\t         * @param {Array} words (Optional) An array of CryptoJS.x64.Word objects.\n\t         * @param {number} sigBytes (Optional) The number of significant bytes in the words.\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.x64.WordArray.create();\n\t         *\n\t         *     var wordArray = CryptoJS.x64.WordArray.create([\n\t         *         CryptoJS.x64.Word.create(0x00010203, 0x04050607),\n\t         *         CryptoJS.x64.Word.create(0x18191a1b, 0x1c1d1e1f)\n\t         *     ]);\n\t         *\n\t         *     var wordArray = CryptoJS.x64.WordArray.create([\n\t         *         CryptoJS.x64.Word.create(0x00010203, 0x04050607),\n\t         *         CryptoJS.x64.Word.create(0x18191a1b, 0x1c1d1e1f)\n\t         *     ], 10);\n\t         */\n\t        init: function (words, sigBytes) {\n\t            words = this.words = words || [];\n\n\t            if (sigBytes != undefined) {\n\t                this.sigBytes = sigBytes;\n\t            } else {\n\t                this.sigBytes = words.length * 8;\n\t            }\n\t        },\n\n\t        /**\n\t         * Converts this 64-bit word array to a 32-bit word array.\n\t         *\n\t         * @return {CryptoJS.lib.WordArray} This word array's data as a 32-bit word array.\n\t         *\n\t         * @example\n\t         *\n\t         *     var x32WordArray = x64WordArray.toX32();\n\t         */\n\t        toX32: function () {\n\t            // Shortcuts\n\t            var x64Words = this.words;\n\t            var x64WordsLength = x64Words.length;\n\n\t            // Convert\n\t            var x32Words = [];\n\t            for (var i = 0; i < x64WordsLength; i++) {\n\t                var x64Word = x64Words[i];\n\t                x32Words.push(x64Word.high);\n\t                x32Words.push(x64Word.low);\n\t            }\n\n\t            return X32WordArray.create(x32Words, this.sigBytes);\n\t        },\n\n\t        /**\n\t         * Creates a copy of this word array.\n\t         *\n\t         * @return {X64WordArray} The clone.\n\t         *\n\t         * @example\n\t         *\n\t         *     var clone = x64WordArray.clone();\n\t         */\n\t        clone: function () {\n\t            var clone = Base.clone.call(this);\n\n\t            // Clone \"words\" array\n\t            var words = clone.words = this.words.slice(0);\n\n\t            // Clone each X64Word object\n\t            var wordsLength = words.length;\n\t            for (var i = 0; i < wordsLength; i++) {\n\t                words[i] = words[i].clone();\n\t            }\n\n\t            return clone;\n\t        }\n\t    });\n\t}());\n\n\n\treturn CryptoJS;\n\n}));",";(function (root, factory, undef) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"), require(\"./x64-core\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\", \"./x64-core\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\t(function () {\n\t    // Shortcuts\n\t    var C = CryptoJS;\n\t    var C_lib = C.lib;\n\t    var Hasher = C_lib.Hasher;\n\t    var C_x64 = C.x64;\n\t    var X64Word = C_x64.Word;\n\t    var X64WordArray = C_x64.WordArray;\n\t    var C_algo = C.algo;\n\n\t    function X64Word_create() {\n\t        return X64Word.create.apply(X64Word, arguments);\n\t    }\n\n\t    // Constants\n\t    var K = [\n\t        X64Word_create(0x428a2f98, 0xd728ae22), X64Word_create(0x71374491, 0x23ef65cd),\n\t        X64Word_create(0xb5c0fbcf, 0xec4d3b2f), X64Word_create(0xe9b5dba5, 0x8189dbbc),\n\t        X64Word_create(0x3956c25b, 0xf348b538), X64Word_create(0x59f111f1, 0xb605d019),\n\t        X64Word_create(0x923f82a4, 0xaf194f9b), X64Word_create(0xab1c5ed5, 0xda6d8118),\n\t        X64Word_create(0xd807aa98, 0xa3030242), X64Word_create(0x12835b01, 0x45706fbe),\n\t        X64Word_create(0x243185be, 0x4ee4b28c), X64Word_create(0x550c7dc3, 0xd5ffb4e2),\n\t        X64Word_create(0x72be5d74, 0xf27b896f), X64Word_create(0x80deb1fe, 0x3b1696b1),\n\t        X64Word_create(0x9bdc06a7, 0x25c71235), X64Word_create(0xc19bf174, 0xcf692694),\n\t        X64Word_create(0xe49b69c1, 0x9ef14ad2), X64Word_create(0xefbe4786, 0x384f25e3),\n\t        X64Word_create(0x0fc19dc6, 0x8b8cd5b5), X64Word_create(0x240ca1cc, 0x77ac9c65),\n\t        X64Word_create(0x2de92c6f, 0x592b0275), X64Word_create(0x4a7484aa, 0x6ea6e483),\n\t        X64Word_create(0x5cb0a9dc, 0xbd41fbd4), X64Word_create(0x76f988da, 0x831153b5),\n\t        X64Word_create(0x983e5152, 0xee66dfab), X64Word_create(0xa831c66d, 0x2db43210),\n\t        X64Word_create(0xb00327c8, 0x98fb213f), X64Word_create(0xbf597fc7, 0xbeef0ee4),\n\t        X64Word_create(0xc6e00bf3, 0x3da88fc2), X64Word_create(0xd5a79147, 0x930aa725),\n\t        X64Word_create(0x06ca6351, 0xe003826f), X64Word_create(0x14292967, 0x0a0e6e70),\n\t        X64Word_create(0x27b70a85, 0x46d22ffc), X64Word_create(0x2e1b2138, 0x5c26c926),\n\t        X64Word_create(0x4d2c6dfc, 0x5ac42aed), X64Word_create(0x53380d13, 0x9d95b3df),\n\t        X64Word_create(0x650a7354, 0x8baf63de), X64Word_create(0x766a0abb, 0x3c77b2a8),\n\t        X64Word_create(0x81c2c92e, 0x47edaee6), X64Word_create(0x92722c85, 0x1482353b),\n\t        X64Word_create(0xa2bfe8a1, 0x4cf10364), X64Word_create(0xa81a664b, 0xbc423001),\n\t        X64Word_create(0xc24b8b70, 0xd0f89791), X64Word_create(0xc76c51a3, 0x0654be30),\n\t        X64Word_create(0xd192e819, 0xd6ef5218), X64Word_create(0xd6990624, 0x5565a910),\n\t        X64Word_create(0xf40e3585, 0x5771202a), X64Word_create(0x106aa070, 0x32bbd1b8),\n\t        X64Word_create(0x19a4c116, 0xb8d2d0c8), X64Word_create(0x1e376c08, 0x5141ab53),\n\t        X64Word_create(0x2748774c, 0xdf8eeb99), X64Word_create(0x34b0bcb5, 0xe19b48a8),\n\t        X64Word_create(0x391c0cb3, 0xc5c95a63), X64Word_create(0x4ed8aa4a, 0xe3418acb),\n\t        X64Word_create(0x5b9cca4f, 0x7763e373), X64Word_create(0x682e6ff3, 0xd6b2b8a3),\n\t        X64Word_create(0x748f82ee, 0x5defb2fc), X64Word_create(0x78a5636f, 0x43172f60),\n\t        X64Word_create(0x84c87814, 0xa1f0ab72), X64Word_create(0x8cc70208, 0x1a6439ec),\n\t        X64Word_create(0x90befffa, 0x23631e28), X64Word_create(0xa4506ceb, 0xde82bde9),\n\t        X64Word_create(0xbef9a3f7, 0xb2c67915), X64Word_create(0xc67178f2, 0xe372532b),\n\t        X64Word_create(0xca273ece, 0xea26619c), X64Word_create(0xd186b8c7, 0x21c0c207),\n\t        X64Word_create(0xeada7dd6, 0xcde0eb1e), X64Word_create(0xf57d4f7f, 0xee6ed178),\n\t        X64Word_create(0x06f067aa, 0x72176fba), X64Word_create(0x0a637dc5, 0xa2c898a6),\n\t        X64Word_create(0x113f9804, 0xbef90dae), X64Word_create(0x1b710b35, 0x131c471b),\n\t        X64Word_create(0x28db77f5, 0x23047d84), X64Word_create(0x32caab7b, 0x40c72493),\n\t        X64Word_create(0x3c9ebe0a, 0x15c9bebc), X64Word_create(0x431d67c4, 0x9c100d4c),\n\t        X64Word_create(0x4cc5d4be, 0xcb3e42b6), X64Word_create(0x597f299c, 0xfc657e2a),\n\t        X64Word_create(0x5fcb6fab, 0x3ad6faec), X64Word_create(0x6c44198c, 0x4a475817)\n\t    ];\n\n\t    // Reusable objects\n\t    var W = [];\n\t    (function () {\n\t        for (var i = 0; i < 80; i++) {\n\t            W[i] = X64Word_create();\n\t        }\n\t    }());\n\n\t    /**\n\t     * SHA-512 hash algorithm.\n\t     */\n\t    var SHA512 = C_algo.SHA512 = Hasher.extend({\n\t        _doReset: function () {\n\t            this._hash = new X64WordArray.init([\n\t                new X64Word.init(0x6a09e667, 0xf3bcc908), new X64Word.init(0xbb67ae85, 0x84caa73b),\n\t                new X64Word.init(0x3c6ef372, 0xfe94f82b), new X64Word.init(0xa54ff53a, 0x5f1d36f1),\n\t                new X64Word.init(0x510e527f, 0xade682d1), new X64Word.init(0x9b05688c, 0x2b3e6c1f),\n\t                new X64Word.init(0x1f83d9ab, 0xfb41bd6b), new X64Word.init(0x5be0cd19, 0x137e2179)\n\t            ]);\n\t        },\n\n\t        _doProcessBlock: function (M, offset) {\n\t            // Shortcuts\n\t            var H = this._hash.words;\n\n\t            var H0 = H[0];\n\t            var H1 = H[1];\n\t            var H2 = H[2];\n\t            var H3 = H[3];\n\t            var H4 = H[4];\n\t            var H5 = H[5];\n\t            var H6 = H[6];\n\t            var H7 = H[7];\n\n\t            var H0h = H0.high;\n\t            var H0l = H0.low;\n\t            var H1h = H1.high;\n\t            var H1l = H1.low;\n\t            var H2h = H2.high;\n\t            var H2l = H2.low;\n\t            var H3h = H3.high;\n\t            var H3l = H3.low;\n\t            var H4h = H4.high;\n\t            var H4l = H4.low;\n\t            var H5h = H5.high;\n\t            var H5l = H5.low;\n\t            var H6h = H6.high;\n\t            var H6l = H6.low;\n\t            var H7h = H7.high;\n\t            var H7l = H7.low;\n\n\t            // Working variables\n\t            var ah = H0h;\n\t            var al = H0l;\n\t            var bh = H1h;\n\t            var bl = H1l;\n\t            var ch = H2h;\n\t            var cl = H2l;\n\t            var dh = H3h;\n\t            var dl = H3l;\n\t            var eh = H4h;\n\t            var el = H4l;\n\t            var fh = H5h;\n\t            var fl = H5l;\n\t            var gh = H6h;\n\t            var gl = H6l;\n\t            var hh = H7h;\n\t            var hl = H7l;\n\n\t            // Rounds\n\t            for (var i = 0; i < 80; i++) {\n\t                // Shortcut\n\t                var Wi = W[i];\n\n\t                // Extend message\n\t                if (i < 16) {\n\t                    var Wih = Wi.high = M[offset + i * 2]     | 0;\n\t                    var Wil = Wi.low  = M[offset + i * 2 + 1] | 0;\n\t                } else {\n\t                    // Gamma0\n\t                    var gamma0x  = W[i - 15];\n\t                    var gamma0xh = gamma0x.high;\n\t                    var gamma0xl = gamma0x.low;\n\t                    var gamma0h  = ((gamma0xh >>> 1) | (gamma0xl << 31)) ^ ((gamma0xh >>> 8) | (gamma0xl << 24)) ^ (gamma0xh >>> 7);\n\t                    var gamma0l  = ((gamma0xl >>> 1) | (gamma0xh << 31)) ^ ((gamma0xl >>> 8) | (gamma0xh << 24)) ^ ((gamma0xl >>> 7) | (gamma0xh << 25));\n\n\t                    // Gamma1\n\t                    var gamma1x  = W[i - 2];\n\t                    var gamma1xh = gamma1x.high;\n\t                    var gamma1xl = gamma1x.low;\n\t                    var gamma1h  = ((gamma1xh >>> 19) | (gamma1xl << 13)) ^ ((gamma1xh << 3) | (gamma1xl >>> 29)) ^ (gamma1xh >>> 6);\n\t                    var gamma1l  = ((gamma1xl >>> 19) | (gamma1xh << 13)) ^ ((gamma1xl << 3) | (gamma1xh >>> 29)) ^ ((gamma1xl >>> 6) | (gamma1xh << 26));\n\n\t                    // W[i] = gamma0 + W[i - 7] + gamma1 + W[i - 16]\n\t                    var Wi7  = W[i - 7];\n\t                    var Wi7h = Wi7.high;\n\t                    var Wi7l = Wi7.low;\n\n\t                    var Wi16  = W[i - 16];\n\t                    var Wi16h = Wi16.high;\n\t                    var Wi16l = Wi16.low;\n\n\t                    var Wil = gamma0l + Wi7l;\n\t                    var Wih = gamma0h + Wi7h + ((Wil >>> 0) < (gamma0l >>> 0) ? 1 : 0);\n\t                    var Wil = Wil + gamma1l;\n\t                    var Wih = Wih + gamma1h + ((Wil >>> 0) < (gamma1l >>> 0) ? 1 : 0);\n\t                    var Wil = Wil + Wi16l;\n\t                    var Wih = Wih + Wi16h + ((Wil >>> 0) < (Wi16l >>> 0) ? 1 : 0);\n\n\t                    Wi.high = Wih;\n\t                    Wi.low  = Wil;\n\t                }\n\n\t                var chh  = (eh & fh) ^ (~eh & gh);\n\t                var chl  = (el & fl) ^ (~el & gl);\n\t                var majh = (ah & bh) ^ (ah & ch) ^ (bh & ch);\n\t                var majl = (al & bl) ^ (al & cl) ^ (bl & cl);\n\n\t                var sigma0h = ((ah >>> 28) | (al << 4))  ^ ((ah << 30)  | (al >>> 2)) ^ ((ah << 25) | (al >>> 7));\n\t                var sigma0l = ((al >>> 28) | (ah << 4))  ^ ((al << 30)  | (ah >>> 2)) ^ ((al << 25) | (ah >>> 7));\n\t                var sigma1h = ((eh >>> 14) | (el << 18)) ^ ((eh >>> 18) | (el << 14)) ^ ((eh << 23) | (el >>> 9));\n\t                var sigma1l = ((el >>> 14) | (eh << 18)) ^ ((el >>> 18) | (eh << 14)) ^ ((el << 23) | (eh >>> 9));\n\n\t                // t1 = h + sigma1 + ch + K[i] + W[i]\n\t                var Ki  = K[i];\n\t                var Kih = Ki.high;\n\t                var Kil = Ki.low;\n\n\t                var t1l = hl + sigma1l;\n\t                var t1h = hh + sigma1h + ((t1l >>> 0) < (hl >>> 0) ? 1 : 0);\n\t                var t1l = t1l + chl;\n\t                var t1h = t1h + chh + ((t1l >>> 0) < (chl >>> 0) ? 1 : 0);\n\t                var t1l = t1l + Kil;\n\t                var t1h = t1h + Kih + ((t1l >>> 0) < (Kil >>> 0) ? 1 : 0);\n\t                var t1l = t1l + Wil;\n\t                var t1h = t1h + Wih + ((t1l >>> 0) < (Wil >>> 0) ? 1 : 0);\n\n\t                // t2 = sigma0 + maj\n\t                var t2l = sigma0l + majl;\n\t                var t2h = sigma0h + majh + ((t2l >>> 0) < (sigma0l >>> 0) ? 1 : 0);\n\n\t                // Update working variables\n\t                hh = gh;\n\t                hl = gl;\n\t                gh = fh;\n\t                gl = fl;\n\t                fh = eh;\n\t                fl = el;\n\t                el = (dl + t1l) | 0;\n\t                eh = (dh + t1h + ((el >>> 0) < (dl >>> 0) ? 1 : 0)) | 0;\n\t                dh = ch;\n\t                dl = cl;\n\t                ch = bh;\n\t                cl = bl;\n\t                bh = ah;\n\t                bl = al;\n\t                al = (t1l + t2l) | 0;\n\t                ah = (t1h + t2h + ((al >>> 0) < (t1l >>> 0) ? 1 : 0)) | 0;\n\t            }\n\n\t            // Intermediate hash value\n\t            H0l = H0.low  = (H0l + al);\n\t            H0.high = (H0h + ah + ((H0l >>> 0) < (al >>> 0) ? 1 : 0));\n\t            H1l = H1.low  = (H1l + bl);\n\t            H1.high = (H1h + bh + ((H1l >>> 0) < (bl >>> 0) ? 1 : 0));\n\t            H2l = H2.low  = (H2l + cl);\n\t            H2.high = (H2h + ch + ((H2l >>> 0) < (cl >>> 0) ? 1 : 0));\n\t            H3l = H3.low  = (H3l + dl);\n\t            H3.high = (H3h + dh + ((H3l >>> 0) < (dl >>> 0) ? 1 : 0));\n\t            H4l = H4.low  = (H4l + el);\n\t            H4.high = (H4h + eh + ((H4l >>> 0) < (el >>> 0) ? 1 : 0));\n\t            H5l = H5.low  = (H5l + fl);\n\t            H5.high = (H5h + fh + ((H5l >>> 0) < (fl >>> 0) ? 1 : 0));\n\t            H6l = H6.low  = (H6l + gl);\n\t            H6.high = (H6h + gh + ((H6l >>> 0) < (gl >>> 0) ? 1 : 0));\n\t            H7l = H7.low  = (H7l + hl);\n\t            H7.high = (H7h + hh + ((H7l >>> 0) < (hl >>> 0) ? 1 : 0));\n\t        },\n\n\t        _doFinalize: function () {\n\t            // Shortcuts\n\t            var data = this._data;\n\t            var dataWords = data.words;\n\n\t            var nBitsTotal = this._nDataBytes * 8;\n\t            var nBitsLeft = data.sigBytes * 8;\n\n\t            // Add padding\n\t            dataWords[nBitsLeft >>> 5] |= 0x80 << (24 - nBitsLeft % 32);\n\t            dataWords[(((nBitsLeft + 128) >>> 10) << 5) + 30] = Math.floor(nBitsTotal / 0x100000000);\n\t            dataWords[(((nBitsLeft + 128) >>> 10) << 5) + 31] = nBitsTotal;\n\t            data.sigBytes = dataWords.length * 4;\n\n\t            // Hash final blocks\n\t            this._process();\n\n\t            // Convert hash to 32-bit word array before returning\n\t            var hash = this._hash.toX32();\n\n\t            // Return final computed hash\n\t            return hash;\n\t        },\n\n\t        clone: function () {\n\t            var clone = Hasher.clone.call(this);\n\t            clone._hash = this._hash.clone();\n\n\t            return clone;\n\t        },\n\n\t        blockSize: 1024/32\n\t    });\n\n\t    /**\n\t     * Shortcut function to the hasher's object interface.\n\t     *\n\t     * @param {WordArray|string} message The message to hash.\n\t     *\n\t     * @return {WordArray} The hash.\n\t     *\n\t     * @static\n\t     *\n\t     * @example\n\t     *\n\t     *     var hash = CryptoJS.SHA512('message');\n\t     *     var hash = CryptoJS.SHA512(wordArray);\n\t     */\n\t    C.SHA512 = Hasher._createHelper(SHA512);\n\n\t    /**\n\t     * Shortcut function to the HMAC's object interface.\n\t     *\n\t     * @param {WordArray|string} message The message to hash.\n\t     * @param {WordArray|string} key The secret key.\n\t     *\n\t     * @return {WordArray} The HMAC.\n\t     *\n\t     * @static\n\t     *\n\t     * @example\n\t     *\n\t     *     var hmac = CryptoJS.HmacSHA512(message, key);\n\t     */\n\t    C.HmacSHA512 = Hasher._createHmacHelper(SHA512);\n\t}());\n\n\n\treturn CryptoJS.SHA512;\n\n}));",";(function (root, factory) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\t(function () {\n\t    // Shortcuts\n\t    var C = CryptoJS;\n\t    var C_lib = C.lib;\n\t    var Base = C_lib.Base;\n\t    var C_enc = C.enc;\n\t    var Utf8 = C_enc.Utf8;\n\t    var C_algo = C.algo;\n\n\t    /**\n\t     * HMAC algorithm.\n\t     */\n\t    var HMAC = C_algo.HMAC = Base.extend({\n\t        /**\n\t         * Initializes a newly created HMAC.\n\t         *\n\t         * @param {Hasher} hasher The hash algorithm to use.\n\t         * @param {WordArray|string} key The secret key.\n\t         *\n\t         * @example\n\t         *\n\t         *     var hmacHasher = CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA256, key);\n\t         */\n\t        init: function (hasher, key) {\n\t            // Init hasher\n\t            hasher = this._hasher = new hasher.init();\n\n\t            // Convert string to WordArray, else assume WordArray already\n\t            if (typeof key == 'string') {\n\t                key = Utf8.parse(key);\n\t            }\n\n\t            // Shortcuts\n\t            var hasherBlockSize = hasher.blockSize;\n\t            var hasherBlockSizeBytes = hasherBlockSize * 4;\n\n\t            // Allow arbitrary length keys\n\t            if (key.sigBytes > hasherBlockSizeBytes) {\n\t                key = hasher.finalize(key);\n\t            }\n\n\t            // Clamp excess bits\n\t            key.clamp();\n\n\t            // Clone key for inner and outer pads\n\t            var oKey = this._oKey = key.clone();\n\t            var iKey = this._iKey = key.clone();\n\n\t            // Shortcuts\n\t            var oKeyWords = oKey.words;\n\t            var iKeyWords = iKey.words;\n\n\t            // XOR keys with pad constants\n\t            for (var i = 0; i < hasherBlockSize; i++) {\n\t                oKeyWords[i] ^= 0x5c5c5c5c;\n\t                iKeyWords[i] ^= 0x36363636;\n\t            }\n\t            oKey.sigBytes = iKey.sigBytes = hasherBlockSizeBytes;\n\n\t            // Set initial values\n\t            this.reset();\n\t        },\n\n\t        /**\n\t         * Resets this HMAC to its initial state.\n\t         *\n\t         * @example\n\t         *\n\t         *     hmacHasher.reset();\n\t         */\n\t        reset: function () {\n\t            // Shortcut\n\t            var hasher = this._hasher;\n\n\t            // Reset\n\t            hasher.reset();\n\t            hasher.update(this._iKey);\n\t        },\n\n\t        /**\n\t         * Updates this HMAC with a message.\n\t         *\n\t         * @param {WordArray|string} messageUpdate The message to append.\n\t         *\n\t         * @return {HMAC} This HMAC instance.\n\t         *\n\t         * @example\n\t         *\n\t         *     hmacHasher.update('message');\n\t         *     hmacHasher.update(wordArray);\n\t         */\n\t        update: function (messageUpdate) {\n\t            this._hasher.update(messageUpdate);\n\n\t            // Chainable\n\t            return this;\n\t        },\n\n\t        /**\n\t         * Finalizes the HMAC computation.\n\t         * Note that the finalize operation is effectively a destructive, read-once operation.\n\t         *\n\t         * @param {WordArray|string} messageUpdate (Optional) A final message update.\n\t         *\n\t         * @return {WordArray} The HMAC.\n\t         *\n\t         * @example\n\t         *\n\t         *     var hmac = hmacHasher.finalize();\n\t         *     var hmac = hmacHasher.finalize('message');\n\t         *     var hmac = hmacHasher.finalize(wordArray);\n\t         */\n\t        finalize: function (messageUpdate) {\n\t            // Shortcut\n\t            var hasher = this._hasher;\n\n\t            // Compute HMAC\n\t            var innerHash = hasher.finalize(messageUpdate);\n\t            hasher.reset();\n\t            var hmac = hasher.finalize(this._oKey.clone().concat(innerHash));\n\n\t            return hmac;\n\t        }\n\t    });\n\t}());\n\n\n}));",";(function (root, factory, undef) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"), require(\"./x64-core\"), require(\"./sha512\"), require(\"./hmac\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\", \"./x64-core\", \"./sha512\", \"./hmac\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\treturn CryptoJS.HmacSHA512;\n\n}));","import Hex from 'crypto-js/enc-hex';\nimport HmacSHA512 from 'crypto-js/hmac-sha512';\nimport { recognizerLogger as logger } from '../configuration/LoggerConfig';\n\n/**\n * Compute HMAC signature for server authentication\n *\n * @param {Object} input Input data to compute HMAC\n * @param {String} applicationKey Current applicationKey\n * @param {String} hmacKey Current hmacKey\n * @return {String} Signature\n */\nexport function computeHmac(input, applicationKey, hmacKey) {\n  const jsonInput = (typeof input === 'object') ? JSON.stringify(input) : input;\n  logger.debug('The HmacSHA512 function is loaded', HmacSHA512);\n  return new HmacSHA512(jsonInput, applicationKey + hmacKey).toString(Hex);\n}\n","/* eslint-disable no-unused-expressions */\nimport * as CryptoHelper from '../CryptoHelper';\n\n/**\n * Parse JSON String to Object\n * @param {Object} req JSON string result to be parsed\n * @return {Object} Parsed response\n */\nfunction parse(req) {\n  let result;\n  try {\n    result = JSON.parse(req.responseText);\n  } catch (e) {\n    result = req.responseText;\n  }\n  return result;\n}\n\n/**\n * Transform object data request to a list of parameters\n * @param {Object} obj Query properties\n * @return {String} URI encoded string\n */\nfunction transformRequest(obj) {\n  const str = [];\n  Object.keys(obj).forEach((p) => {\n    if ((typeof obj[p] !== 'undefined') &&\n        (typeof obj[p] !== 'function')) {\n      str.push(`${encodeURIComponent(p)}=${encodeURIComponent(obj[p])}`);\n    }\n  });\n  return str.join('&');\n}\n\n/**\n * Send request to the network and return a promise\n * @param {String} type Request type (GET/POST)\n * @param {String} url URL\n * @param {Object} data Data to be sent\n * @param {RecognizerContext} [recognizerContext] Recognizer context\n * @param {String} apiVersion api version\n * @param {String} mimeType MimeType to be used\n * @return {Promise}\n */\nfunction xhr(type, url, data, recognizerContext = {}, apiVersion, mimeType) {\n  const pptxMimeType = 'application/vnd.openxmlformats-officedocument.presentationml.presentation';\n  const configuration = recognizerContext.editor.configuration;\n  const recognizerContextRef = recognizerContext;\n  return new Promise((resolve, reject) => {\n    // We are writing some browser module here so the no import found should be ignored\n    // eslint-disable-next-line no-undef\n    const request = new XMLHttpRequest();\n    request.open(type, url, true);\n    request.withCredentials = true;\n    if (apiVersion === 'V3') {\n      request.setRequestHeader('Accept', 'application/json');\n      request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded;charset=UTF-8');\n    } else if (apiVersion === 'V4') {\n      switch (configuration.recognitionParams.type) {\n        case 'TEXT':\n          request.setRequestHeader('Accept', 'application/json,' + mimeType);\n          break;\n        case 'MATH':\n          request.setRequestHeader('Accept', 'application/json,' + mimeType);\n          break;\n        case 'DIAGRAM':\n          request.setRequestHeader('Accept', 'application/json,' + mimeType);\n          break;\n        case 'Raw Content':\n          request.setRequestHeader('Accept', 'application/json,' + mimeType);\n          break;\n        default:\n          break;\n      }\n      request.setRequestHeader('applicationKey', configuration.recognitionParams.server.applicationKey);\n      request.setRequestHeader('hmac', CryptoHelper.computeHmac(JSON.stringify(data), configuration.recognitionParams.server.applicationKey, configuration.recognitionParams.server.hmacKey));\n      request.setRequestHeader('Content-Type', 'application/json');\n    }\n\n    const isBlobType = mimeType && (mimeType === pptxMimeType || mimeType.startsWith('image/png') || mimeType.startsWith('image/jpeg'));\n    if (isBlobType) {\n      request.responseType = 'blob';\n    }\n\n    request.onerror = () => {\n      reject({ msg: `Could not connect to ${url} connection error`, recoverable: false });\n    };\n\n    request.onload = () => {\n      if (request.status >= 200 && request.status < 300) {\n        isBlobType ? resolve(request.response) : resolve(parse(request));\n      } else {\n        reject(new Error(request.responseText));\n      }\n    };\n\n    request.onreadystatechange = () => {\n      if (request.readyState === 4) {\n        if (request.status >= 200 && request.status < 300) {\n          isBlobType ? resolve(request.response) : resolve(parse(request));\n        }\n      }\n    };\n\n    if (recognizerContextRef) {\n      recognizerContextRef.idle = false;\n    }\n    if (apiVersion === 'V4') {\n      request.send(JSON.stringify(data));\n    } else {\n      request.send(data ? transformRequest(data) : undefined);\n    }\n  }).then((res) => {\n    if (recognizerContextRef) {\n      recognizerContextRef.idle = true;\n    }\n    return res;\n  });\n}\n\n/**\n * Get request\n * @param {RecognizerContext} recognizerContext Recognizer context\n * @param {String} url URL\n * @param {Object} params Query properties\n * @return {Promise}\n */\nexport function get(recognizerContext, url, params) {\n  let queryUrl = url;\n  if (params) {\n    queryUrl += `?${transformRequest(params)}`;\n  }\n  return xhr('GET', queryUrl, undefined, recognizerContext);\n}\n\n/**\n * Post request\n * @param {RecognizerContext} recognizerContext Recognizer context\n * @param {String} url URL\n * @param {Object} data Data to be sent\n * @param {String} apiVersion api version\n * @param {String} mimeType MimeType to be used\n * @return {Promise}\n */\nexport function post(recognizerContext, url, data, apiVersion, mimeType) {\n  return xhr('POST', url, data, recognizerContext, apiVersion, mimeType);\n}\n","import { recognizerLogger as logger } from '../configuration/LoggerConfig';\n\n/**\n * Recognition context\n * @typedef {Object} RecognitionContext\n * @property {Model} model\n * @property {Callback} callback\n */\n\n/**\n * Recognizer context\n * @typedef {Object} RecognizerContext\n * @property {Editor} editor Get a reference to the current editor\n * @property {Array<RecognitionContext>} recognitionContexts=[]\n * @property {Promise} initPromise=undefined\n * @property {RecognitionPositions} lastPositions  Last recognition sent/received stroke indexes.\n * @property {String} url=undefined\n * @property {WebSocket} websocket=undefined\n * @property {function} websocketCallback=undefined\n * @property {function} reconnect=undefined\n * @property {Number} currentReconnectionCount=0\n * @property {String} sessionId=undefined\n * @property {Number} contentPartCount=0\n * @property {String} currentPartId=undefined\n * @property {String} instanceId=undefined\n * @property {Boolean} canUndo=false\n * @property {Boolean} canRedo=false\n * @property {Boolean} isEmpty=false\n * @property {Array} supportedImportMimeTypes=[]\n * @property {Number} undoStackIndex=0\n * @property {Number} possibleUndoCount=0\n * @property {Boolean} idle=true\n * @property {Boolean} initialized=false\n */\n/**\n * Create a new recognizer context\n * @param {Editor} editor\n * @return {RecognizerContext} An object that contains all recognizer context\n */\nexport function createEmptyRecognizerContext(editor) {\n  const id = Date.now();\n  logger.info('Create empty recognizer context with ID: ' + id);\n  return {\n    id,\n    editor,\n    // websocket\n    recognitionContexts: [],\n    initPromise: undefined,\n    lastPositions: {\n      lastSentPosition: -1,\n      lastReceivedPosition: -1\n    },\n    url: undefined,\n    websocket: undefined,\n    websocketCallback: undefined,\n    reconnect: undefined,\n    currentReconnectionCount: 0,\n    sessionId: undefined,\n    contentPartCount: 0,\n    currentPartId: undefined,\n    instanceId: undefined,\n    canUndo: false,\n    canRedo: false,\n    isEmpty: undefined,\n    supportedImportMimeTypes: [],\n    undoStackIndex: 0,\n    possibleUndoCount: 0,\n    idle: true,\n    initialized: false\n  };\n}\n\n/**\n * Return true if a reset is required, false otherwise\n * @param {RecognizerContext} recognizerContext\n * @param {Model} model\n * @return {Boolean}\n */\nexport function isResetRequired(recognizerContext, model) {\n  if (recognizerContext.lastPositions) {\n    return recognizerContext.lastPositions.lastSentPosition >= model.rawStrokes.length - 1;\n  }\n  return false;\n}\n\n/**\n * Update the recognition context positions\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {RecognitionPositions} positions Current recognition positions\n * @return {RecognizerContext}\n */\nexport function updateRecognitionPositions(recognizerContext, positions) {\n  const recognizerContextRef = recognizerContext;\n  if (positions) {\n    recognizerContextRef.lastPositions.lastSentPosition = positions.lastSentPosition;\n    recognizerContextRef.lastPositions.lastReceivedPosition = positions.lastReceivedPosition;\n  }\n  if (recognizerContextRef.lastPositions.lastSentPosition === recognizerContextRef.lastPositions.lastReceivedPosition === -1) {\n    delete recognizerContextRef.instanceId;\n  }\n  return recognizerContextRef;\n}\n\n/**\n * Set the recognition context\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {RecognitionContext} recognitionContext\n * @return {RecognizerContext}\n */\nexport function setRecognitionContext(recognizerContext, recognitionContext) {\n  const recognizerContextRef = recognizerContext;\n  recognizerContextRef.recognitionContexts[0] = recognitionContext;\n  return recognizerContextRef;\n}\n\n\n/**\n * Test if it is possible to reconnect\n * @param {RecognizerContext} recognizerContext\n * @return {Boolean} True if possible, false otherwise\n */\nexport function canReconnect(recognizerContext) {\n  return recognizerContext.websocket.autoReconnect === true && recognizerContext.currentReconnectionCount <= recognizerContext.websocket.maxRetryCount;\n}\n\n/**\n * Test if it should attempt immediate reconnect\n * @param {RecognizerContext} recognizerContext\n * @return {Boolean} True if should attempt reconnect, false otherwise\n */\nexport function shouldAttemptImmediateReconnect(recognizerContext) {\n  const recognizerContextRef = recognizerContext;\n  return recognizerContextRef.websocket.autoReconnect === true && recognizerContextRef.currentReconnectionCount++ <= recognizerContextRef.websocket.maxRetryCount;\n}\n\n/**\n * Lost connection message\n * @type {{type: string}}\n */\nexport const LOST_CONNEXION_MESSAGE = { type: 'LOST_CONNECTION' };\n\n/**\n * Explicit close message\n * @type {String}\n */\nexport const CLOSE_RECOGNIZER_MESSAGE = 'CLOSE_RECOGNIZER';\n\n","import { recognizerLogger as logger } from '../../../configuration/LoggerConfig';\nimport * as NetworkInterface from '../networkInterface';\nimport * as InkModel from '../../../model/InkModel';\nimport * as RecognizerContext from '../../../model/RecognizerContext';\n\n/**\n * @param {String} suffixUrl\n * @param {RecognizerContext} recognizerContext\n * @param {Model} model\n * @param {function(recognizerContext: RecognizerContext, model: Model): Object} buildMessage\n * @return {Promise.<Model>} Promise that return an updated model as a result\n */\nexport function postMessage(suffixUrl, recognizerContext, model, buildMessage) {\n  const configuration = recognizerContext.editor.configuration;\n  return NetworkInterface.post(recognizerContext, `${configuration.recognitionParams.server.scheme}://${configuration.recognitionParams.server.host}${suffixUrl}`, buildMessage(recognizerContext, model), 'V3')\n    .then(\n      (response) => {\n        logger.debug('Cdkv3RestRecognizer success', response);\n        const positions = recognizerContext.lastPositions;\n        positions.lastReceivedPosition = positions.lastSentPosition;\n        const recognizerContextReference = RecognizerContext.updateRecognitionPositions(recognizerContext, positions);\n        if (response.instanceId) {\n          recognizerContextReference.instanceId = response.instanceId;\n        }\n        return response;\n      }\n    );\n}\n","/**\n * Extract the exports\n * @param {Model} model Current model\n * @return {Object} exports\n */\nexport function extractExports(model) {\n  // We recopy the recognized strokes to flag them as toBeRemove if they are scratched out or map with a symbol\n  if (model.rawResults &&\n    model.rawResults.exports &&\n    model.rawResults.exports.result &&\n    model.rawResults.exports.result.textSegmentResult &&\n    model.rawResults.exports.result.textSegmentResult.candidates) {\n    return {\n      CANDIDATES: model.rawResults.exports.result,\n      TEXT: model.rawResults.exports.result.textSegmentResult.candidates[model.rawResults.exports.result.textSegmentResult.selectedCandidateIdx].label\n    };\n  }\n  return {};\n}\n","import { recognizerLogger as logger } from '../configuration/LoggerConfig';\nimport * as InkModel from '../model/InkModel';\nimport * as RecognizerContext from '../model/RecognizerContext';\nimport Constants from '../configuration/Constants';\n\n/**\n * Triggers\n * @typedef {Object} Triggers\n * @property {Array<String>} exportContent Supported triggers for exporting content.\n * @property {Array<String>} [addStrokes] Supported triggers for adding strokes.\n */\n\n/**\n * Recognizer info\n * @typedef {Object} RecognizerInfo\n * @property {Array<String>} types Supported recognition types (TEXT, MATH, SHAPE, MUSIC, ANALYZER).\n * @property {String} protocol Supported protocol (REST, WEBSOCKET).\n * @property {String} apiVersion Supported API version.\n * @property {Triggers} availableTriggers Supported triggers for this recognizer.\n */\n\n/**\n * Recognizer callback\n * @typedef {function} RecognizerCallback\n * @param {Object} [err] Error\n * @param {Model} [model] Result\n * @param {...String} [types] Result types\n */\n\n/**\n * Simple callback\n * @typedef {function} Callback\n * @param {Object} [err] Error\n * @param {Object} [res] Result\n */\n\n/**\n * Recognition service entry point\n * @typedef {Object} Recognizer\n * @property {function(): RecognizerInfo} getInfo Get information about the supported configuration (protocol, type, apiVersion, ...).\n * @property {function(recognizerContext: RecognizerContext, model: Model, callback: RecognizerCallback)} init Initialize recognition.\n * @property {function(recognizerContext: RecognizerContext, model: Model, callback: RecognizerCallback)} clear Clear server context. Currently nothing to do there.\n * @property {function(recognizerContext: RecognizerContext, model: Model, callback: RecognizerCallback)} close Close and free all resources that will no longer be used by the recognizer.\n * @property {function(recognizerContext: RecognizerContext, model: Model, callback: RecognizerCallback)} [undo] Undo Undo the last done action.\n * @property {function(recognizerContext: RecognizerContext, model: Model, callback: RecognizerCallback)} [redo] Redo Redo the previously undone action.\n * @property {function(recognizerContext: RecognizerContext, model: Model, callback: RecognizerCallback, element: Element)} [resize] Resize.\n * @property {function(recognizerContext: RecognizerContext, model: Model, strokes: Array<Stroke>, callback: RecognizerCallback)} [pointerEvents] Pointer Events.\n * @property {function(recognizerContext: RecognizerContext, model: Model, callback: RecognizerCallback)} [addStrokes] Add strokes.\n * @property {function(recognizerContext: RecognizerContext, model: Model, callback: RecognizerCallback)} [export_] Export content.\n * @property {function(recognizerContext: RecognizerContext, model: Model, data: Blob, callback: RecognizerCallback)} [import_] Import content.\n * @property {function(recognizerContext: RecognizerContext, model: Model, callback: RecognizerCallback, conversionState: String)} [convert] Convert.\n * @property {function(recognizerContext: RecognizerContext, model: Model, callback: RecognizerCallback)} [waitForIdle] Wait for idle.\n * @property {function(recognizerContext: RecognizerContext, model: Model, penStyle: PenStyle, callback: RecognizerCallback)} [setPenStyle] Set pen style.\n * @property {function(recognizerContext: RecognizerContext, model: Model, penStyleClasses: String, callback: RecognizerCallback)} [setPenStyleClasses] Set pen style classes.\n * @property {function(recognizerContext: RecognizerContext, model: Model, theme: Theme, callback: RecognizerCallback)} [setTheme] Set theme.\n */\n\n/**\n * Initialize recognition\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function init(recognizerContext, model, callback) {\n  const modelRef = InkModel.resetModelPositions(model);\n  logger.debug('Updated model', modelRef);\n  const recognizerContextRef = RecognizerContext.updateRecognitionPositions(recognizerContext, modelRef.lastPositions);\n  recognizerContextRef.initPromise = Promise.resolve(modelRef);\n  recognizerContextRef.initPromise\n    .then((res) => {\n      recognizerContextRef.initialized = true;\n      logger.debug('Updated recognizer context', recognizerContextRef);\n      callback(undefined, res, Constants.EventType.LOADED);\n    });\n}\n\n/**\n * Reset server context. Currently nothing to do there.\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function reset(recognizerContext, model, callback) {\n  const modelRef = InkModel.resetModelPositions(model);\n  logger.debug('Updated model', modelRef);\n  const recognizerContextRef = RecognizerContext.updateRecognitionPositions(recognizerContext, modelRef.lastPositions);\n  delete recognizerContextRef.instanceId;\n  logger.debug('Updated recognizer context', recognizerContextRef);\n  callback(undefined, modelRef);\n}\n\n/**\n * Clear server context. Currently nothing to do there.\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function clear(recognizerContext, model, callback) {\n  const modelRef = InkModel.clearModel(model);\n  logger.debug('Updated model', modelRef);\n  const recognizerContextRef = RecognizerContext.updateRecognitionPositions(recognizerContext, modelRef.lastPositions);\n  delete recognizerContextRef.instanceId;\n  logger.debug('Updated recognizer context', recognizerContextRef);\n  callback(undefined, modelRef, Constants.EventType.CHANGED, Constants.EventType.EXPORTED, Constants.EventType.RENDERED);\n}\n\n/**\n * Close and free all resources that will no longer be used by the recognizer.\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function close(recognizerContext, model, callback) {\n  const recognizerContextRef = recognizerContext;\n  recognizerContextRef.initialized = false;\n  delete recognizerContextRef.instanceId;\n  callback(undefined, model);\n}\n","/* eslint-disable no-underscore-dangle */\nimport { recognizerLogger as logger } from '../../../configuration/LoggerConfig';\nimport Constants from '../../../configuration/Constants';\nimport * as InkModel from '../../../model/InkModel';\nimport * as StrokeComponent from '../../../model/StrokeComponent';\nimport * as CryptoHelper from '../../CryptoHelper';\nimport * as Cdkv3RestRecognizerUtil from './Cdkv3RestRecognizerUtil';\nimport * as Cdkv3CommonTextRecognizer from '../../common/v3/Cdkv3CommonTextRecognizer';\n\nexport { init, close, clear, reset } from '../../DefaultRecognizer';\n\n/**\n * Recognizer configuration\n * @type {RecognizerInfo}\n */\nexport const textRestV3Configuration = {\n  types: [Constants.RecognitionType.TEXT],\n  protocol: Constants.Protocol.REST,\n  apiVersion: 'V3',\n  availableTriggers: {\n    exportContent: [\n      Constants.Trigger.QUIET_PERIOD,\n      Constants.Trigger.DEMAND\n    ]\n  }\n};\n\n/**\n * Get the configuration supported by this recognizer\n * @return {RecognizerInfo}\n */\nexport function getInfo() {\n  return textRestV3Configuration;\n}\n\n/**\n * Internal function to build the payload to ask for a recognition.\n * @param {RecognizerContext} recognizerContext\n * @param {Model} model\n * @return {Object}\n */\nexport function buildInput(recognizerContext, model) {\n  const configuration = recognizerContext.editor.configuration;\n  const input = {\n    inputUnits: [{\n      textInputType: 'MULTI_LINE_TEXT',\n      // As Rest TEXT recognition is non incremental wa add the already recognized strokes\n      components: model.rawStrokes.map(stroke => StrokeComponent.toJSON(stroke))\n    }]\n  };\n  Object.assign(input, { textParameter: configuration.recognitionParams.v3.textParameter }); // Building the input with the suitable parameters\n\n  logger.debug(`input.inputUnits[0].components size is ${input.inputUnits[0].components.length}`);\n\n  const data = {\n    instanceId: recognizerContext ? recognizerContext.instanceId : undefined,\n    applicationKey: configuration.recognitionParams.server.applicationKey,\n    textInput: JSON.stringify(input)\n  };\n\n  if (configuration.recognitionParams.server.hmacKey) {\n    data.hmac = CryptoHelper.computeHmac(data.textInput, configuration.recognitionParams.server.applicationKey, configuration.recognitionParams.server.hmacKey);\n  }\n  InkModel.updateModelSentPosition(model);\n  return data;\n}\n\nfunction resultCallback(model, res, callback) {\n  logger.debug('Cdkv3RestTextRecognizer result callback', model);\n  const modelReference = InkModel.updateModelReceivedPosition(model);\n  modelReference.rawResults.exports = res;\n  modelReference.exports = Cdkv3CommonTextRecognizer.extractExports(model);\n  logger.debug('Cdkv3RestTextRecognizer model updated', modelReference);\n  callback(undefined, modelReference, Constants.EventType.EXPORTED, Constants.EventType.IDLE);\n}\n\n/**\n * Export content\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function export_(recognizerContext, model, callback) {\n  Cdkv3RestRecognizerUtil.postMessage('/api/v3.0/recognition/rest/text/doSimpleRecognition.json', recognizerContext, model, buildInput)\n    .then(res => resultCallback(model, res, callback))\n    .catch(err => callback(err, model));\n}\n","import { recognizerLogger as logger } from '../../configuration/LoggerConfig';\n\n/**\n * Extract the exports\n * @param {Model} model Current model\n * @return {Object} Recognition result\n */\nexport function extractExports(model) {\n  if (model.rawResults &&\n      model.rawResults.exports &&\n      model.rawResults.exports.result &&\n      model.rawResults.exports.result.results &&\n      model.rawResults.exports.result.results.length > 0) {\n    return model.rawResults.exports.result.results\n      .map((item) => {\n        const res = {};\n        if (Object.keys(item).includes('root')) {\n          res[`${item.type}`] = item.root;\n        } else {\n          res[`${item.type}`] = item.value;\n        }\n        return res;\n      })\n      .reduce((a, b) => Object.assign(a, b), {});\n  }\n  return {};\n}\n","import { recognizerLogger as logger } from '../../../configuration/LoggerConfig';\n\n/**\n * Extract the recognized symbols\n * @param {Model} model Current model\n * @return {Array<Object>} Recognized symbols\n */\nexport function extractRecognizedSymbols(model) {\n  // We recopy the recognized strokes to flag them as toBeRemove if they are scratched out or map with a symbol\n  const strokeList = [...model.rawStrokes];\n\n  if (model.rawResults &&\n      model.rawResults.exports &&\n      model.rawResults.exports.result &&\n      model.rawResults.exports.result.scratchOutResults &&\n      (model.rawResults.exports.result.scratchOutResults.length > 0)) {\n    const inkRanges = model.rawResults.exports.result.scratchOutResults\n      .map(scratchOutResult => scratchOutResult.erasedInkRanges.concat(scratchOutResult.inkRanges))\n      .reduce((a, b) => a.concat(b));\n    return strokeList.filter((stroke, index) => !inkRanges.find(inkRange => inkRange.component === index));\n  }\n  return strokeList;\n}\n","/* eslint-disable no-underscore-dangle */\nimport { recognizerLogger as logger } from '../../../configuration/LoggerConfig';\nimport Constants from '../../../configuration/Constants';\nimport * as InkModel from '../../../model/InkModel';\nimport * as StrokeComponent from '../../../model/StrokeComponent';\nimport * as CryptoHelper from '../../CryptoHelper';\nimport * as CdkCommonUtil from '../../common/CdkCommonUtil';\nimport * as Cdkv3RestRecognizerUtil from './Cdkv3RestRecognizerUtil';\nimport * as Cdkv3CommonMathRecognizer from '../../common/v3/Cdkv3CommonMathRecognizer';\n\nexport { init, close, clear, reset } from '../../DefaultRecognizer';\n\n/**\n * Recognizer configuration\n * @type {RecognizerInfo}\n */\nexport const mathRestV3Configuration = {\n  types: [Constants.RecognitionType.MATH],\n  protocol: Constants.Protocol.REST,\n  apiVersion: 'V3',\n  availableTriggers: {\n    exportContent: [\n      Constants.Trigger.QUIET_PERIOD,\n      Constants.Trigger.DEMAND\n    ]\n  }\n};\n\n/**\n * Get the configuration supported by this recognizer\n * @return {RecognizerInfo}\n */\nexport function getInfo() {\n  return mathRestV3Configuration;\n}\n\n/**\n * Internal function to build the payload to ask for a recognition.\n * @param {RecognizerContext} recognizerContext\n * @param {Model} model\n * @return {Object}\n */\nfunction buildInput(recognizerContext, model) {\n  const configuration = recognizerContext.editor.configuration;\n  const input = {\n    // As Rest MATH recognition is non incremental we add the already recognized strokes\n    components: model.rawStrokes.map(stroke => StrokeComponent.toJSON(stroke))\n  };\n  Object.assign(input, configuration.recognitionParams.v3.mathParameter); // Building the input with the suitable parameters\n\n  logger.debug(`input.components size is ${input.components.length}`);\n\n  const data = {\n    instanceId: recognizerContext ? recognizerContext.instanceId : undefined,\n    applicationKey: configuration.recognitionParams.server.applicationKey,\n    mathInput: JSON.stringify(input)\n  };\n\n  if (configuration.recognitionParams.server.hmacKey) {\n    data.hmac = CryptoHelper.computeHmac(data.mathInput, configuration.recognitionParams.server.applicationKey, configuration.recognitionParams.server.hmacKey);\n  }\n  InkModel.updateModelSentPosition(model);\n  return data;\n}\n\nfunction resultCallback(model, res, callback) {\n  logger.debug('Cdkv3RestMathRecognizer result callback', model);\n  const modelReference = InkModel.updateModelReceivedPosition(model);\n  modelReference.rawResults.exports = res;\n  modelReference.recognizedSymbols = Cdkv3CommonMathRecognizer.extractRecognizedSymbols(model);\n  modelReference.exports = CdkCommonUtil.extractExports(model);\n  logger.debug('Cdkv3RestMathRecognizer model updated', modelReference);\n  callback(undefined, modelReference, Constants.EventType.EXPORTED, Constants.EventType.IDLE);\n}\n\n/**\n * Export content\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function export_(recognizerContext, model, callback) {\n  return Cdkv3RestRecognizerUtil.postMessage('/api/v3.0/recognition/rest/math/doSimpleRecognition.json', recognizerContext, model, buildInput)\n    .then(res => resultCallback(model, res, callback))\n    .catch(err => callback(err, model));\n}\n","import { recognizerLogger as logger } from '../../../configuration/LoggerConfig';\nimport * as InkModel from '../../../model/InkModel';\n\n/**\n * Get style for the strokes matching the ink ranges\n * @param {Model} model\n * @param {Array<Object>} inkRanges\n * @return {{color: String, width: Number}} Style to apply\n */\nexport function getStyleFromInkRanges(model, inkRanges) {\n  let strokes = model.rawStrokes;\n  if (inkRanges && (inkRanges.length > 0)) {\n    strokes = inkRanges\n      .map(inkRange => InkModel.extractStrokesFromInkRange(model, inkRange.stroke ? inkRange.stroke : inkRange.firstStroke, inkRange.stroke ? inkRange.stroke : inkRange.lastStroke, inkRange.firstPoint, inkRange.lastPoint))\n      .reduce((a, b) => a.concat(b));\n  }\n  // FIXME hack to apply the rendering param of the first element' stroke\n  return {\n    color: strokes[0].color,\n    width: strokes[0].width\n  };\n}\n\n/**\n * Extract recognized symbols from recognition output\n * @param {Model} model Current model\n * @param {Object} segment Shape recognition output\n * @return {Array<Object>} Recognized symbols\n */\nexport function extractShapeSymbols(model, segment) {\n  if (segment.candidates && segment.candidates.length > 0) {\n    const selectedCandidate = segment.candidates[segment.selectedCandidateIndex];\n    switch (selectedCandidate.type) {\n      case 'notRecognized':\n        if (segment.inkRanges && segment.inkRanges.length > 0) {\n          return segment.inkRanges\n            .map(inkRange => InkModel.extractStrokesFromInkRange(model, inkRange.firstStroke, inkRange.lastStroke, inkRange.firstPoint, inkRange.lastPoint))\n            .reduce((a, b) => a.concat(b));\n        }\n        return [];\n      case 'recognizedShape':\n        return selectedCandidate.primitives;\n      default:\n        return [];\n    }\n  }\n  return [];\n}\n\n/**\n * Extract the recognized symbols\n * @param {Model} model Current model\n * @return {Array<Object>} Recognized symbols\n */\nexport function extractRecognizedSymbols(model) {\n  if (model.rawResults &&\n      model.rawResults.exports &&\n      model.rawResults.exports.result &&\n      model.rawResults.exports.result.segments) {\n    return model.rawResults.exports.result.segments\n      .map((segment) => {\n        const style = getStyleFromInkRanges(model, segment.inkRanges);\n        return extractShapeSymbols(model, segment).map(primitive => Object.assign(primitive, style));\n      })\n      .reduce((a, b) => a.concat(b));\n  }\n  return [];\n}\n\n/**\n * Extract the exports\n * @param {Model} model Current model\n * @return {Object} exports\n */\nexport function extractExports(model) {\n  // We recopy the recognized strokes to flag them as toBeRemove if they are scratched out or map with a symbol\n  if (model.rawResults &&\n    model.rawResults.exports &&\n    model.rawResults.exports.result &&\n    model.rawResults.exports.result.segments) {\n    return {\n      SEGMENTS: model.rawResults.exports.result.segments\n    };\n  }\n  return {};\n}\n","/* eslint-disable no-underscore-dangle */\nimport { recognizerLogger as logger } from '../../../configuration/LoggerConfig';\nimport Constants from '../../../configuration/Constants';\nimport * as InkModel from '../../../model/InkModel';\nimport * as StrokeComponent from '../../../model/StrokeComponent';\nimport * as CryptoHelper from '../../CryptoHelper';\nimport * as Cdkv3RestRecognizerUtil from './Cdkv3RestRecognizerUtil';\nimport {\n  extractShapeSymbols,\n  getStyleFromInkRanges\n} from '../../common/v3/Cdkv3CommonShapeRecognizer';\n\nexport { init, close, clear, reset } from '../../DefaultRecognizer';\n\n/**\n * Recognizer configuration\n * @type {RecognizerInfo}\n */\nexport const analyzerRestV3Configuration = {\n  types: [Constants.RecognitionType.ANALYZER],\n  protocol: Constants.Protocol.REST,\n  apiVersion: 'V3',\n  availableTriggers: {\n    exportContent: [\n      Constants.Trigger.QUIET_PERIOD,\n      Constants.Trigger.DEMAND\n    ]\n  }\n};\n\n/**\n * Get the configuration supported by this recognizer\n * @return {RecognizerInfo}\n */\nexport function getInfo() {\n  return analyzerRestV3Configuration;\n}\n\n/**\n * Internal function to build the payload to ask for a recognition.\n * @param {RecognizerContext} recognizerContext\n * @param {Model} model\n * @return {Object}\n */\nfunction buildInput(recognizerContext, model) {\n  const configuration = recognizerContext.editor.configuration;\n  const input = {\n    // Incremental\n    components: model.rawStrokes.map(stroke => StrokeComponent.toJSON(stroke))\n  };\n  Object.assign(input, { parameter: configuration.recognitionParams.v3.analyzerParameter }); // Building the input with the suitable parameters\n\n  logger.debug(`input.components size is ${input.components.length}`);\n\n  const data = {\n    instanceId: recognizerContext ? recognizerContext.instanceId : undefined,\n    applicationKey: configuration.recognitionParams.server.applicationKey,\n    analyzerInput: JSON.stringify(input)\n  };\n\n  if (configuration.recognitionParams.server.hmacKey) {\n    data.hmac = CryptoHelper.computeHmac(data.analyzerInput, configuration.recognitionParams.server.applicationKey, configuration.recognitionParams.server.hmacKey);\n  }\n  InkModel.updateModelSentPosition(model);\n  return data;\n}\n\nfunction extractSymbols(model, element) {\n  const style = getStyleFromInkRanges(model, element.inkRanges);\n  switch (element.elementType) {\n    case 'table':\n      return element.lines.map(line => Object.assign(line, style));\n    case 'textLine':\n      return [element].map(textLine => Object.assign(textLine, textLine.result.textSegmentResult.candidates[textLine.result.textSegmentResult.selectedCandidateIdx], style));\n    case 'shape':\n      return extractShapeSymbols(model, element).map(primitive => Object.assign(primitive, style));\n    default:\n      return [];\n  }\n}\n\nfunction extractRecognizedSymbolsFromAnalyzerResult(model) {\n  if (model.rawResults &&\n      model.rawResults.exports &&\n      model.rawResults.exports.result) {\n    return [...model.rawResults.exports.result.shapes, ...model.rawResults.exports.result.tables, ...model.rawResults.exports.result.textLines]\n      .map(element => extractSymbols(model, element))\n      .reduce((a, b) => a.concat(b));\n  }\n  return [];\n}\n\n/**\n * Extract the exports\n * @param {Model} model Current model\n * @return {Object} exports\n */\nfunction extractExports(model) {\n  if (model.rawResults &&\n    model.rawResults.exports &&\n    model.rawResults.exports.result) {\n    return {\n      ANALYSIS: model.rawResults.exports.result\n    };\n  }\n  return {};\n}\n\nfunction resultCallback(model, res, callback) {\n  logger.debug('Cdkv3RestAnalyzerRecognizer result callback', model);\n  const modelReference = InkModel.updateModelReceivedPosition(model);\n  modelReference.rawResults.exports = res;\n  modelReference.recognizedSymbols = extractRecognizedSymbolsFromAnalyzerResult(model);\n  modelReference.exports = extractExports(model);\n  logger.debug('Cdkv3RestAnalyzerRecognizer model updated', modelReference);\n  callback(undefined, modelReference, Constants.EventType.EXPORTED, Constants.EventType.CONVERTED, Constants.EventType.IDLE);\n}\n\n/**\n * Export content\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function export_(recognizerContext, model, callback) {\n  return Cdkv3RestRecognizerUtil.postMessage('/api/v3.0/recognition/rest/analyzer/doSimpleRecognition.json', recognizerContext, model, buildInput)\n    .then(res => resultCallback(model, res, callback))\n    .catch(err => callback(err, model));\n}\n","/* eslint-disable no-underscore-dangle */\nimport { recognizerLogger as logger } from '../../../configuration/LoggerConfig';\nimport Constants from '../../../configuration/Constants';\nimport * as InkModel from '../../../model/InkModel';\nimport * as StrokeComponent from '../../../model/StrokeComponent';\nimport * as CryptoHelper from '../../CryptoHelper';\nimport * as RecognizerContext from '../../../model/RecognizerContext';\nimport * as Cdkv3RestRecognizerUtil from './Cdkv3RestRecognizerUtil';\nimport * as Cdkv3CommonShapeRecognizer from '../../common/v3/Cdkv3CommonShapeRecognizer';\n\nexport { init, close } from '../../DefaultRecognizer';\n\n/**\n * Recognizer configuration\n * @type {RecognizerInfo}\n */\nexport const shapeRestV3Configuration = {\n  types: [Constants.RecognitionType.SHAPE],\n  protocol: Constants.Protocol.REST,\n  apiVersion: 'V3',\n  availableTriggers: {\n    exportContent: [\n      Constants.Trigger.QUIET_PERIOD,\n      Constants.Trigger.DEMAND\n    ]\n  }\n};\n\n/**\n * Get the configuration supported by this recognizer\n * @return {RecognizerInfo}\n */\nexport function getInfo() {\n  return shapeRestV3Configuration;\n}\n\n/**\n * Internal function to build the payload to ask for a recognition.\n * @param {RecognizerContext} recognizerContext\n * @param {Model} model\n * @return {Object}\n */\nfunction buildInput(recognizerContext, model) {\n  const configuration = recognizerContext.editor.configuration;\n  const input = {\n    components: InkModel.extractPendingStrokes(model).map(stroke => StrokeComponent.toJSON(stroke))\n  };\n  Object.assign(input, configuration.recognitionParams.v3.shapeParameter); // Building the input with the suitable parameters\n\n  logger.debug(`input.components size is ${input.components.length}`);\n\n  const data = {\n    instanceId: recognizerContext ? recognizerContext.instanceId : undefined,\n    applicationKey: configuration.recognitionParams.server.applicationKey,\n    shapeInput: JSON.stringify(input)\n  };\n\n  if (configuration.recognitionParams.server.hmacKey) {\n    data.hmac = CryptoHelper.computeHmac(data.shapeInput, configuration.recognitionParams.server.applicationKey, configuration.recognitionParams.server.hmacKey);\n  }\n  InkModel.updateModelSentPosition(model);\n  return data;\n}\n\nfunction buildReset(recognizerContext, model) {\n  return {\n    instanceSessionId: recognizerContext ? recognizerContext.instanceId : undefined\n  };\n}\n\nfunction resultCallback(model, res, callback) {\n  logger.debug('Cdkv3RestShapeRecognizer result callback', model);\n  const modelReference = InkModel.updateModelReceivedPosition(model);\n  modelReference.rawResults.exports = res;\n  modelReference.recognizedSymbols = Cdkv3CommonShapeRecognizer.extractRecognizedSymbols(model);\n  modelReference.exports = Cdkv3CommonShapeRecognizer.extractExports(model);\n  logger.debug('Cdkv3RestShapeRecognizer model updated', modelReference);\n  callback(undefined, modelReference, Constants.EventType.EXPORTED, Constants.EventType.CONVERTED, Constants.EventType.IDLE);\n}\n\n/**\n * Export content\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function export_(recognizerContext, model, callback) {\n  Cdkv3RestRecognizerUtil.postMessage('/api/v3.0/recognition/rest/shape/doSimpleRecognition.json', recognizerContext, model, buildInput)\n    .then(res => resultCallback(model, res, callback))\n    .catch(err => callback(err, model));\n}\n\n/**\n * Reset server context.\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function reset(recognizerContext, model, callback) {\n  const modelRef = InkModel.resetModelPositions(model);\n  Cdkv3RestRecognizerUtil.postMessage('/api/v3.0/recognition/rest/shape/clearSessionId.json', recognizerContext, modelRef, buildReset)\n    .then(res => callback(undefined, modelRef, Constants.EventType.IDLE))\n    .catch(err => callback(err, modelRef));\n}\n\n/**\n * Do what is needed to clean the server context.\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function clear(recognizerContext, model, callback) {\n  const modelRef = InkModel.clearModel(InkModel.cloneModel(model));\n  Cdkv3RestRecognizerUtil.postMessage('/api/v3.0/recognition/rest/shape/clearSessionId.json', recognizerContext, modelRef, buildReset)\n    .then(res => callback(undefined, modelRef, Constants.EventType.CHANGED, Constants.EventType.EXPORTED, Constants.EventType.CONVERTED, Constants.EventType.IDLE))\n    .catch(err => callback(err, modelRef));\n}\n","/* eslint-disable no-underscore-dangle */\nimport { recognizerLogger as logger } from '../../../configuration/LoggerConfig';\nimport Constants from '../../../configuration/Constants';\nimport * as InkModel from '../../../model/InkModel';\nimport * as RecognizerContext from '../../../model/RecognizerContext';\nimport * as StrokeComponent from '../../../model/StrokeComponent';\nimport * as CryptoHelper from '../../CryptoHelper';\nimport * as CdkCommonUtil from '../../common/CdkCommonUtil';\nimport * as Cdkv3RestRecognizerUtil from './Cdkv3RestRecognizerUtil';\n\nexport { close, clear, reset } from '../../DefaultRecognizer';\n\n/**\n * Recognizer configuration\n * @type {RecognizerInfo}\n */\nexport const musicRestV3Configuration = {\n  types: [Constants.RecognitionType.MUSIC],\n  protocol: Constants.Protocol.REST,\n  apiVersion: 'V3',\n  availableTriggers: {\n    exportContent: [\n      Constants.Trigger.QUIET_PERIOD,\n      Constants.Trigger.DEMAND\n    ]\n  }\n};\n\n/**\n * Get the configuration supported by this recognizer\n * @return {RecognizerInfo}\n */\nexport function getInfo() {\n  return musicRestV3Configuration;\n}\n\n/**\n * Internal function to build the payload to ask for a recognition.\n * @param {RecognizerContext} recognizerContext\n * @param {Model} model\n * @return {Object}\n */\nfunction buildInput(recognizerContext, model) {\n  const configuration = recognizerContext.editor.configuration;\n  const input = {\n    // As Rest MUSIC recognition is non incremental wa add the already recognized strokes\n    components: []\n      .concat(model.defaultSymbols, model.rawStrokes)\n      .filter(symbol => symbol.type !== 'staff')\n      .map((symbol) => {\n        if (symbol.type === 'stroke') {\n          return StrokeComponent.toJSON(symbol);\n        }\n        return symbol;\n      })\n  };\n  const musicParameter = Object.assign({}, configuration.recognitionParams.v3.musicParameter);\n  delete musicParameter.clef; // FIXME find a way to avoid this ugly hack\n  Object.assign(input, musicParameter); // Building the input with the suitable parameters\n\n  logger.debug(`input.components size is ${input.components.length}`);\n\n  const data = {\n    instanceId: recognizerContext ? recognizerContext.instanceId : undefined,\n    applicationKey: configuration.recognitionParams.server.applicationKey,\n    musicInput: JSON.stringify(input)\n  };\n\n  if (configuration.recognitionParams.server.hmacKey) {\n    data.hmac = CryptoHelper.computeHmac(data.musicInput, configuration.recognitionParams.server.applicationKey, configuration.recognitionParams.server.hmacKey);\n  }\n  InkModel.updateModelSentPosition(model);\n  return data;\n}\n\nfunction resultCallback(model, res, callback) {\n  logger.debug('Cdkv3RestMusicRecognizer result callback', model);\n  const modelReference = InkModel.updateModelReceivedPosition(model);\n  modelReference.rawResults.exports = res;\n  modelReference.exports = CdkCommonUtil.extractExports(model);\n  logger.debug('Cdkv3RestMusicRecognizer model updated', modelReference);\n  callback(undefined, modelReference, Constants.EventType.EXPORTED, Constants.EventType.IDLE);\n}\n\n/**\n * Initialize recognition\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function init(recognizerContext, model, callback) {\n  const modelRef = InkModel.resetModelPositions(model);\n  logger.debug('Updated model', modelRef);\n  const recognizerContextRef = RecognizerContext.updateRecognitionPositions(recognizerContext, modelRef.lastPositions);\n  recognizerContextRef.initPromise = Promise.resolve(modelRef);\n  recognizerContextRef.initPromise\n    .then((res) => {\n      recognizerContextRef.initialized = true;\n      logger.debug('Updated recognizer context', recognizerContextRef);\n      callback(undefined, res, Constants.EventType.LOADED, Constants.EventType.RENDERED);\n    });\n}\n\n/**\n * Export content\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function export_(recognizerContext, model, callback) {\n  Cdkv3RestRecognizerUtil.postMessage('/api/v3.0/recognition/rest/music/doSimpleRecognition.json', recognizerContext, model, buildInput)\n    .then(res => resultCallback(model, res, callback))\n    .catch(err => callback(err, model));\n}\n","/* eslint-disable no-underscore-dangle */\nimport * as NetworkInterface from '../networkInterface';\nimport * as RecognizerContext from '../../../model/RecognizerContext';\nimport { recognizerLogger as logger } from '../../../configuration/LoggerConfig';\nimport Constants from '../../../configuration/Constants';\nimport * as InkModel from '../../../model/InkModel';\nimport * as StrokeComponent from '../../../model/StrokeComponent';\nimport * as DefaultTheme from '../../../configuration/DefaultTheme';\nimport * as DefaultPenStyle from '../../../configuration/DefaultPenStyle';\n\nexport { init, close, clear, reset } from '../../DefaultRecognizer';\n\n/**\n * Recognizer configuration\n * @type {RecognizerInfo}\n */\nexport const iinkRestConfiguration = {\n  types: [Constants.RecognitionType.TEXT, Constants.RecognitionType.DIAGRAM, Constants.RecognitionType.MATH, Constants.RecognitionType.RAWCONTENT],\n  protocol: Constants.Protocol.REST,\n  apiVersion: 'V4',\n  availableTriggers: {\n    exportContent: [\n      Constants.Trigger.QUIET_PERIOD,\n      Constants.Trigger.DEMAND\n    ]\n  }\n};\n\n/**\n * Get the configuration supported by this recognizer\n * @return {RecognizerInfo}\n */\nexport function getInfo() {\n  return iinkRestConfiguration;\n}\n\n\n/**\n * @param {String} suffixUrl\n * @param {RecognizerContext} recognizerContext\n * @param {Model} model\n * @param {function(recognizerContext: RecognizerContext, model: Model, conversionState: String): Object} buildMessage\n * @param {String} conversionState\n * @param {String} mimeType\n * @return {Promise.<Model>} Promise that return an updated model as a result\n */\nexport function postMessage(suffixUrl, recognizerContext, model, buildMessage, conversionState = '', mimeType) {\n  const configuration = recognizerContext.editor.configuration;\n  return NetworkInterface.post(recognizerContext, `${configuration.recognitionParams.server.scheme}://${configuration.recognitionParams.server.host}${suffixUrl}`, buildMessage(recognizerContext, model, conversionState), 'V4', mimeType)\n    .then((response) => {\n      logger.debug('iinkRestRecognizer success', response);\n      const positions = recognizerContext.lastPositions;\n      positions.lastReceivedPosition = positions.lastSentPosition;\n      const recognizerContextReference = RecognizerContext.updateRecognitionPositions(recognizerContext, positions);\n      if (response.instanceId) {\n        recognizerContextReference.instanceId = response.instanceId;\n      }\n      return response;\n    });\n}\n\nfunction buildTextConf(configuration) {\n  return {\n    text: configuration.recognitionParams.v4.text,\n    lang: configuration.recognitionParams.v4.lang,\n    export: configuration.recognitionParams.v4.export\n  };\n}\n\nfunction buildMathConf(configuration) {\n  return {\n    math: configuration.recognitionParams.v4.math,\n    lang: configuration.recognitionParams.v4.lang,\n    export: configuration.recognitionParams.v4.export\n  };\n}\n\nfunction buildDiagramConf(configuration) {\n  return {\n    diagram: configuration.recognitionParams.v4.diagram,\n    lang: configuration.recognitionParams.v4.lang,\n    export: configuration.recognitionParams.v4.export\n  };\n}\n\nfunction buildRawContentConf(configuration) {\n  return {\n    'raw-content': {\n      recognition: configuration.recognitionParams.v4['raw-content'].recognition\n    },\n    lang: configuration.recognitionParams.v4.lang,\n    export: configuration.recognitionParams.v4.export\n  };\n}\n\nfunction buildData(recognizerContext, model, conversionState) {\n  const configuration = recognizerContext.editor.configuration;\n  let dataConf;\n\n  if (configuration.recognitionParams.type === 'TEXT') {\n    dataConf = buildTextConf(configuration);\n  } else if (configuration.recognitionParams.type === 'MATH') {\n    dataConf = buildMathConf(configuration);\n  } else if (configuration.recognitionParams.type === 'DIAGRAM') {\n    dataConf = buildDiagramConf(configuration);\n  } else if (configuration.recognitionParams.type === 'Raw Content') {\n    dataConf = buildRawContentConf(configuration);\n  }\n\n  const newStrokes = [];\n  model.strokeGroups.forEach((group) => {\n    const newPenStyle = JSON.stringify(group.penStyle) === '{}' ? null : DefaultPenStyle.toCSS(group.penStyle);\n    const newGroup = {\n      penStyle: newPenStyle,\n      strokes: group.strokes.map(stroke => StrokeComponent.toJSONV4(stroke))\n    };\n    newStrokes.push(newGroup);\n  });\n\n  const contentType = configuration.recognitionParams.type === 'Raw Content' ? 'Raw Content' : configuration.recognitionParams.type.charAt(0)\n    .toUpperCase() + configuration.recognitionParams.type.slice(1)\n    .toLowerCase();\n\n  const data = {\n    configuration: dataConf,\n    xDPI: 96,\n    yDPI: 96,\n    contentType,\n    theme: DefaultTheme.toCSS(recognizerContext.editor.theme),\n    strokeGroups: newStrokes\n  };\n\n  if (recognizerContext.editor.domElement) {\n    data.height = recognizerContext.editor.domElement.clientHeight;\n    data.width = recognizerContext.editor.domElement.clientWidth;\n  }\n\n  if (conversionState) {\n    data.conversionState = 'DIGITAL_EDIT';\n  }\n\n  InkModel.updateModelSentPosition(model);\n  return data;\n}\n\nfunction extractExports(configuration, mimeType, res) {\n  const exports = {};\n  exports[mimeType] = res;\n  return exports;\n}\n\nfunction resultCallback(model, configuration, res, mimeType, callback) {\n  logger.debug('iinkRestRecognizer result callback', model);\n  const modelReference = InkModel.updateModelReceivedPosition(model);\n  modelReference.rawResults.exports = res;\n  if (modelReference.exports) {\n    Object.assign(modelReference.exports, extractExports(configuration, mimeType, res));\n  } else {\n    modelReference.exports = extractExports(configuration, mimeType, res);\n  }\n  logger.debug('iinkRestRecognizer model updated', modelReference);\n  callback(undefined, modelReference, Constants.EventType.EXPORTED, Constants.EventType.IDLE);\n}\n\n/**\n * Export content\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n * @param {Array[String]} requestedMimeTypes\n */\nexport function export_(recognizerContext, model, callback, requestedMimeTypes) {\n  const configuration = recognizerContext.editor.configuration;\n\n  function callPostMessage(mimeType) {\n    postMessage('/api/v4.0/iink/batch', recognizerContext, model, buildData, configuration.restConversionState, mimeType)\n      .then((res) => {\n        resultCallback(model, configuration, res, mimeType, callback);\n      })\n      .catch((err) => {\n        callback(err, model);\n      });\n  }\n\n  if (requestedMimeTypes) {\n    requestedMimeTypes.forEach((mimeType) => {\n      callPostMessage(mimeType);\n    });\n  } else if (configuration.recognitionParams.type === 'TEXT') {\n    configuration.recognitionParams.v4.text.mimeTypes.forEach((mimeType) => {\n      callPostMessage(mimeType);\n    });\n  } else if (configuration.recognitionParams.type === 'DIAGRAM') {\n    configuration.recognitionParams.v4.diagram.mimeTypes.forEach((mimeType) => {\n      callPostMessage(mimeType);\n    });\n  } else if (configuration.recognitionParams.type === 'MATH') {\n    configuration.recognitionParams.v4.math.mimeTypes.forEach((mimeType) => {\n      callPostMessage(mimeType);\n    });\n  } else if (configuration.recognitionParams.type === 'Raw Content') {\n    configuration.recognitionParams.v4['raw-content'].mimeTypes.forEach((mimeType) => {\n      callPostMessage(mimeType);\n    });\n  }\n}\n\n/**\n * Ask for conversion using DIGITAL_EDIT\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function convert(recognizerContext, model, callback) {\n  const configuration = recognizerContext.editor.configuration;\n  postMessage('/api/v4.0/iink/batch', recognizerContext, model, buildData, 'DIGITAL_EDIT')\n    .then(res => resultCallback(model, configuration, res, callback))\n    .catch(err => callback(err, model));\n}\n","import { recognizerLogger as logger } from '../../configuration/LoggerConfig';\nimport * as RecognizerContext from '../../model/RecognizerContext';\n\nfunction infinitePing(websocket) {\n  const websocketRef = websocket;\n  websocketRef.pingLostCount++;\n  if (websocketRef.pingLostCount > websocketRef.maxPingLost) {\n    websocket.close(1000, 'PING_LOST');\n  } else if (websocketRef.readyState <= 1) {\n    setTimeout(() => {\n      if (websocketRef.readyState <= 1) {\n        websocketRef.send(JSON.stringify({ type: 'ping' }));\n        infinitePing(websocketRef);\n      }\n    }, websocketRef.pingDelay);\n  }\n}\n\n/**\n * Attach all socket attributes helping managing server connexion\n * @param {WebSocket} websocket Current WebSocket\n * @param {RecognizerContext} recognizerContext\n */\nfunction addWebsocketAttributes(websocket, recognizerContext) {\n  const websocketConfiguration = recognizerContext.editor.configuration.recognitionParams.server.websocket;\n  const socket = websocket;\n  socket.start = new Date();\n  socket.autoReconnect = websocketConfiguration.autoReconnect;\n  socket.maxRetryCount = websocketConfiguration.maxRetryCount;\n  socket.pingEnabled = websocketConfiguration.pingEnabled;\n  socket.pingDelay = websocketConfiguration.pingDelay;\n  socket.maxPingLost = websocketConfiguration.maxPingLostCount;\n  socket.pingLostCount = 0;\n  socket.recognizerContext = recognizerContext;\n}\n\n/**\n * @param {RecognizerContext} recognizerContext Recognizer context\n * @return {WebSocket} Opened WebSocket\n */\nexport function openWebSocket(recognizerContext) {\n  let socket;\n  try {\n    // eslint-disable-next-line no-undef\n    socket = new WebSocket(recognizerContext.url);\n  } catch (error) {\n    logger.error('Unable to open websocket, Check the host and your connectivity');\n  }\n  addWebsocketAttributes(socket, recognizerContext);\n  if (socket.pingEnabled) {\n    infinitePing(socket);\n  }\n\n  socket.onopen = (e) => {\n    logger.trace('onOpen');\n    recognizerContext.websocketCallback(e);\n  };\n\n  socket.onclose = (e) => {\n    logger.trace('onClose', new Date() - socket.start);\n    recognizerContext.websocketCallback(e);\n  };\n\n  socket.onerror = (e) => {\n    logger.trace('onError');\n    recognizerContext.websocketCallback(e);\n  };\n\n  socket.onmessage = (e) => {\n    logger.trace('onMessage');\n    socket.pingLostCount = 0;\n    const parsedMessage = JSON.parse(e.data);\n    if (parsedMessage.type !== 'pong') {\n      const callBackParam = {\n        type: e.type,\n        data: JSON.parse(e.data)\n      };\n      recognizerContext.websocketCallback(callBackParam);\n    }\n  };\n\n  return socket;\n}\n\n/**\n * Send data message\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Object} message Data message\n */\nexport function send(recognizerContext, message) {\n  const recognizerContextRef = recognizerContext;\n  recognizerContextRef.idle = false;\n\n  const websocket = recognizerContextRef.websocket;\n  if (websocket.readyState <= 1) {\n    websocket.send(JSON.stringify(message));\n    logger.debug(`${message.type} message sent`, message);\n  } else {\n    throw RecognizerContext.LOST_CONNEXION_MESSAGE;\n  }\n}\n\n/**\n * Close the websocket\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Number} code Exit code\n * @param {String} reason Exit reason\n */\nexport function close(recognizerContext, code, reason) {\n  const websocket = recognizerContext.websocket;\n  if (websocket && websocket.readyState < 2) {\n    websocket.close(code, reason);\n  }\n}\n","import { recognizerLogger as logger } from '../../../configuration/LoggerConfig';\nimport * as CryptoHelper from '../../CryptoHelper';\nimport * as NetworkWSInterface from '../networkWSInterface';\nimport * as RecognizerContext from '../../../model/RecognizerContext';\nimport Constants from '../../../configuration/Constants';\n\n/**\n * A CDK v3 websocket dialog have this sequence :\n * ---------- Client ------------------------------------- Server ----------------------------------\n * init (send the applicationKey) ================>\n *                                       <=========== hmacChallenge\n * answerToHmacChallenge (send the hmac) =========>\n *                                       <=========== init\n * start (send the parameters and first strokes ) ===============>\n *                                       <=========== recognition with instance id\n * continue (send the other strokes ) ============>\n *                                       <=========== recognition\n */\n\nfunction buildHmacMessage(configuration, message) {\n  return {\n    type: 'hmac',\n    applicationKey: configuration.recognitionParams.server.applicationKey,\n    challenge: message.data.challenge,\n    hmac: CryptoHelper.computeHmac(message.data.challenge, configuration.recognitionParams.server.applicationKey, configuration.recognitionParams.server.hmacKey)\n  };\n}\n\nfunction buildInitMessage(configuration) {\n  return {\n    type: 'applicationKey',\n    applicationKey: configuration.recognitionParams.server.applicationKey\n  };\n}\n\n/**\n * This function bind the right behaviour when a message is receive by the websocket.\n * @param {DestructuredPromise} destructuredPromise\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @return {function} Callback to handle WebSocket results\n */\nexport function buildWebSocketCallback(destructuredPromise, recognizerContext) {\n  return (message) => {\n    const recognizerContextRef = recognizerContext;\n    // Handle websocket messages\n    logger.trace(`${message.type} websocket callback`, message);\n    const recognitionContext = recognizerContext.recognitionContexts[recognizerContext.recognitionContexts.length - 1];\n    logger.debug('Current recognition context', recognitionContext);\n\n    switch (message.type) {\n      case 'open' :\n        NetworkWSInterface.send(recognizerContext, buildInitMessage(recognizerContext.editor.configuration));\n        break;\n      case 'message' :\n        logger.trace('Receiving message', message.data.type);\n        switch (message.data.type) {\n          case 'hmacChallenge' :\n            NetworkWSInterface.send(recognizerContext, buildHmacMessage(recognizerContext.editor.configuration, message));\n            break;\n          case 'init' :\n            recognizerContextRef.currentReconnectionCount = 0;\n            recognizerContextRef.idle = true;\n            recognizerContextRef.initialized = true;\n            recognitionContext.callback(undefined, message.data);\n            destructuredPromise.resolve(recognitionContext);\n            break;\n          case 'reset' :\n            recognizerContextRef.idle = true;\n            recognitionContext.callback(undefined, message.data);\n            break;\n          case 'mathResult' :\n          case 'textResult' :\n            recognizerContextRef.idle = true;\n            if (message.data.instanceId) {\n              if (recognizerContext.instanceId && recognizerContext.instanceId !== message.data.instanceId) {\n                logger.debug(`Instance id switch from ${recognizerContext.instanceId} to ${message.data.instanceId} this is suspicious`);\n              }\n              recognizerContextRef.instanceId = message.data.instanceId;\n              logger.debug('Memorizing instance id', message.data.instanceId);\n            }\n            recognitionContext.callback(undefined, message.data);\n            break;\n          case 'error' :\n            logger.debug('Error detected stopping all recognition', message);\n            if (recognitionContext) {\n              recognitionContext.callback(message.data);\n            } else {\n              destructuredPromise.reject(Object.assign({}, message.data, { recoverable: false }));\n            }\n            break;\n          default :\n            logger.warn('This is something unexpected in current recognizer. Not the type of message we should have here.', message);\n        }\n        break;\n      case 'error' :\n        logger.debug('Error detected stopping all recognition', message);\n        if (recognitionContext) {\n          recognitionContext.callback(Object.assign({}, message, { recoverable: false }));\n        } else {\n          destructuredPromise.reject(Object.assign({}, message, { recoverable: false }));\n        }\n        break;\n      case 'close' :\n        logger.debug('Close detected stopping all recognition', message);\n        recognizerContextRef.initialized = false;\n        if (recognitionContext) {\n          recognitionContext.callback(undefined, message);\n        } else {\n          destructuredPromise.reject(message);\n        }\n        break;\n      default :\n        logger.warn('This is something unexpected in current recognizer. Not the type of message we should have here.', message);\n    }\n  };\n}\n","import { recognizerLogger as logger } from '../../configuration/LoggerConfig';\nimport Constants from '../../configuration/Constants';\nimport * as NetworkWSInterface from './networkWSInterface';\nimport * as PromiseHelper from '../../util/PromiseHelper';\nimport * as InkModel from '../../model/InkModel';\nimport * as RecognizerContext from '../../model/RecognizerContext';\n\nfunction buildUrl(configuration, suffixUrl) {\n  const scheme = (configuration.recognitionParams.server.scheme === 'https') ? 'wss' : 'ws';\n  return `${scheme}://${configuration.recognitionParams.server.host}${suffixUrl}`;\n}\n\nconst commonCallback = (model, err, res, callback) => {\n  if (res && res.type === 'close') {\n    return callback(err, model, Constants.EventType.CHANGED);\n  }\n  return callback(err, model);\n};\n\n/**\n * Build websocket function\n * @typedef {function} BuildWebSocketFunction\n * @param {DestructuredPromise} destructuredPromise\n * @param {RecognizerContext} recognizerContext\n * @return {Callback}\n */\n\n/**\n * Init the websocket recognizer.\n * Open the connexion and proceed to the hmac challenge.\n * @param {String} suffixUrl\n * @param {RecognizerContext} recognizerContext\n * @param {BuildWebSocketFunction} buildWebSocketCallback\n * @param {function(recognizerContext: RecognizerContext, model: Model, callback: RecognizerCallback)} reconnect\n * @return {Promise} Fulfilled when the init phase is over.\n */\nexport function init(suffixUrl, recognizerContext, buildWebSocketCallback, reconnect) {\n  const recognitionContext = recognizerContext.recognitionContexts[0];\n  const recognizerContextReference = RecognizerContext.updateRecognitionPositions(recognizerContext, recognitionContext.model.lastPositions);\n  recognizerContextReference.url = buildUrl(recognizerContext.editor.configuration, suffixUrl);\n  recognizerContextReference.reconnect = reconnect;\n\n  const destructuredInitPromise = PromiseHelper.destructurePromise();\n  recognizerContextReference.initPromise = destructuredInitPromise.promise;\n\n  logger.debug('Opening the websocket for context ', recognizerContext);\n  recognizerContextReference.websocketCallback = buildWebSocketCallback(destructuredInitPromise, recognizerContextReference);\n  recognizerContextReference.websocket = NetworkWSInterface.openWebSocket(recognizerContextReference);\n  return recognizerContextReference.initPromise.then((res) => {\n    logger.debug('Init over', res);\n    return res;\n  });\n}\n\nexport function retry(func, recognizerContext, model, callback, ...params) {\n  if (RecognizerContext.shouldAttemptImmediateReconnect(recognizerContext) && recognizerContext.reconnect) {\n    logger.info('Attempting a retry', recognizerContext.currentReconnectionCount);\n    recognizerContext.reconnect(recognizerContext, model, (err, res) => {\n      if (!err) {\n        func(recognizerContext, res, callback, ...params);\n      } else {\n        logger.error('Failed retry', err);\n        retry(func, recognizerContext, model, callback, ...params);\n      }\n    });\n  } else {\n    callback('Unable to reconnect', model);\n  }\n}\n\n/**\n * @param {RecognizerContext} recognizerContext\n * @param {function(params: ...Object): Object} buildMessage\n * @param {...Object} params\n * @return {Promise}\n */\nexport function sendMessage(recognizerContext, buildMessage, ...params) {\n  return recognizerContext.initPromise\n    .then(() => {\n      logger.trace('Init was done. Sending message');\n      const message = buildMessage(...params);\n      if (message) {\n        NetworkWSInterface.send(recognizerContext, message);\n        const positions = recognizerContext.recognitionContexts[0].model.lastPositions;\n        if (positions) {\n          RecognizerContext.updateRecognitionPositions(recognizerContext, positions);\n        }\n      } else {\n        logger.warn('empty message');\n      }\n    });\n}\n\n/**\n * Do what is needed to clean the server context.\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function clear(recognizerContext, model, callback) {\n  const modelRef = InkModel.clearModel(model);\n  const recognizerContextReference = RecognizerContext.updateRecognitionPositions(recognizerContext, modelRef.lastPositions);\n  if (recognizerContextReference && recognizerContextReference.websocket) {\n    // We have to send again all strokes after a clear.\n    delete recognizerContextReference.instanceId;\n    try {\n      NetworkWSInterface.send(recognizerContextReference, { type: 'reset' });\n    } catch (sendFailedException) {\n      // To force failure without breaking the flow\n      // FIXME not working at all\n      recognizerContextReference.websocketCallback(PromiseHelper.destructurePromise(), recognizerContextReference, model);\n    }\n  }\n  // We do not keep track of the success of clear.\n  callback(undefined, modelRef);\n}\n\n/**\n * Close and free all resources that will no longer be used by the recognizer.\n * @param {RecognizerContext} recognizerContext\n * @param {Model} model\n * @param {RecognizerCallback} callback\n */\nexport function close(recognizerContext, model, callback) {\n  const recognitionContext = {\n    model,\n    callback: (err, res) => commonCallback(model, err, res, callback)\n  };\n  const recognizerContextRef = recognizerContext;\n\n  recognizerContext.initPromise\n    .then(() => {\n      recognizerContextRef.recognitionContexts[0] = recognitionContext;\n      return recognizerContextRef;\n    })\n    .then(context => NetworkWSInterface.close(context, 1000, RecognizerContext.CLOSE_RECOGNIZER_MESSAGE));\n}\n","/**\n * @typedef {Object} DestructuredPromise\n * @property {Promise} promise\n * @property {function(value: Object)} resolve\n * @property {function(reason: Object)} reject\n */\n\n/**\n * @return {DestructuredPromise}\n */\nexport function destructurePromise() {\n  let resolve;\n  let reject;\n  const initPromise = new Promise(\n    (resolveParam, rejectParam) => {\n      resolve = resolveParam;\n      reject = rejectParam;\n    });\n  return { promise: initPromise, resolve, reject };\n}\n","import { recognizerLogger as logger } from '../../../configuration/LoggerConfig';\nimport Constants from '../../../configuration/Constants';\nimport * as InkModel from '../../../model/InkModel';\nimport * as RecognizerContext from '../../../model/RecognizerContext';\nimport * as StrokeComponent from '../../../model/StrokeComponent';\nimport * as Cdkv3WSWebsocketBuilder from './Cdkv3WSBuilder';\nimport * as CdkWSRecognizerUtil from '../CdkWSRecognizerUtil';\nimport * as DefaultRecognizer from '../../DefaultRecognizer';\nimport * as CdkCommonUtil from '../../common/CdkCommonUtil';\nimport * as Cdkv3CommonMathRecognizer from '../../common/v3/Cdkv3CommonMathRecognizer';\n\nexport { close } from '../CdkWSRecognizerUtil';\n\n/**\n * Recognizer configuration\n * @type {RecognizerInfo}\n */\nexport const mathWebSocketV3Configuration = {\n  types: [Constants.RecognitionType.MATH],\n  protocol: Constants.Protocol.WEBSOCKET,\n  apiVersion: 'V3',\n  availableTriggers: {\n    exportContent: [Constants.Trigger.POINTER_UP]\n  }\n};\n\n/**\n * Get the configuration supported by this recognizer\n * @return {RecognizerInfo}\n */\nexport function getInfo() {\n  return mathWebSocketV3Configuration;\n}\n\nfunction buildMathInput(recognizerContext, model) {\n  InkModel.updateModelSentPosition(model);\n  if (recognizerContext.lastPositions.lastSentPosition < 0) {\n    const configuration = recognizerContext.editor.configuration;\n    return {\n      type: 'start',\n      parameters: configuration.recognitionParams.v3.mathParameter,\n      components: model.rawStrokes.map(stroke => StrokeComponent.toJSON(stroke))\n    };\n  }\n\n  return {\n    type: 'continue',\n    components: InkModel.extractPendingStrokes(model, -1).map(stroke => StrokeComponent.toJSON(stroke))\n  };\n}\n\nfunction buildResetMessage(model) {\n  InkModel.resetModelPositions(model);\n  return {\n    type: 'reset'\n  };\n}\n\nconst mathCallback = (model, err, res, callback) => {\n  if (res) {\n    if (res.type === 'init') {\n      return callback(err, model, Constants.EventType.LOADED, Constants.EventType.IDLE);\n    }\n    if (res.type === 'close') {\n      return callback(err, model, Constants.EventType.CHANGED);\n    }\n    const modelReference = InkModel.updateModelReceivedPosition(model);\n    modelReference.rawResults.exports = res;\n    modelReference.exports = CdkCommonUtil.extractExports(modelReference);\n    modelReference.recognizedSymbols = Cdkv3CommonMathRecognizer.extractRecognizedSymbols(modelReference);\n    return callback(err, modelReference, Constants.EventType.EXPORTED, Constants.EventType.IDLE);\n  }\n  return callback(err, model);\n};\n\n/**\n * Initialize recognition\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function init(recognizerContext, model, callback) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model: InkModel.resetModelPositions(model),\n    callback: (err, res) => mathCallback(model, err, res, callback)\n  });\n  CdkWSRecognizerUtil.init('/api/v3.0/recognition/ws/math', recognizerContextRef, Cdkv3WSWebsocketBuilder.buildWebSocketCallback, init)\n    .catch((err) => {\n      if (RecognizerContext.shouldAttemptImmediateReconnect(recognizerContext) && recognizerContext.reconnect) {\n        logger.info('Attempting a reconnect', recognizerContext.currentReconnectionCount);\n        recognizerContext.reconnect(recognizerContext, model, callback);\n      } else {\n        logger.error('Unable to init', err);\n        callback(err, model);\n      }\n    });\n}\n\n/**\n * Export content\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\n// eslint-disable-next-line no-underscore-dangle\nexport function export_(recognizerContext, model, callback) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model,\n    callback: (err, res) => mathCallback(model, err, res, callback)\n  });\n  CdkWSRecognizerUtil.sendMessage(recognizerContextRef, buildMathInput, recognizerContext, model)\n    .catch(exception => CdkWSRecognizerUtil.retry(export_, recognizerContext, model, callback));\n}\n\n/**\n * Reset the recognition context\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function reset(recognizerContext, model, callback) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model,\n    callback: (err, res) => mathCallback(model, err, res, callback)\n  });\n  CdkWSRecognizerUtil.sendMessage(recognizerContextRef, buildResetMessage, model)\n    .catch(exception => CdkWSRecognizerUtil.retry(reset, recognizerContext, model, callback));\n}\n\n/**\n * Clear server context. Currently nothing to do there.\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function clear(recognizerContext, model, callback) {\n  DefaultRecognizer.clear(recognizerContext, model, (err, res, ...types) => {\n    reset(recognizerContext, res, (err1, res1) => logger.trace('Session reset'));\n    callback(err, res, ...types);\n  });\n}\n","import { recognizerLogger as logger } from '../../../configuration/LoggerConfig';\nimport * as CryptoHelper from '../../CryptoHelper';\nimport Constants from '../../../configuration/Constants';\nimport * as InkModel from '../../../model/InkModel';\nimport * as RecognizerContext from '../../../model/RecognizerContext';\nimport * as StrokeComponent from '../../../model/StrokeComponent';\nimport * as Cdkv3WSWebsocketBuilder from './Cdkv3WSBuilder';\nimport * as CdkWSRecognizerUtil from '../CdkWSRecognizerUtil';\nimport * as DefaultRecognizer from '../../DefaultRecognizer';\nimport * as Cdkv3CommonTextRecognizer from '../../common/v3/Cdkv3CommonTextRecognizer';\n\nexport { close } from '../CdkWSRecognizerUtil';\n\n/**\n * Recognizer configuration\n * @type {RecognizerInfo}\n */\nexport const textWebSocketV3Configuration = {\n  types: [Constants.RecognitionType.TEXT],\n  protocol: Constants.Protocol.WEBSOCKET,\n  apiVersion: 'V3',\n  availableTriggers: {\n    exportContent: [Constants.Trigger.POINTER_UP]\n  }\n};\n\n/**\n * Get the configuration supported by this recognizer\n * @return {RecognizerInfo}\n */\nexport function getInfo() {\n  return textWebSocketV3Configuration;\n}\n\nfunction buildTextInput(recognizerContext, model) {\n  InkModel.updateModelSentPosition(model);\n  if (recognizerContext.lastPositions.lastSentPosition < 0) {\n    const configuration = recognizerContext.editor.configuration;\n    return {\n      type: 'start',\n      textParameter: configuration.recognitionParams.v3.textParameter,\n      inputUnits: [{\n        textInputType: 'MULTI_LINE_TEXT',\n        components: model.rawStrokes.map(stroke => StrokeComponent.toJSON(stroke))\n      }]\n    };\n  }\n\n  return {\n    type: 'continue',\n    inputUnits: [{\n      textInputType: 'MULTI_LINE_TEXT',\n      components: InkModel.extractPendingStrokes(model, -1).map(stroke => StrokeComponent.toJSON(stroke))\n    }]\n  };\n}\n\nfunction buildResetMessage(model) {\n  InkModel.resetModelPositions(model);\n  return {\n    type: 'reset'\n  };\n}\n\nconst textCallback = (model, err, res, callback) => {\n  if (res) {\n    if (res.type === 'init') {\n      return callback(err, model, Constants.EventType.LOADED, Constants.EventType.IDLE);\n    }\n    if (res.type === 'close') {\n      return callback(err, model, Constants.EventType.CHANGED);\n    }\n    const modelReference = InkModel.updateModelReceivedPosition(model);\n    modelReference.rawResults.exports = res;\n    modelReference.exports = Cdkv3CommonTextRecognizer.extractExports(model);\n    return callback(err, modelReference, Constants.EventType.EXPORTED, Constants.EventType.IDLE);\n  }\n  return callback(err, model);\n};\n\n/**\n * Initialize recognition\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function init(recognizerContext, model, callback) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model: InkModel.resetModelPositions(model),\n    callback: (err, res) => textCallback(model, err, res, callback)\n  });\n  CdkWSRecognizerUtil.init('/api/v3.0/recognition/ws/text', recognizerContextRef, Cdkv3WSWebsocketBuilder.buildWebSocketCallback, init)\n    .catch((err) => {\n      if (RecognizerContext.shouldAttemptImmediateReconnect(recognizerContext) && recognizerContext.reconnect) {\n        logger.info('Attempting a reconnect', recognizerContext.currentReconnectionCount);\n        recognizerContext.reconnect(recognizerContext, model, callback);\n      } else {\n        logger.error('Unable to init', err);\n        callback(err, model);\n      }\n    });\n}\n\n/**\n * Export content\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\n// eslint-disable-next-line no-underscore-dangle\nexport function export_(recognizerContext, model, callback) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model,\n    callback: (err, res) => textCallback(model, err, res, callback)\n  });\n  CdkWSRecognizerUtil.sendMessage(recognizerContextRef, buildTextInput, recognizerContext, model)\n    .catch(exception => CdkWSRecognizerUtil.retry(export_, recognizerContext, model, callback));\n}\n\n/**\n * Reset the recognition context\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function reset(recognizerContext, model, callback) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model,\n    callback: (err, res) => textCallback(model, err, res, callback)\n  });\n  CdkWSRecognizerUtil.sendMessage(recognizerContextRef, buildResetMessage, model)\n    .catch(exception => CdkWSRecognizerUtil.retry(reset, recognizerContext, model, callback));\n}\n\n/**\n * Clear server context. Currently nothing to do there.\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function clear(recognizerContext, model, callback) {\n  DefaultRecognizer.clear(recognizerContext, model, (err, res, ...types) => {\n    reset(recognizerContext, res, (err1, res1) => logger.trace('Session reset'));\n    callback(err, res, ...types);\n  });\n}\n","/*\n * UUID-js: A js library to generate and parse UUIDs, TimeUUIDs and generate\n * TimeUUID based on dates for range selections.\n * @see http://www.ietf.org/rfc/rfc4122.txt\n **/\n\nfunction UUIDjs() {\n};\n\nUUIDjs.maxFromBits = function(bits) {\n  return Math.pow(2, bits);\n};\n\nUUIDjs.limitUI04 = UUIDjs.maxFromBits(4);\nUUIDjs.limitUI06 = UUIDjs.maxFromBits(6);\nUUIDjs.limitUI08 = UUIDjs.maxFromBits(8);\nUUIDjs.limitUI12 = UUIDjs.maxFromBits(12);\nUUIDjs.limitUI14 = UUIDjs.maxFromBits(14);\nUUIDjs.limitUI16 = UUIDjs.maxFromBits(16);\nUUIDjs.limitUI32 = UUIDjs.maxFromBits(32);\nUUIDjs.limitUI40 = UUIDjs.maxFromBits(40);\nUUIDjs.limitUI48 = UUIDjs.maxFromBits(48);\n\n// Returns a random integer between min and max\n// Using Math.round() will give you a non-uniform distribution!\n// @see https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Math/random\nfunction getRandomInt(min, max) {\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n}\n\nUUIDjs.randomUI04 = function() {\n  return getRandomInt(0, UUIDjs.limitUI04-1);\n};\nUUIDjs.randomUI06 = function() {\n  return getRandomInt(0, UUIDjs.limitUI06-1);\n};\nUUIDjs.randomUI08 = function() {\n  return getRandomInt(0, UUIDjs.limitUI08-1);\n};\nUUIDjs.randomUI12 = function() {\n  return getRandomInt(0, UUIDjs.limitUI12-1);\n};\nUUIDjs.randomUI14 = function() {\n  return getRandomInt(0, UUIDjs.limitUI14-1);\n};\nUUIDjs.randomUI16 = function() {\n  return getRandomInt(0, UUIDjs.limitUI16-1);\n};\nUUIDjs.randomUI32 = function() {\n  return getRandomInt(0, UUIDjs.limitUI32-1);\n};\nUUIDjs.randomUI40 = function() {\n  return (0 | Math.random() * (1 << 30)) + (0 | Math.random() * (1 << 40 - 30)) * (1 << 30);\n};\nUUIDjs.randomUI48 = function() {\n  return (0 | Math.random() * (1 << 30)) + (0 | Math.random() * (1 << 48 - 30)) * (1 << 30);\n};\n\nUUIDjs.paddedString = function(string, length, z) {\n  string = String(string);\n  z = (!z) ? '0' : z;\n  var i = length - string.length;\n  for (; i > 0; i >>>= 1, z += z) {\n    if (i & 1) {\n      string = z + string;\n    }\n  }\n  return string;\n};\n\nUUIDjs.prototype.fromParts = function(timeLow, timeMid, timeHiAndVersion, clockSeqHiAndReserved, clockSeqLow, node) {\n  this.version = (timeHiAndVersion >> 12) & 0xF;\n  this.hex = UUIDjs.paddedString(timeLow.toString(16), 8)\n             + '-'\n             + UUIDjs.paddedString(timeMid.toString(16), 4)\n             + '-'\n             + UUIDjs.paddedString(timeHiAndVersion.toString(16), 4)\n             + '-'\n             + UUIDjs.paddedString(clockSeqHiAndReserved.toString(16), 2)\n             + UUIDjs.paddedString(clockSeqLow.toString(16), 2)\n             + '-'\n             + UUIDjs.paddedString(node.toString(16), 12);\n  return this;\n};\n\nUUIDjs.prototype.toString = function() {\n  return this.hex;\n};\nUUIDjs.prototype.toURN = function() {\n  return 'urn:uuid:' + this.hex;\n};\n\nUUIDjs.prototype.toBytes = function() {\n  var parts = this.hex.split('-');\n  var ints = [];\n  var intPos = 0;\n  for (var i = 0; i < parts.length; i++) {\n    for (var j = 0; j < parts[i].length; j+=2) {\n      ints[intPos++] = parseInt(parts[i].substr(j, 2), 16);\n    }\n  }\n  return ints;\n};\n\nUUIDjs.prototype.equals = function(uuid) {\n  if (!(uuid instanceof UUID)) {\n    return false;\n  }\n  if (this.hex !== uuid.hex) {\n    return false;\n  }\n  return true;\n};\n\nUUIDjs.getTimeFieldValues = function(time) {\n  var ts = time - Date.UTC(1582, 9, 15);\n  var hm = ((ts / 0x100000000) * 10000) & 0xFFFFFFF;\n  return { low: ((ts & 0xFFFFFFF) * 10000) % 0x100000000,\n            mid: hm & 0xFFFF, hi: hm >>> 16, timestamp: ts };\n};\n\nUUIDjs._create4 = function() {\n  return new UUIDjs().fromParts(\n    UUIDjs.randomUI32(),\n    UUIDjs.randomUI16(),\n    0x4000 | UUIDjs.randomUI12(),\n    0x80   | UUIDjs.randomUI06(),\n    UUIDjs.randomUI08(),\n    UUIDjs.randomUI48()\n  );\n};\n\nUUIDjs._create1 = function() {\n  var now = new Date().getTime();\n  var sequence = UUIDjs.randomUI14();\n  var node = (UUIDjs.randomUI08() | 1) * 0x10000000000 + UUIDjs.randomUI40();\n  var tick = UUIDjs.randomUI04();\n  var timestamp = 0;\n  var timestampRatio = 1/4;\n\n  if (now != timestamp) {\n    if (now < timestamp) {\n      sequence++;\n    }\n    timestamp = now;\n    tick = UUIDjs.randomUI04();\n  } else if (Math.random() < timestampRatio && tick < 9984) {\n    tick += 1 + UUIDjs.randomUI04();\n  } else {\n    sequence++;\n  }\n\n  var tf = UUIDjs.getTimeFieldValues(timestamp);\n  var tl = tf.low + tick;\n  var thav = (tf.hi & 0xFFF) | 0x1000;\n\n  sequence &= 0x3FFF;\n  var cshar = (sequence >>> 8) | 0x80;\n  var csl = sequence & 0xFF;\n\n  return new UUIDjs().fromParts(tl, tf.mid, thav, cshar, csl, node);\n};\n\nUUIDjs.create = function(version) {\n  version = version || 4;\n  return this['_create' + version]();\n};\n\nUUIDjs.fromTime = function(time, last) {\n  last = (!last) ? false : last;\n  var tf = UUIDjs.getTimeFieldValues(time);\n  var tl = tf.low;\n  var thav = (tf.hi & 0xFFF) | 0x1000;  // set version '0001'\n  if (last === false) {\n    return new UUIDjs().fromParts(tl, tf.mid, thav, 0, 0, 0);\n  } else {\n    return new UUIDjs().fromParts(tl, tf.mid, thav, 0x80 | UUIDjs.limitUI06, UUIDjs.limitUI08 - 1, UUIDjs.limitUI48 - 1);\n  }\n};\n\nUUIDjs.firstFromTime = function(time) {\n  return UUIDjs.fromTime(time, false);\n};\nUUIDjs.lastFromTime = function(time) {\n  return UUIDjs.fromTime(time, true);\n};\n\nUUIDjs.fromURN = function(strId) {\n  var r, p = /^(?:urn:uuid:|\\{)?([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{2})([0-9a-f]{2})-([0-9a-f]{12})(?:\\})?$/i;\n  if ((r = p.exec(strId))) {\n    return new UUIDjs().fromParts(parseInt(r[1], 16), parseInt(r[2], 16),\n                            parseInt(r[3], 16), parseInt(r[4], 16),\n                            parseInt(r[5], 16), parseInt(r[6], 16));\n  }\n  return null;\n};\n\nUUIDjs.fromBytes = function(ints) {\n  if (ints.length < 5) {\n    return null;\n  }\n  var str = '';\n  var pos = 0;\n  var parts = [4, 2, 2, 2, 6];\n  for (var i = 0; i < parts.length; i++) {\n    for (var j = 0; j < parts[i]; j++) {\n      var octet = ints[pos++].toString(16);\n      if (octet.length == 1) {\n        octet = '0' + octet;\n      }\n      str += octet;\n    }\n    if (parts[i] !== 6) {\n      str += '-';\n    }\n  }\n  return UUIDjs.fromURN(str);\n};\n\nUUIDjs.fromBinary = function(binary) {\n  var ints = [];\n  for (var i = 0; i < binary.length; i++) {\n    ints[i] = binary.charCodeAt(i);\n    if (ints[i] > 255 || ints[i] < 0) {\n      throw new Error('Unexpected byte in binary data.');\n    }\n  }\n  return UUIDjs.fromBytes(ints);\n};\n\n// Aliases to support legacy code. Do not use these when writing new code as\n// they may be removed in future versions!\nUUIDjs.new = function() {\n  return this.create(4);\n};\nUUIDjs.newTS = function() {\n  return this.create(1);\n};\n\nmodule.exports = UUIDjs;\n","import { recognizerLogger as logger } from '../../../configuration/LoggerConfig';\nimport * as CryptoHelper from '../../CryptoHelper';\nimport * as NetworkWSInterface from '../networkWSInterface';\nimport * as RecognizerContext from '../../../model/RecognizerContext';\n\nimport {\n  buildNewContentPackageInput,\n  buildRestoreIInkSessionInput,\n  buildNewContentPart,\n  buildOpenContentPart,\n  buildConfiguration,\n  buildSetTheme,\n  buildSetPenStyle,\n  buildSetPenStyleClasses\n} from './Cdkv4WSIInkRecognizer';\n\n/**\n * A CDK v4 websocket dialog have this sequence :\n * ---------- Client ------------------------------------- Server ----------------------------------\n * init (send the new content package) ================>\n *                                       <=========== hmacChallenge\n * answerToHmacChallenge (send the hmac) =========>\n * newPart (send the parameters ) ===============>\n *                                       <=========== update\n * addStrokes (send the strokes ) ============>\n *                                       <=========== update\n */\n\nfunction buildHmacMessage(configuration, message) {\n  return {\n    type: 'hmac',\n    hmac: CryptoHelper.computeHmac(message.data.hmacChallenge, configuration.recognitionParams.server.applicationKey, configuration.recognitionParams.server.hmacKey)\n  };\n}\n\n/**\n * This function bind the right behaviour when a message is receive by the websocket.\n * @param {DestructuredPromise} destructuredPromise\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @return {function} Callback to handle WebSocket results\n */\nexport function buildWebSocketCallback(destructuredPromise, recognizerContext) {\n  return (message) => {\n    const recognizerContextRef = recognizerContext;\n    // Handle websocket messages\n    logger.trace(`${message.type} websocket callback`, message);\n    const recognitionContext = recognizerContext.recognitionContexts[recognizerContext.recognitionContexts.length - 1];\n    logger.debug('Current recognition context', recognitionContext);\n\n    switch (message.type) {\n      case 'open':\n        if (recognizerContext.sessionId) {\n          NetworkWSInterface.send(recognizerContext, buildRestoreIInkSessionInput(recognizerContext.editor.configuration, recognizerContext.editor.domElement, recognizerContext.sessionId));\n        } else {\n          NetworkWSInterface.send(recognizerContext, buildNewContentPackageInput(recognizerContext.editor.configuration, recognizerContext.editor.domElement));\n        }\n        break;\n      case 'message':\n        logger.debug(`Receiving ${message.data.type} message`, message);\n        switch (message.data.type) {\n          case 'ack':\n            if (message.data.hmacChallenge) {\n              NetworkWSInterface.send(recognizerContext, buildHmacMessage(recognizerContext.editor.configuration, message));\n            }\n            if (message.data.iinkSessionId) {\n              recognizerContextRef.sessionId = message.data.iinkSessionId;\n            }\n            break;\n          case 'newPart':\n            break;\n          case 'contentPackageDescription':\n            recognizerContextRef.currentReconnectionCount = 0;\n            recognizerContextRef.contentPartCount = message.data.contentPartCount;\n            NetworkWSInterface.send(recognizerContext, buildConfiguration(recognizerContext.editor.configuration));\n            if (recognizerContextRef.currentPartId) { // FIXME: Ugly hack to resolve init promise after opening part\n              NetworkWSInterface.send(recognizerContext, buildOpenContentPart(recognizerContext.editor.configuration, recognizerContext.currentPartId));\n            } else {\n              NetworkWSInterface.send(recognizerContext, buildNewContentPart(recognizerContext.editor.configuration));\n            }\n            break;\n          case 'partChanged':\n            if (message.data.partId) {\n              recognizerContextRef.currentPartId = message.data.partId;\n            }\n            recognizerContextRef.initialized = true;\n            NetworkWSInterface.send(recognizerContext, buildSetTheme(recognizerContext.editor.theme));\n            NetworkWSInterface.send(recognizerContext, buildSetPenStyle(recognizerContext.editor.penStyle));\n            NetworkWSInterface.send(recognizerContext, buildSetPenStyleClasses(recognizerContext.editor.penStyleClasses));\n            recognitionContext.callback(undefined, message.data);\n            destructuredPromise.resolve(recognitionContext);\n            break;\n          case 'contentChanged':\n            if (message.data.canUndo !== undefined) {\n              recognizerContextRef.canUndo = message.data.canUndo;\n            }\n            if (message.data.canRedo !== undefined) {\n              recognizerContextRef.canRedo = message.data.canRedo;\n            }\n            if (message.data.empty !== undefined) {\n              recognizerContextRef.isEmpty = message.data.empty;\n            }\n            if (message.data.possibleUndoCount !== undefined) {\n              recognizerContextRef.possibleUndoCount = message.data.possibleUndoCount;\n            }\n            if (message.data.undoStackIndex !== undefined) {\n              recognizerContextRef.undoStackIndex = message.data.undoStackIndex;\n            }\n            recognitionContext.callback(undefined, message.data);\n            break;\n          case 'exported':\n            recognitionContext.callback(undefined, message.data);\n            break;\n          case 'svgPatch':\n            recognitionContext.callback(undefined, message.data);\n            break;\n          case 'supportedImportMimeTypes':\n            recognizerContextRef.supportedImportMimeTypes = message.data.mimeTypes;\n            recognitionContext.callback(undefined, message.data);\n            break;\n          case 'fileChunkAck':\n            recognitionContext.callback(undefined, message.data);\n            break;\n          case 'idle':\n            recognizerContextRef.idle = true;\n            recognitionContext.callback(undefined, message.data);\n            break;\n          case 'error':\n            logger.debug('Error detected stopping all recognition', message);\n            if (recognitionContext) {\n              recognitionContext.callback(message.data);\n            } else {\n              destructuredPromise.reject(Object.assign({}, message.data, { recoverable: false }));\n            }\n            break;\n          default :\n            logger.warn('This is something unexpected in current recognizer. Not the type of message we should have here.', message);\n        }\n        break;\n      case 'error':\n        logger.debug('Error detected stopping all recognition', message);\n        if (recognitionContext) {\n          recognitionContext.callback(Object.assign({}, message, { recoverable: false }));\n        } else {\n          destructuredPromise.reject(Object.assign({}, message, { recoverable: false }));\n        }\n        break;\n      case 'close':\n        logger.debug('Close detected stopping all recognition', message);\n        recognizerContextRef.initialized = false;\n        recognizerContextRef.canRedo = false;\n        recognizerContextRef.canUndo = false;\n        if (recognitionContext) {\n          recognitionContext.callback(message);\n        } else {\n          destructuredPromise.reject(message);\n        }\n        break;\n      default :\n        logger.warn('This is something unexpected in current recognizer. Not the type of message we should have here.', message);\n    }\n  };\n}\n","import uuid from 'uuid-js';\nimport { recognizerLogger as logger } from '../../../configuration/LoggerConfig';\nimport Constants from '../../../configuration/Constants';\nimport * as DefaultTheme from '../../../configuration/DefaultTheme';\nimport * as DefaultPenStyle from '../../../configuration/DefaultPenStyle';\nimport * as InkModel from '../../../model/InkModel';\nimport * as RecognizerContext from '../../../model/RecognizerContext';\nimport * as DefaultRecognizer from '../../DefaultRecognizer';\nimport * as Cdkv4WSWebsocketBuilder from './Cdkv4WSBuilder';\nimport * as CdkWSRecognizerUtil from '../CdkWSRecognizerUtil';\n\nexport { close } from '../CdkWSRecognizerUtil';\n\nfunction readBlob(blob) {\n  const fileReader = new FileReader();\n  return new Promise((resolve, reject) => {\n    fileReader.onload = event => resolve(event.target.result);\n    fileReader.onerror = () => reject(this);\n    fileReader.readAsText(blob);\n  });\n}\n\n\nfunction getDPI(element) {\n  // const startDpi = 56;\n  // for (let dpi = startDpi; dpi < 2000; dpi++) {\n  //   if (window.matchMedia(`(max-resolution: ${dpi}dpi)`).matches === true) {\n  //     return dpi;\n  //   }\n  // }\n  // return startDpi;\n  return 96;\n}\n\n/**\n * Recognizer configuration\n * @type {RecognizerInfo}\n */\nexport const IInkWebSocketV4Configuration = {\n  types: [Constants.RecognitionType.MATH, Constants.RecognitionType.TEXT, Constants.RecognitionType.DIAGRAM, Constants.RecognitionType.NEBO],\n  protocol: Constants.Protocol.WEBSOCKET,\n  apiVersion: 'V4',\n  availableTriggers: {\n    exportContent: [Constants.Trigger.POINTER_UP, Constants.Trigger.DEMAND],\n    addStrokes: [Constants.Trigger.POINTER_UP]\n  }\n};\n\n/**\n * Get the configuration supported by this recognizer\n * @return {RecognizerInfo}\n */\nexport function getInfo() {\n  return IInkWebSocketV4Configuration;\n}\n\nexport function buildNewContentPackageInput(configuration, element) {\n  return {\n    type: 'newContentPackage',\n    applicationKey: configuration.recognitionParams.server.applicationKey,\n    xDpi: getDPI(element),\n    yDpi: getDPI(element),\n    viewSizeHeight: element.clientHeight < configuration.renderingParams.minHeight ? configuration.renderingParams.minHeight : element.clientHeight,\n    viewSizeWidth: element.clientWidth < configuration.renderingParams.minWidth ? configuration.renderingParams.minWidth : element.clientWidth\n  };\n}\n\nexport function buildRestoreIInkSessionInput(configuration, element, sessionId) {\n  return {\n    type: 'restoreIInkSession',\n    iinkSessionId: sessionId,\n    applicationKey: configuration.recognitionParams.server.applicationKey,\n    xDpi: getDPI(element),\n    yDpi: getDPI(element),\n    viewSizeHeight: element.clientHeight < configuration.renderingParams.minHeight ? configuration.renderingParams.minHeight : element.clientHeight,\n    viewSizeWidth: element.clientWidth < configuration.renderingParams.minWidth ? configuration.renderingParams.minWidth : element.clientWidth\n  };\n}\n\nexport function buildNewContentPart(configuration) {\n  return {\n    type: 'newContentPart',\n    contentType: configuration.recognitionParams.type,\n    mimeTypes: (configuration.triggers.exportContent !== Constants.Trigger.DEMAND) ?\n      configuration.recognitionParams.v4[`${configuration.recognitionParams.type.toLowerCase()}`].mimeTypes : undefined\n  };\n}\n\nexport function buildOpenContentPart(configuration, partId) {\n  return {\n    type: 'openContentPart',\n    id: partId,\n    mimeTypes: (configuration.triggers.exportContent !== Constants.Trigger.DEMAND) ?\n      configuration.recognitionParams.v4[`${configuration.recognitionParams.type.toLowerCase()}`].mimeTypes : undefined\n  };\n}\n\nexport function buildConfiguration(configuration) {\n  return Object.assign({ type: 'configuration' }, configuration.recognitionParams.v4);\n}\n\nfunction buildAddStrokes(recognizerContext, model) {\n  const strokes = InkModel.extractPendingStrokes(model, recognizerContext.lastPositions.lastSentPosition + 1);\n  if (strokes.length > 0) {\n    InkModel.updateModelSentPosition(model);\n    return {\n      type: 'addStrokes',\n      strokes: strokes.map(stroke => Object.assign({}, {\n        id: stroke.id,\n        pointerType: stroke.pointerType,\n        pointerId: stroke.pointerId,\n        x: stroke.x,\n        y: stroke.y,\n        t: stroke.t,\n        p: stroke.p\n      }))\n    };\n  }\n  return undefined;\n}\n\nfunction buildUndo() {\n  return {\n    type: 'undo'\n  };\n}\n\nfunction buildRedo() {\n  return {\n    type: 'redo'\n  };\n}\n\nfunction buildClear() {\n  return {\n    type: 'clear'\n  };\n}\n\nfunction buildConvert(state) {\n  return {\n    type: 'convert',\n    conversionState: state\n  };\n}\n\nfunction buildZoom(value) {\n  return {\n    type: 'zoom',\n    zoom: value\n  };\n}\n\nfunction buildResize(element, minHeight = 0, minWidth = 0) {\n  return {\n    type: 'changeViewSize',\n    height: element.clientHeight < minHeight ? minHeight : element.clientHeight,\n    width: element.clientWidth < minWidth ? minWidth : element.clientWidth\n  };\n}\n\nfunction buildExport(configuration, partId, requestedMimeType) {\n  let usedMimeType;\n  if (requestedMimeType && Object.keys(requestedMimeType).length !== 0) {\n    usedMimeType = requestedMimeType;\n  } else {\n    usedMimeType = configuration.recognitionParams.v4[`${configuration.recognitionParams.type.toLowerCase()}`].mimeTypes;\n  }\n\n  return {\n    type: 'export',\n    partId,\n    mimeTypes: usedMimeType\n  };\n}\n\nfunction buildImportFile(id, mimetype) {\n  return {\n    type: 'importFile',\n    importFileId: id,\n    mimeType: mimetype\n  };\n}\n\nfunction buildImportChunk(id, data, lastChunk) {\n  return {\n    type: 'fileChunk',\n    importFileId: id,\n    data,\n    lastChunk\n  };\n}\n\nfunction buildPointerEvents(events) {\n  return Object.assign({ type: 'pointerEvents' }, events);\n}\n\nfunction buildWaitForIdle() {\n  return {\n    type: 'waitForIdle'\n  };\n}\n\nfunction buildGetSupportedImportMimeTypes() {\n  return {\n    type: 'getSupportedImportMimeTypes'\n  };\n}\n\nexport function buildSetPenStyle(penStyle) {\n  return {\n    type: 'setPenStyle',\n    style: penStyle ? DefaultPenStyle.toCSS(penStyle) : ''\n  };\n}\n\nexport function buildSetPenStyleClasses(penStyleClasses) {\n  return {\n    type: 'setPenStyleClasses',\n    styleClasses: penStyleClasses\n  };\n}\n\nexport function buildSetTheme(theme) {\n  return {\n    type: 'setTheme',\n    theme: DefaultTheme.toCSS(theme)\n  };\n}\n\nconst iinkCallback = (model, err, res, callback) => {\n  const modelReference = InkModel.updateModelReceivedPosition(model);\n  if (res) {\n    if (res.updates !== undefined) {\n      if (modelReference.recognizedSymbols) {\n        modelReference.recognizedSymbols.push(res);\n      } else {\n        modelReference.recognizedSymbols = [res];\n      }\n      return callback(err, modelReference, Constants.EventType.RENDERED);\n    }\n    if (res.exports !== undefined) {\n      modelReference.rawResults.exports = res;\n      modelReference.exports = res.exports;\n      return callback(err, modelReference, Constants.EventType.EXPORTED);\n    }\n\n    if ((res.canUndo !== undefined) || (res.canRedo !== undefined)) {\n      return callback(err, modelReference, Constants.EventType.CHANGED);\n    }\n\n    if (res.type === 'supportedImportMimeTypes') {\n      return callback(err, modelReference, Constants.EventType.SUPPORTED_IMPORT_MIMETYPES);\n    }\n\n    if (res.type === 'partChanged') {\n      return callback(err, modelReference, Constants.EventType.LOADED);\n    }\n\n    if (res.type === 'idle') {\n      return callback(err, modelReference, Constants.EventType.IDLE);\n    }\n\n    if (res.type === 'close') {\n      return callback(err, modelReference, Constants.EventType.CHANGED);\n    }\n  }\n  return callback(err, modelReference);\n};\n\n/**\n * Initialize recognition\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function init(recognizerContext, model, callback) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model: InkModel.updateModelSentPosition(model, model.lastPositions.lastReceivedPosition),\n    callback: (err, res) => iinkCallback(model, err, res, callback)\n  });\n  CdkWSRecognizerUtil.init('/api/v4.0/iink/document', recognizerContextRef, Cdkv4WSWebsocketBuilder.buildWebSocketCallback, init)\n    .catch((err) => {\n      if (RecognizerContext.shouldAttemptImmediateReconnect(recognizerContext) && recognizerContext.reconnect) {\n        logger.info('Attempting a reconnect', recognizerContext.currentReconnectionCount);\n        recognizerContext.reconnect(recognizerContext, model, callback);\n      } else {\n        logger.error('Unable to reconnect', err);\n        iinkCallback(model, err, undefined, callback);\n      }\n    });\n}\n\n/**\n * Create a new content part\n * @param {RecognizerContext} recognizerContext Current recognition context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function newContentPart(recognizerContext, model, callback) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model,\n    callback: (err, res) => iinkCallback(model, err, res, callback)\n  });\n  CdkWSRecognizerUtil.sendMessage(recognizerContextRef, buildNewContentPart, recognizerContext.editor.configuration)\n    .catch(exception => CdkWSRecognizerUtil.retry(newContentPart, recognizerContext, model, callback));\n}\n\n/**\n * Open the recognizer context content part\n * @param {RecognizerContext} recognizerContext Current recognition context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function openContentPart(recognizerContext, model, callback) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model,\n    callback: (err, res) => iinkCallback(model, err, res, callback)\n  });\n  CdkWSRecognizerUtil.sendMessage(recognizerContextRef, buildOpenContentPart, recognizerContext.editor.configuration, recognizerContext.currentPartId)\n    .catch(exception => CdkWSRecognizerUtil.retry(openContentPart, recognizerContext, model, callback));\n}\n\nexport function sendConfiguration(recognizerContext, model, callback) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model,\n    callback: (err, res) => iinkCallback(model, err, res, callback)\n  });\n  CdkWSRecognizerUtil.sendMessage(recognizerContextRef, buildConfiguration, recognizerContext.editor.configuration)\n    .catch(exception => CdkWSRecognizerUtil.retry(sendConfiguration, recognizerContext, model, callback));\n}\n\n/**\n * Pointer Events\n * @param {RecognizerContext} recognizerContext Current recognition context\n * @param {Model} model Current model\n * @param {PointerEvents} events to be imported\n * @param {RecognizerCallback} callback\n */\nexport function pointerEvents(recognizerContext, model, events, callback) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model,\n    callback: (err, res) => iinkCallback(model, err, res, callback)\n  });\n  CdkWSRecognizerUtil.sendMessage(recognizerContextRef, buildPointerEvents, events)\n    .catch(exception => CdkWSRecognizerUtil.retry(pointerEvents, recognizerContext, model, events, callback));\n}\n\n/**\n * Add strokes to the model\n * @param {RecognizerContext} recognizerContext Current recognition context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function addStrokes(recognizerContext, model, callback) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model,\n    callback: (err, res) => iinkCallback(model, err, res, callback)\n  });\n  CdkWSRecognizerUtil.sendMessage(recognizerContextRef, buildAddStrokes, recognizerContext, model)\n    .catch(exception => CdkWSRecognizerUtil.retry(addStrokes, recognizerContext, model, callback));\n}\n\n/**\n * Undo last action\n * @param {RecognizerContext} recognizerContext Current recognition context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function undo(recognizerContext, model, callback) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model,\n    callback: (err, res) => iinkCallback(model, err, res, callback)\n  });\n  CdkWSRecognizerUtil.sendMessage(recognizerContextRef, buildUndo)\n    .catch(exception => CdkWSRecognizerUtil.retry(undo, recognizerContext, model, callback));\n}\n\n/**\n * Redo last action\n * @param {RecognizerContext} recognizerContext Current recognition context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function redo(recognizerContext, model, callback) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model,\n    callback: (err, res) => iinkCallback(model, err, res, callback)\n  });\n  CdkWSRecognizerUtil.sendMessage(recognizerContextRef, buildRedo)\n    .catch(exception => CdkWSRecognizerUtil.retry(redo, recognizerContext, model, callback));\n}\n\n/**\n * Clear action\n * @param {RecognizerContext} recognizerContext Current recognition context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function clear(recognizerContext, model, callback) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model,\n    callback: (err, res) => {\n      DefaultRecognizer.clear(recognizerContext, model, (noerr, newModel, ...attrs) => {\n        logger.debug('The model after clear is :', newModel);\n        iinkCallback(newModel, err, res, callback);\n      });\n    }\n  });\n  CdkWSRecognizerUtil.sendMessage(recognizerContextRef, buildClear)\n    .catch(exception => CdkWSRecognizerUtil.retry(clear, recognizerContext, model, callback));\n}\n\n/**\n * Convert action\n * @param {RecognizerContext} recognizerContext Current recognition context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n * @param {String} conversionState Conversion State, by default DigitalEdit\n */\nexport function convert(recognizerContext, model, callback, conversionState) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model,\n    callback: (err, res) => iinkCallback(model, err, res, callback)\n  });\n  CdkWSRecognizerUtil.sendMessage(recognizerContextRef, buildConvert, conversionState)\n    .catch(exception => CdkWSRecognizerUtil.retry(convert, recognizerContext, model, callback, conversionState));\n}\n\n/**\n * Export action\n * @param {RecognizerContext} recognizerContext Current recognition context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n * @param {Array[String]} requestedMimeTypes\n */\n// eslint-disable-next-line no-underscore-dangle\nexport function export_(recognizerContext, model, callback, requestedMimeTypes) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model,\n    callback: (err, res) => iinkCallback(model, err, res, callback)\n  });\n  CdkWSRecognizerUtil.sendMessage(recognizerContextRef, buildExport, recognizerContext.editor.configuration, recognizerContext.currentPartId, requestedMimeTypes)\n    .catch(exception => CdkWSRecognizerUtil.retry(export_, recognizerContext, model, callback, requestedMimeTypes));\n}\n\n/**\n * Import action\n * @param {RecognizerContext} recognizerContext Current recognition context\n * @param {Model} model Current model\n * @param {Blob} data Import data\n * @param {RecognizerCallback} callback\n */\n// eslint-disable-next-line no-underscore-dangle\nexport function import_(recognizerContext, model, data, callback) {\n  const recognitionContext = {\n    model,\n    callback: (err, res) => iinkCallback(model, err, res, callback),\n    importFileId: uuid.create(4).toString()\n  };\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, recognitionContext);\n\n  const chunkSize = recognizerContext.editor.configuration.recognitionParams.server.websocket.fileChunkSize;\n\n  for (let i = 0; i < data.size; i += chunkSize) {\n    if (i === 0) {\n      CdkWSRecognizerUtil.sendMessage(recognizerContextRef, buildImportFile, recognitionContext.importFileId, data.type)\n        .catch(exception => CdkWSRecognizerUtil.retry(import_, recognizerContext, model, data, callback));\n    }\n    const blobPart = data.slice(i, chunkSize, data.type);\n    readBlob(blobPart).then((res) => {\n      CdkWSRecognizerUtil.sendMessage(recognizerContextRef, buildImportChunk, recognitionContext.importFileId, res, i + chunkSize > data.size)\n        .catch(exception => CdkWSRecognizerUtil.retry(import_, recognizerContext, model, data, callback));\n    });\n  }\n}\n\nexport function getSupportedImportMimeTypes(recognizerContext, model, callback) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model,\n    callback: (err, res) => iinkCallback(model, err, res, callback)\n  });\n  CdkWSRecognizerUtil.sendMessage(recognizerContextRef, buildGetSupportedImportMimeTypes)\n    .catch(exception => CdkWSRecognizerUtil.retry(getSupportedImportMimeTypes, recognizerContext, model, callback));\n}\n\n/**\n * WaitForIdle action\n * @param {RecognizerContext} recognizerContext Current recognition context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nexport function waitForIdle(recognizerContext, model, callback) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model,\n    callback: (err, res) => iinkCallback(model, err, res, callback)\n  });\n  CdkWSRecognizerUtil.sendMessage(recognizerContextRef, buildWaitForIdle)\n    .catch(exception => CdkWSRecognizerUtil.retry(waitForIdle, recognizerContext, model, callback));\n}\n\n/**\n * Resize\n * @param {RecognizerContext} recognizerContext Current recognition context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n * @param {Element} element Current element\n */\nexport function resize(recognizerContext, model, callback, element) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model,\n    callback: (err, res) => iinkCallback(model, err, res, callback)\n  });\n  CdkWSRecognizerUtil.sendMessage(recognizerContextRef, buildResize, element, recognizerContext.editor.configuration.renderingParams.minHeight, recognizerContext.editor.configuration.renderingParams.minWidth)\n    .catch(exception => CdkWSRecognizerUtil.retry(resize, recognizerContext, model, callback, element));\n}\n\n/**\n * Zoom action\n * @param {RecognizerContext} recognizerContext Current recognition context\n * @param {Model} model Current model\n * @param {Number} value=10 Zoom value\n * @param {RecognizerCallback} callback\n */\nexport function zoom(recognizerContext, model, value = 10, callback) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model,\n    callback: (err, res) => iinkCallback(model, err, res, callback)\n  });\n  CdkWSRecognizerUtil.sendMessage(recognizerContextRef, buildZoom, value)\n    .catch(exception => CdkWSRecognizerUtil.retry(zoom, recognizerContext, model, callback));\n}\n\n/**\n * SetPenStyle action\n * @param {RecognizerContext} recognizerContext Current recognition context\n * @param {Model} model Current model\n * @param {PenStyle} penStyle Current penStyle\n * @param {RecognizerCallback} callback\n */\nexport function setPenStyle(recognizerContext, model, penStyle, callback) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model,\n    callback: (err, res) => iinkCallback(model, err, res, callback)\n  });\n  CdkWSRecognizerUtil.sendMessage(recognizerContextRef, buildSetPenStyle, penStyle)\n    .catch(exception => CdkWSRecognizerUtil.retry(setPenStyle, recognizerContext, model, callback));\n}\n\n/**\n * setPenStyleClasses action\n * @param {RecognizerContext} recognizerContext Current recognition context\n * @param {Model} model Current model\n * @param {String} penStyleClasses Current penStyleClasses\n * @param {RecognizerCallback} callback\n */\nexport function setPenStyleClasses(recognizerContext, model, penStyleClasses, callback) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model,\n    callback: (err, res) => iinkCallback(model, err, res, callback)\n  });\n  CdkWSRecognizerUtil.sendMessage(recognizerContextRef, buildSetPenStyleClasses, penStyleClasses)\n    .catch(exception => CdkWSRecognizerUtil.retry(setPenStyleClasses, recognizerContext, model, callback));\n}\n\n/**\n * SetTheme action\n * @param {RecognizerContext} recognizerContext Current recognition context\n * @param {Model} model Current model\n * @param {Theme} theme Current theme\n * @param {RecognizerCallback} callback\n */\nexport function setTheme(recognizerContext, model, theme, callback) {\n  const recognizerContextRef = RecognizerContext.setRecognitionContext(recognizerContext, {\n    model,\n    callback: (err, res) => iinkCallback(model, err, res, callback)\n  });\n  CdkWSRecognizerUtil.sendMessage(recognizerContextRef, buildSetTheme, theme)\n    .catch(exception => CdkWSRecognizerUtil.retry(setTheme, recognizerContext, model, callback));\n}\n","import { editorLogger as logger } from './LoggerConfig';\nimport * as PointerEventGrabber from '../grabber/PointerEventGrabber';\nimport * as CanvasRenderer from '../renderer/canvas/CanvasRenderer';\nimport * as QuadraticCanvasStroker from '../renderer/canvas/stroker/QuadraticCanvasStroker';\nimport * as SVGRenderer from '../renderer/svg/SVGRenderer';\nimport * as QuadraticSVGStroker from '../renderer/svg/stroker/QuadraticSVGStroker';\nimport * as Cdkv3RestTextRecognizer from '../recognizer/rest/v3/Cdkv3RestTextRecognizer';\nimport * as Cdkv3RestMathRecognizer from '../recognizer/rest/v3/Cdkv3RestMathRecognizer';\nimport * as Cdkv3RestAnalyzerRecognizer from '../recognizer/rest/v3/Cdkv3RestAnalyzerRecognizer';\nimport * as Cdkv3RestShapeRecognizer from '../recognizer/rest/v3/Cdkv3RestShapeRecognizer';\nimport * as Cdkv3RestMusicRecognizer from '../recognizer/rest/v3/Cdkv3RestMusicRecognizer';\nimport * as iinkRestRecognizer from '../recognizer/rest/v4/iinkRestRecognizer';\nimport * as Cdkv3WSMathRecognizer from '../recognizer/websocket/v3/Cdkv3WSMathRecognizer';\nimport * as Cdkv3WSTextRecognizer from '../recognizer/websocket/v3/Cdkv3WSTextRecognizer';\nimport * as Cdkv4WSInteractiveRecognizer from '../recognizer/websocket/v4/Cdkv4WSIInkRecognizer';\nimport eventCallback from '../callback/EventCallback';\n\n/**\n * Current behavior\n * @typedef {Object} Behavior\n * @property {Grabber} grabber Grabber to capture strokes\n * @property {Stroker} stroker Stroker to draw stroke\n * @property {Renderer} renderer Renderer to draw on the editor\n * @property {Recognizer} recognizer Recognizer to call the recognition service\n * @property {Array} callbacks Functions to handle model changes\n */\n\n/**\n * Set of behaviors to be used by the {@link Editor}\n * @typedef {Object} Behaviors\n * @property {Grabber} grabber Grabber to capture strokes\n * @property {Array<Stroker>} strokerList List of stroker to draw stroke\n * @property {Array<Renderer>} rendererList List of renderer to draw on the editor\n * @property {Array<Recognizer>} recognizerList Recognizers to call the recognition service\n * @property {function(behaviors: Behaviors, configuration: Configuration): Behavior} getBehaviorFromConfiguration Get the current behavior to use regarding the current configuration\n * @property {Array} callbacks Functions to handle model changes\n */\n\n/**\n * Default behaviors\n * @type {Behaviors}\n */\nexport const defaultBehaviors = {\n  grabber: PointerEventGrabber,\n  strokerList: [QuadraticCanvasStroker, QuadraticSVGStroker],\n  rendererList: [CanvasRenderer, SVGRenderer],\n  recognizerList: [Cdkv3RestTextRecognizer, Cdkv3RestMathRecognizer, Cdkv3RestAnalyzerRecognizer, Cdkv3RestShapeRecognizer, Cdkv3RestMusicRecognizer, iinkRestRecognizer, Cdkv3WSTextRecognizer, Cdkv3WSMathRecognizer, Cdkv4WSInteractiveRecognizer],\n  callbacks: [eventCallback],\n  getBehaviorFromConfiguration: (behaviors, configuration) => {\n    const behavior = {};\n    behavior.grabber = behaviors.grabber;\n    if (configuration) {\n      if (configuration.recognitionParams.apiVersion === 'V4' && configuration.recognitionParams.protocol === 'REST') {\n        behavior.stroker = QuadraticCanvasStroker;\n      } else {\n        behavior.stroker = behaviors.strokerList.find(item =>\n          (item.getInfo().apiVersion === configuration.recognitionParams.apiVersion) &&\n          (item.getInfo().name === configuration.renderingParams.stroker));\n      }\n      if (configuration.recognitionParams.apiVersion === 'V4' && configuration.recognitionParams.protocol === 'REST') {\n        behavior.renderer = CanvasRenderer;\n      } else {\n        behavior.renderer = behaviors.rendererList.find(item => item.getInfo().apiVersion === configuration.recognitionParams.apiVersion);\n      }\n      behavior.recognizer = behaviors.recognizerList.find(item =>\n        (item.getInfo()\n          .types\n          .includes(configuration.recognitionParams.type)) &&\n        (item.getInfo().protocol === configuration.recognitionParams.protocol) &&\n        (item.getInfo().apiVersion === configuration.recognitionParams.apiVersion));\n    }\n    behavior.callbacks = behaviors.callbacks;\n    return behavior;\n  }\n};\n\n/**\n * Generate behaviors\n * @param {Behaviors} behaviors Behaviors to be used\n * @return {Behaviors} Overridden behaviors\n */\nexport function overrideDefaultBehaviors(behaviors) {\n  if (behaviors) {\n    const currentBehaviors = {\n      grabber: behaviors.grabber || defaultBehaviors.grabber,\n      rendererList: behaviors.rendererList || defaultBehaviors.rendererList,\n      strokerList: behaviors.strokerList || defaultBehaviors.strokerList,\n      recognizerList: behaviors.recognizerList || defaultBehaviors.recognizerList,\n      callbacks: behaviors.callbacks || defaultBehaviors.callbacks,\n      getBehaviorFromConfiguration: behaviors.getBehaviorFromConfiguration || defaultBehaviors.getBehaviorFromConfiguration\n    };\n    logger.debug('Override default behaviors', currentBehaviors);\n    return currentBehaviors;\n  }\n  return defaultBehaviors;\n}\n\nexport default defaultBehaviors;\n","import { callbackLogger as logger } from '../configuration/LoggerConfig';\n\n/**\n * Emits an event when the editor state change\n * @param {String} type\n * @param {Object} data\n * @emits {Event}\n */\nexport default function eventCallback(type, data) {\n  logger.info(`emitting ${type} event`, data);\n  // We are making usage of a browser provided class\n  // eslint-disable-next-line no-undef\n  this.dispatchEvent(new CustomEvent(type, Object.assign({ bubbles: true, composed: true }, data ? { detail: data } : undefined)));\n}\n","import { modelLogger as logger } from '../configuration/LoggerConfig';\n\n/**\n * Undo/redo context\n * @typedef {Object} UndoRedoContext\n * @property {Array<Model>} stack=[] List of processed models.\n * @property {Number} currentPosition=-1 Current model index into the stack.\n * @property {Number} maxSize Max size of the stack.\n * @property {Boolean} canUndo=false\n * @property {Boolean} canRedo=false\n */\n\n/**\n * Create a new undo/redo context\n * @param {Configuration} configuration Current configuration\n * @return {UndoRedoContext} New undo/redo context\n */\nexport function createUndoRedoContext(configuration) {\n  return {\n    stack: [],\n    currentPosition: -1,\n    maxSize: configuration.undoRedoMaxStackSize,\n    canUndo: false,\n    canRedo: false\n  };\n}\n\n/**\n * Update the undo/redo state\n * @param {UndoRedoContext} undoRedoContext Current undo/redo context\n * @return {UndoRedoContext} Updated undo/redo context\n */\nexport function updateUndoRedoState(undoRedoContext) {\n  const undoRedoContextRef = undoRedoContext;\n  undoRedoContextRef.canUndo = undoRedoContext.currentPosition > 0;\n  undoRedoContextRef.canRedo = undoRedoContext.currentPosition < (undoRedoContext.stack.length - 1);\n  return undoRedoContextRef;\n}\n","import * as InkModel from '../model/InkModel';\nimport * as UndoRedoContext from '../model/UndoRedoContext';\nimport { modelLogger as logger } from '../configuration/LoggerConfig';\nimport Constants from '../configuration/Constants';\n\n/**\n * Undo/redo manager\n * @typedef {Object} UndoRedoManager\n * @property {function(undoRedoContext: UndoRedoContext, model: Model, callback: RecognizerCallback)} updateModel Push the current model into the undo/redo context.\n * @property {function(undoRedoContext: UndoRedoContext, model: Model, callback: RecognizerCallback)} undo Undo.\n * @property {function(undoRedoContext: UndoRedoContext, model: Model, callback: RecognizerCallback)} redo Redo.\n * @property {function(undoRedoContext: UndoRedoContext, model: Model, callback: RecognizerCallback)} clear Clear.\n */\n\n/**\n * Get current model in stack\n * @param {UndoRedoContext} undoRedoContext Current undo/redo context\n * @param {function(err: Object, res: Model, types: ...String)} callback\n * @param {Boolean} [clone=true] Whether or not to clone the model\n * @param {...String} types\n */\nexport function getModel(undoRedoContext, callback, clone = true, ...types) {\n  const model = undoRedoContext.stack[undoRedoContext.currentPosition];\n  callback(undefined, clone ? InkModel.cloneModel(model) : model, ...types);\n}\n\n/**\n * Mutate the undoRedo stack by adding a new model to it.\n * @param {UndoRedoContext} undoRedoContext Current undo/redo context.\n * @param {Model} model Current model.\n * @param {function(err: Object, res: Model, types: ...String)} callback\n */\nexport function updateModel(undoRedoContext, model, callback) {\n  // Used to update the model with the recognition result if relevant\n  const modelIndex = undoRedoContext.stack.findIndex(item => (item.modificationTime === model.modificationTime) && (item.rawStrokes.length === model.rawStrokes.length));\n\n  const modelReference = model;\n  modelReference.modificationTime = new Date().getTime();\n\n  const types = [];\n  if (modelIndex > -1) {\n    undoRedoContext.stack.splice(modelIndex, 1, InkModel.cloneModel(modelReference));\n    logger.debug('model updated', modelReference);\n  } else {\n    const undoRedoContextReference = undoRedoContext;\n    undoRedoContextReference.currentPosition += 1;\n    undoRedoContextReference.stack = undoRedoContextReference.stack.slice(0, undoRedoContextReference.currentPosition);\n    undoRedoContextReference.stack.push(InkModel.cloneModel(modelReference));\n    if (undoRedoContextReference.stack.length > undoRedoContextReference.maxSize) {\n      undoRedoContextReference.stack.shift();\n      undoRedoContextReference.currentPosition--;\n    }\n    logger.debug('model pushed', modelReference);\n    types.push(Constants.EventType.CHANGED);\n  }\n  UndoRedoContext.updateUndoRedoState(undoRedoContext);\n  logger.debug('undo/redo stack updated', undoRedoContext);\n  getModel(undoRedoContext, callback, false, ...types);\n}\n\n/**\n * Undo\n * @param {UndoRedoContext} undoRedoContext Current undo/redo context.\n * @param {Model} model Current model.\n * @param {function(err: Object, res: Model, types: ...String)} callback\n */\nexport function undo(undoRedoContext, model, callback) {\n  const undoRedoContextReference = undoRedoContext;\n  if (undoRedoContextReference.currentPosition > 0) {\n    undoRedoContextReference.currentPosition -= 1;\n    UndoRedoContext.updateUndoRedoState(undoRedoContext);\n    logger.debug('undo index', undoRedoContextReference.currentPosition);\n  }\n  getModel(undoRedoContext, callback, true, Constants.EventType.CHANGED, Constants.EventType.EXPORTED);\n}\n\n/**\n * Redo\n * @param {UndoRedoContext} undoRedoContext Current undo/redo context.\n * @param {Model} model Current model.\n * @param {function(err: Object, res: Model, types: ...String)} callback\n */\nexport function redo(undoRedoContext, model, callback) {\n  const undoRedoContextReference = undoRedoContext;\n  if (undoRedoContextReference.currentPosition < undoRedoContextReference.stack.length - 1) {\n    undoRedoContextReference.currentPosition += 1;\n    UndoRedoContext.updateUndoRedoState(undoRedoContext);\n    logger.debug('redo index', undoRedoContextReference.currentPosition);\n  }\n  getModel(undoRedoContext, callback, true, Constants.EventType.CHANGED, Constants.EventType.EXPORTED);\n}\n","import { drawModel } from './CanvasRenderer';\nimport * as InkModel from '../../model/InkModel';\n\nfunction createCanvas(borderCoordinates, margin = 10) {\n  // eslint-disable-next-line no-undef\n  const browserDocument = document;\n  const canvas = browserDocument.createElement('canvas');\n  canvas.width = Math.abs(borderCoordinates.maxX - borderCoordinates.minX) + (2 * margin);\n  canvas.style.width = `${canvas.width}px`;\n  canvas.height = Math.abs(borderCoordinates.maxY - borderCoordinates.minY) + (2 * margin);\n  canvas.style.height = `${canvas.height}px`;\n  return canvas;\n}\n\n/**\n * Generate a PNG image data url from the model\n * @param {Model} model Current model\n * @param {Stroker} stroker Current stroker\n * @param {Number} [margin=10] Margins to apply around the image\n * @return {String} Image data string result\n */\nexport function getImage(model, stroker, margin = 10) {\n  if (model.rawStrokes.length > 0) {\n    const borderCoordinates = InkModel.getBorderCoordinates(model);\n\n    const capturingCanvas = createCanvas(borderCoordinates, margin);\n    const renderingCanvas = createCanvas(borderCoordinates, margin);\n    const renderStructure = {\n      renderingCanvas,\n      renderingCanvasContext: renderingCanvas.getContext('2d'),\n      capturingCanvas,\n      capturingCanvasContext: capturingCanvas.getContext('2d')\n    };\n    // Change canvas origin\n    renderStructure.renderingCanvasContext.translate(-borderCoordinates.minX + margin, -borderCoordinates.minY + margin);\n    drawModel(renderStructure, model, stroker);\n    return renderStructure.renderingCanvas.toDataURL('image/png');\n  }\n  return null;\n}\n","/*!\n * perfect-scrollbar v1.3.0\n * (c) 2017 Hyunje Jun\n * @license MIT\n */\nfunction get(element) {\n  return getComputedStyle(element);\n}\n\nfunction set(element, obj) {\n  for (var key in obj) {\n    var val = obj[key];\n    if (typeof val === 'number') {\n      val = val + \"px\";\n    }\n    element.style[key] = val;\n  }\n  return element;\n}\n\nfunction div(className) {\n  var div = document.createElement('div');\n  div.className = className;\n  return div;\n}\n\nvar elMatches =\n  typeof Element !== 'undefined' &&\n  (Element.prototype.matches ||\n    Element.prototype.webkitMatchesSelector ||\n    Element.prototype.msMatchesSelector);\n\nfunction matches(element, query) {\n  if (!elMatches) {\n    throw new Error('No element matching method supported');\n  }\n\n  return elMatches.call(element, query);\n}\n\nfunction remove(element) {\n  if (element.remove) {\n    element.remove();\n  } else {\n    if (element.parentNode) {\n      element.parentNode.removeChild(element);\n    }\n  }\n}\n\nfunction queryChildren(element, selector) {\n  return Array.prototype.filter.call(element.children, function (child) { return matches(child, selector); }\n  );\n}\n\nvar cls = {\n  main: 'ps',\n  element: {\n    thumb: function (x) { return (\"ps__thumb-\" + x); },\n    rail: function (x) { return (\"ps__rail-\" + x); },\n    consuming: 'ps__child--consume',\n  },\n  state: {\n    focus: 'ps--focus',\n    active: function (x) { return (\"ps--active-\" + x); },\n    scrolling: function (x) { return (\"ps--scrolling-\" + x); },\n  },\n};\n\n/*\n * Helper methods\n */\nvar scrollingClassTimeout = { x: null, y: null };\n\nfunction addScrollingClass(i, x) {\n  var classList = i.element.classList;\n  var className = cls.state.scrolling(x);\n\n  if (classList.contains(className)) {\n    clearTimeout(scrollingClassTimeout[x]);\n  } else {\n    classList.add(className);\n  }\n}\n\nfunction removeScrollingClass(i, x) {\n  scrollingClassTimeout[x] = setTimeout(\n    function () { return i.isAlive && i.element.classList.remove(cls.state.scrolling(x)); },\n    i.settings.scrollingThreshold\n  );\n}\n\nfunction setScrollingClassInstantly(i, x) {\n  addScrollingClass(i, x);\n  removeScrollingClass(i, x);\n}\n\nvar EventElement = function EventElement(element) {\n  this.element = element;\n  this.handlers = {};\n};\n\nvar prototypeAccessors = { isEmpty: { configurable: true } };\n\nEventElement.prototype.bind = function bind (eventName, handler) {\n  if (typeof this.handlers[eventName] === 'undefined') {\n    this.handlers[eventName] = [];\n  }\n  this.handlers[eventName].push(handler);\n  this.element.addEventListener(eventName, handler, false);\n};\n\nEventElement.prototype.unbind = function unbind (eventName, target) {\n    var this$1 = this;\n\n  this.handlers[eventName] = this.handlers[eventName].filter(function (handler) {\n    if (target && handler !== target) {\n      return true;\n    }\n    this$1.element.removeEventListener(eventName, handler, false);\n    return false;\n  });\n};\n\nEventElement.prototype.unbindAll = function unbindAll () {\n    var this$1 = this;\n\n  for (var name in this$1.handlers) {\n    this$1.unbind(name);\n  }\n};\n\nprototypeAccessors.isEmpty.get = function () {\n    var this$1 = this;\n\n  return Object.keys(this.handlers).every(\n    function (key) { return this$1.handlers[key].length === 0; }\n  );\n};\n\nObject.defineProperties( EventElement.prototype, prototypeAccessors );\n\nvar EventManager = function EventManager() {\n  this.eventElements = [];\n};\n\nEventManager.prototype.eventElement = function eventElement (element) {\n  var ee = this.eventElements.filter(function (ee) { return ee.element === element; })[0];\n  if (!ee) {\n    ee = new EventElement(element);\n    this.eventElements.push(ee);\n  }\n  return ee;\n};\n\nEventManager.prototype.bind = function bind (element, eventName, handler) {\n  this.eventElement(element).bind(eventName, handler);\n};\n\nEventManager.prototype.unbind = function unbind (element, eventName, handler) {\n  var ee = this.eventElement(element);\n  ee.unbind(eventName, handler);\n\n  if (ee.isEmpty) {\n    // remove\n    this.eventElements.splice(this.eventElements.indexOf(ee), 1);\n  }\n};\n\nEventManager.prototype.unbindAll = function unbindAll () {\n  this.eventElements.forEach(function (e) { return e.unbindAll(); });\n  this.eventElements = [];\n};\n\nEventManager.prototype.once = function once (element, eventName, handler) {\n  var ee = this.eventElement(element);\n  var onceHandler = function (evt) {\n    ee.unbind(eventName, onceHandler);\n    handler(evt);\n  };\n  ee.bind(eventName, onceHandler);\n};\n\nfunction createEvent(name) {\n  if (typeof window.CustomEvent === 'function') {\n    return new CustomEvent(name);\n  } else {\n    var evt = document.createEvent('CustomEvent');\n    evt.initCustomEvent(name, false, false, undefined);\n    return evt;\n  }\n}\n\nvar processScrollDiff = function(\n  i,\n  axis,\n  diff,\n  useScrollingClass,\n  forceFireReachEvent\n) {\n  if ( useScrollingClass === void 0 ) useScrollingClass = true;\n  if ( forceFireReachEvent === void 0 ) forceFireReachEvent = false;\n\n  var fields;\n  if (axis === 'top') {\n    fields = [\n      'contentHeight',\n      'containerHeight',\n      'scrollTop',\n      'y',\n      'up',\n      'down' ];\n  } else if (axis === 'left') {\n    fields = [\n      'contentWidth',\n      'containerWidth',\n      'scrollLeft',\n      'x',\n      'left',\n      'right' ];\n  } else {\n    throw new Error('A proper axis should be provided');\n  }\n\n  processScrollDiff$1(i, diff, fields, useScrollingClass, forceFireReachEvent);\n};\n\nfunction processScrollDiff$1(\n  i,\n  diff,\n  ref,\n  useScrollingClass,\n  forceFireReachEvent\n) {\n  var contentHeight = ref[0];\n  var containerHeight = ref[1];\n  var scrollTop = ref[2];\n  var y = ref[3];\n  var up = ref[4];\n  var down = ref[5];\n  if ( useScrollingClass === void 0 ) useScrollingClass = true;\n  if ( forceFireReachEvent === void 0 ) forceFireReachEvent = false;\n\n  var element = i.element;\n\n  // reset reach\n  i.reach[y] = null;\n\n  // 1 for subpixel rounding\n  if (element[scrollTop] < 1) {\n    i.reach[y] = 'start';\n  }\n\n  // 1 for subpixel rounding\n  if (element[scrollTop] > i[contentHeight] - i[containerHeight] - 1) {\n    i.reach[y] = 'end';\n  }\n\n  if (diff) {\n    element.dispatchEvent(createEvent((\"ps-scroll-\" + y)));\n\n    if (diff < 0) {\n      element.dispatchEvent(createEvent((\"ps-scroll-\" + up)));\n    } else if (diff > 0) {\n      element.dispatchEvent(createEvent((\"ps-scroll-\" + down)));\n    }\n\n    if (useScrollingClass) {\n      setScrollingClassInstantly(i, y);\n    }\n  }\n\n  if (i.reach[y] && (diff || forceFireReachEvent)) {\n    element.dispatchEvent(createEvent((\"ps-\" + y + \"-reach-\" + (i.reach[y]))));\n  }\n}\n\nfunction toInt(x) {\n  return parseInt(x, 10) || 0;\n}\n\nfunction isEditable(el) {\n  return (\n    matches(el, 'input,[contenteditable]') ||\n    matches(el, 'select,[contenteditable]') ||\n    matches(el, 'textarea,[contenteditable]') ||\n    matches(el, 'button,[contenteditable]')\n  );\n}\n\nfunction outerWidth(element) {\n  var styles = get(element);\n  return (\n    toInt(styles.width) +\n    toInt(styles.paddingLeft) +\n    toInt(styles.paddingRight) +\n    toInt(styles.borderLeftWidth) +\n    toInt(styles.borderRightWidth)\n  );\n}\n\nvar env = {\n  isWebKit:\n    typeof document !== 'undefined' &&\n    'WebkitAppearance' in document.documentElement.style,\n  supportsTouch:\n    typeof window !== 'undefined' &&\n    ('ontouchstart' in window ||\n      (window.DocumentTouch && document instanceof window.DocumentTouch)),\n  supportsIePointer:\n    typeof navigator !== 'undefined' && navigator.msMaxTouchPoints,\n  isChrome:\n    typeof navigator !== 'undefined' &&\n    /Chrome/i.test(navigator && navigator.userAgent),\n};\n\nvar updateGeometry = function(i) {\n  var element = i.element;\n\n  i.containerWidth = element.clientWidth;\n  i.containerHeight = element.clientHeight;\n  i.contentWidth = element.scrollWidth;\n  i.contentHeight = element.scrollHeight;\n\n  if (!element.contains(i.scrollbarXRail)) {\n    // clean up and append\n    queryChildren(element, cls.element.rail('x')).forEach(function (el) { return remove(el); }\n    );\n    element.appendChild(i.scrollbarXRail);\n  }\n  if (!element.contains(i.scrollbarYRail)) {\n    // clean up and append\n    queryChildren(element, cls.element.rail('y')).forEach(function (el) { return remove(el); }\n    );\n    element.appendChild(i.scrollbarYRail);\n  }\n\n  if (\n    !i.settings.suppressScrollX &&\n    i.containerWidth + i.settings.scrollXMarginOffset < i.contentWidth\n  ) {\n    i.scrollbarXActive = true;\n    i.railXWidth = i.containerWidth - i.railXMarginWidth;\n    i.railXRatio = i.containerWidth / i.railXWidth;\n    i.scrollbarXWidth = getThumbSize(\n      i,\n      toInt(i.railXWidth * i.containerWidth / i.contentWidth)\n    );\n    i.scrollbarXLeft = toInt(\n      (i.negativeScrollAdjustment + element.scrollLeft) *\n        (i.railXWidth - i.scrollbarXWidth) /\n        (i.contentWidth - i.containerWidth)\n    );\n  } else {\n    i.scrollbarXActive = false;\n  }\n\n  if (\n    !i.settings.suppressScrollY &&\n    i.containerHeight + i.settings.scrollYMarginOffset < i.contentHeight\n  ) {\n    i.scrollbarYActive = true;\n    i.railYHeight = i.containerHeight - i.railYMarginHeight;\n    i.railYRatio = i.containerHeight / i.railYHeight;\n    i.scrollbarYHeight = getThumbSize(\n      i,\n      toInt(i.railYHeight * i.containerHeight / i.contentHeight)\n    );\n    i.scrollbarYTop = toInt(\n      element.scrollTop *\n        (i.railYHeight - i.scrollbarYHeight) /\n        (i.contentHeight - i.containerHeight)\n    );\n  } else {\n    i.scrollbarYActive = false;\n  }\n\n  if (i.scrollbarXLeft >= i.railXWidth - i.scrollbarXWidth) {\n    i.scrollbarXLeft = i.railXWidth - i.scrollbarXWidth;\n  }\n  if (i.scrollbarYTop >= i.railYHeight - i.scrollbarYHeight) {\n    i.scrollbarYTop = i.railYHeight - i.scrollbarYHeight;\n  }\n\n  updateCss(element, i);\n\n  if (i.scrollbarXActive) {\n    element.classList.add(cls.state.active('x'));\n  } else {\n    element.classList.remove(cls.state.active('x'));\n    i.scrollbarXWidth = 0;\n    i.scrollbarXLeft = 0;\n    element.scrollLeft = 0;\n  }\n  if (i.scrollbarYActive) {\n    element.classList.add(cls.state.active('y'));\n  } else {\n    element.classList.remove(cls.state.active('y'));\n    i.scrollbarYHeight = 0;\n    i.scrollbarYTop = 0;\n    element.scrollTop = 0;\n  }\n};\n\nfunction getThumbSize(i, thumbSize) {\n  if (i.settings.minScrollbarLength) {\n    thumbSize = Math.max(thumbSize, i.settings.minScrollbarLength);\n  }\n  if (i.settings.maxScrollbarLength) {\n    thumbSize = Math.min(thumbSize, i.settings.maxScrollbarLength);\n  }\n  return thumbSize;\n}\n\nfunction updateCss(element, i) {\n  var xRailOffset = { width: i.railXWidth };\n  if (i.isRtl) {\n    xRailOffset.left =\n      i.negativeScrollAdjustment +\n      element.scrollLeft +\n      i.containerWidth -\n      i.contentWidth;\n  } else {\n    xRailOffset.left = element.scrollLeft;\n  }\n  if (i.isScrollbarXUsingBottom) {\n    xRailOffset.bottom = i.scrollbarXBottom - element.scrollTop;\n  } else {\n    xRailOffset.top = i.scrollbarXTop + element.scrollTop;\n  }\n  set(i.scrollbarXRail, xRailOffset);\n\n  var yRailOffset = { top: element.scrollTop, height: i.railYHeight };\n  if (i.isScrollbarYUsingRight) {\n    if (i.isRtl) {\n      yRailOffset.right =\n        i.contentWidth -\n        (i.negativeScrollAdjustment + element.scrollLeft) -\n        i.scrollbarYRight -\n        i.scrollbarYOuterWidth;\n    } else {\n      yRailOffset.right = i.scrollbarYRight - element.scrollLeft;\n    }\n  } else {\n    if (i.isRtl) {\n      yRailOffset.left =\n        i.negativeScrollAdjustment +\n        element.scrollLeft +\n        i.containerWidth * 2 -\n        i.contentWidth -\n        i.scrollbarYLeft -\n        i.scrollbarYOuterWidth;\n    } else {\n      yRailOffset.left = i.scrollbarYLeft + element.scrollLeft;\n    }\n  }\n  set(i.scrollbarYRail, yRailOffset);\n\n  set(i.scrollbarX, {\n    left: i.scrollbarXLeft,\n    width: i.scrollbarXWidth - i.railBorderXWidth,\n  });\n  set(i.scrollbarY, {\n    top: i.scrollbarYTop,\n    height: i.scrollbarYHeight - i.railBorderYWidth,\n  });\n}\n\nvar clickRail = function(i) {\n  i.event.bind(i.scrollbarY, 'mousedown', function (e) { return e.stopPropagation(); });\n  i.event.bind(i.scrollbarYRail, 'mousedown', function (e) {\n    var positionTop =\n      e.pageY -\n      window.pageYOffset -\n      i.scrollbarYRail.getBoundingClientRect().top;\n    var direction = positionTop > i.scrollbarYTop ? 1 : -1;\n\n    i.element.scrollTop += direction * i.containerHeight;\n    updateGeometry(i);\n\n    e.stopPropagation();\n  });\n\n  i.event.bind(i.scrollbarX, 'mousedown', function (e) { return e.stopPropagation(); });\n  i.event.bind(i.scrollbarXRail, 'mousedown', function (e) {\n    var positionLeft =\n      e.pageX -\n      window.pageXOffset -\n      i.scrollbarXRail.getBoundingClientRect().left;\n    var direction = positionLeft > i.scrollbarXLeft ? 1 : -1;\n\n    i.element.scrollLeft += direction * i.containerWidth;\n    updateGeometry(i);\n\n    e.stopPropagation();\n  });\n};\n\nvar dragThumb = function(i) {\n  bindMouseScrollHandler(i, [\n    'containerWidth',\n    'contentWidth',\n    'pageX',\n    'railXWidth',\n    'scrollbarX',\n    'scrollbarXWidth',\n    'scrollLeft',\n    'x' ]);\n  bindMouseScrollHandler(i, [\n    'containerHeight',\n    'contentHeight',\n    'pageY',\n    'railYHeight',\n    'scrollbarY',\n    'scrollbarYHeight',\n    'scrollTop',\n    'y' ]);\n};\n\nfunction bindMouseScrollHandler(\n  i,\n  ref\n) {\n  var containerHeight = ref[0];\n  var contentHeight = ref[1];\n  var pageY = ref[2];\n  var railYHeight = ref[3];\n  var scrollbarY = ref[4];\n  var scrollbarYHeight = ref[5];\n  var scrollTop = ref[6];\n  var y = ref[7];\n\n  var element = i.element;\n\n  var startingScrollTop = null;\n  var startingMousePageY = null;\n  var scrollBy = null;\n\n  function mouseMoveHandler(e) {\n    element[scrollTop] =\n      startingScrollTop + scrollBy * (e[pageY] - startingMousePageY);\n    addScrollingClass(i, y);\n    updateGeometry(i);\n\n    e.stopPropagation();\n    e.preventDefault();\n  }\n\n  function mouseUpHandler() {\n    removeScrollingClass(i, y);\n    i.event.unbind(i.ownerDocument, 'mousemove', mouseMoveHandler);\n  }\n\n  i.event.bind(i[scrollbarY], 'mousedown', function (e) {\n    startingScrollTop = element[scrollTop];\n    startingMousePageY = e[pageY];\n    scrollBy =\n      (i[contentHeight] - i[containerHeight]) /\n      (i[railYHeight] - i[scrollbarYHeight]);\n\n    i.event.bind(i.ownerDocument, 'mousemove', mouseMoveHandler);\n    i.event.once(i.ownerDocument, 'mouseup', mouseUpHandler);\n\n    e.stopPropagation();\n    e.preventDefault();\n  });\n}\n\nvar keyboard = function(i) {\n  var element = i.element;\n\n  var elementHovered = function () { return matches(element, ':hover'); };\n  var scrollbarFocused = function () { return matches(i.scrollbarX, ':focus') || matches(i.scrollbarY, ':focus'); };\n\n  function shouldPreventDefault(deltaX, deltaY) {\n    var scrollTop = element.scrollTop;\n    if (deltaX === 0) {\n      if (!i.scrollbarYActive) {\n        return false;\n      }\n      if (\n        (scrollTop === 0 && deltaY > 0) ||\n        (scrollTop >= i.contentHeight - i.containerHeight && deltaY < 0)\n      ) {\n        return !i.settings.wheelPropagation;\n      }\n    }\n\n    var scrollLeft = element.scrollLeft;\n    if (deltaY === 0) {\n      if (!i.scrollbarXActive) {\n        return false;\n      }\n      if (\n        (scrollLeft === 0 && deltaX < 0) ||\n        (scrollLeft >= i.contentWidth - i.containerWidth && deltaX > 0)\n      ) {\n        return !i.settings.wheelPropagation;\n      }\n    }\n    return true;\n  }\n\n  i.event.bind(i.ownerDocument, 'keydown', function (e) {\n    if (\n      (e.isDefaultPrevented && e.isDefaultPrevented()) ||\n      e.defaultPrevented\n    ) {\n      return;\n    }\n\n    if (!elementHovered() && !scrollbarFocused()) {\n      return;\n    }\n\n    var activeElement = document.activeElement\n      ? document.activeElement\n      : i.ownerDocument.activeElement;\n    if (activeElement) {\n      if (activeElement.tagName === 'IFRAME') {\n        activeElement = activeElement.contentDocument.activeElement;\n      } else {\n        // go deeper if element is a webcomponent\n        while (activeElement.shadowRoot) {\n          activeElement = activeElement.shadowRoot.activeElement;\n        }\n      }\n      if (isEditable(activeElement)) {\n        return;\n      }\n    }\n\n    var deltaX = 0;\n    var deltaY = 0;\n\n    switch (e.which) {\n      case 37: // left\n        if (e.metaKey) {\n          deltaX = -i.contentWidth;\n        } else if (e.altKey) {\n          deltaX = -i.containerWidth;\n        } else {\n          deltaX = -30;\n        }\n        break;\n      case 38: // up\n        if (e.metaKey) {\n          deltaY = i.contentHeight;\n        } else if (e.altKey) {\n          deltaY = i.containerHeight;\n        } else {\n          deltaY = 30;\n        }\n        break;\n      case 39: // right\n        if (e.metaKey) {\n          deltaX = i.contentWidth;\n        } else if (e.altKey) {\n          deltaX = i.containerWidth;\n        } else {\n          deltaX = 30;\n        }\n        break;\n      case 40: // down\n        if (e.metaKey) {\n          deltaY = -i.contentHeight;\n        } else if (e.altKey) {\n          deltaY = -i.containerHeight;\n        } else {\n          deltaY = -30;\n        }\n        break;\n      case 32: // space bar\n        if (e.shiftKey) {\n          deltaY = i.containerHeight;\n        } else {\n          deltaY = -i.containerHeight;\n        }\n        break;\n      case 33: // page up\n        deltaY = i.containerHeight;\n        break;\n      case 34: // page down\n        deltaY = -i.containerHeight;\n        break;\n      case 36: // home\n        deltaY = i.contentHeight;\n        break;\n      case 35: // end\n        deltaY = -i.contentHeight;\n        break;\n      default:\n        return;\n    }\n\n    if (i.settings.suppressScrollX && deltaX !== 0) {\n      return;\n    }\n    if (i.settings.suppressScrollY && deltaY !== 0) {\n      return;\n    }\n\n    element.scrollTop -= deltaY;\n    element.scrollLeft += deltaX;\n    updateGeometry(i);\n\n    if (shouldPreventDefault(deltaX, deltaY)) {\n      e.preventDefault();\n    }\n  });\n};\n\nvar wheel = function(i) {\n  var element = i.element;\n\n  function shouldPreventDefault(deltaX, deltaY) {\n    var isTop = element.scrollTop === 0;\n    var isBottom =\n      element.scrollTop + element.offsetHeight === element.scrollHeight;\n    var isLeft = element.scrollLeft === 0;\n    var isRight =\n      element.scrollLeft + element.offsetWidth === element.offsetWidth;\n\n    var hitsBound;\n\n    // pick axis with primary direction\n    if (Math.abs(deltaY) > Math.abs(deltaX)) {\n      hitsBound = isTop || isBottom;\n    } else {\n      hitsBound = isLeft || isRight;\n    }\n\n    return hitsBound ? !i.settings.wheelPropagation : true;\n  }\n\n  function getDeltaFromEvent(e) {\n    var deltaX = e.deltaX;\n    var deltaY = -1 * e.deltaY;\n\n    if (typeof deltaX === 'undefined' || typeof deltaY === 'undefined') {\n      // OS X Safari\n      deltaX = -1 * e.wheelDeltaX / 6;\n      deltaY = e.wheelDeltaY / 6;\n    }\n\n    if (e.deltaMode && e.deltaMode === 1) {\n      // Firefox in deltaMode 1: Line scrolling\n      deltaX *= 10;\n      deltaY *= 10;\n    }\n\n    if (deltaX !== deltaX && deltaY !== deltaY /* NaN checks */) {\n      // IE in some mouse drivers\n      deltaX = 0;\n      deltaY = e.wheelDelta;\n    }\n\n    if (e.shiftKey) {\n      // reverse axis with shift key\n      return [-deltaY, -deltaX];\n    }\n    return [deltaX, deltaY];\n  }\n\n  function shouldBeConsumedByChild(target, deltaX, deltaY) {\n    // FIXME: this is a workaround for <select> issue in FF and IE #571\n    if (!env.isWebKit && element.querySelector('select:focus')) {\n      return true;\n    }\n\n    if (!element.contains(target)) {\n      return false;\n    }\n\n    var cursor = target;\n\n    while (cursor && cursor !== element) {\n      if (cursor.classList.contains(cls.element.consuming)) {\n        return true;\n      }\n\n      var style = get(cursor);\n      var overflow = [style.overflow, style.overflowX, style.overflowY].join(\n        ''\n      );\n\n      // if scrollable\n      if (overflow.match(/(scroll|auto)/)) {\n        var maxScrollTop = cursor.scrollHeight - cursor.clientHeight;\n        if (maxScrollTop > 0) {\n          if (\n            !(cursor.scrollTop === 0 && deltaY > 0) &&\n            !(cursor.scrollTop === maxScrollTop && deltaY < 0)\n          ) {\n            return true;\n          }\n        }\n        var maxScrollLeft = cursor.scrollLeft - cursor.clientWidth;\n        if (maxScrollLeft > 0) {\n          if (\n            !(cursor.scrollLeft === 0 && deltaX < 0) &&\n            !(cursor.scrollLeft === maxScrollLeft && deltaX > 0)\n          ) {\n            return true;\n          }\n        }\n      }\n\n      cursor = cursor.parentNode;\n    }\n\n    return false;\n  }\n\n  function mousewheelHandler(e) {\n    var ref = getDeltaFromEvent(e);\n    var deltaX = ref[0];\n    var deltaY = ref[1];\n\n    if (shouldBeConsumedByChild(e.target, deltaX, deltaY)) {\n      return;\n    }\n\n    var shouldPrevent = false;\n    if (!i.settings.useBothWheelAxes) {\n      // deltaX will only be used for horizontal scrolling and deltaY will\n      // only be used for vertical scrolling - this is the default\n      element.scrollTop -= deltaY * i.settings.wheelSpeed;\n      element.scrollLeft += deltaX * i.settings.wheelSpeed;\n    } else if (i.scrollbarYActive && !i.scrollbarXActive) {\n      // only vertical scrollbar is active and useBothWheelAxes option is\n      // active, so let's scroll vertical bar using both mouse wheel axes\n      if (deltaY) {\n        element.scrollTop -= deltaY * i.settings.wheelSpeed;\n      } else {\n        element.scrollTop += deltaX * i.settings.wheelSpeed;\n      }\n      shouldPrevent = true;\n    } else if (i.scrollbarXActive && !i.scrollbarYActive) {\n      // useBothWheelAxes and only horizontal bar is active, so use both\n      // wheel axes for horizontal bar\n      if (deltaX) {\n        element.scrollLeft += deltaX * i.settings.wheelSpeed;\n      } else {\n        element.scrollLeft -= deltaY * i.settings.wheelSpeed;\n      }\n      shouldPrevent = true;\n    }\n\n    updateGeometry(i);\n\n    shouldPrevent = shouldPrevent || shouldPreventDefault(deltaX, deltaY);\n    if (shouldPrevent && !e.ctrlKey) {\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  }\n\n  if (typeof window.onwheel !== 'undefined') {\n    i.event.bind(element, 'wheel', mousewheelHandler);\n  } else if (typeof window.onmousewheel !== 'undefined') {\n    i.event.bind(element, 'mousewheel', mousewheelHandler);\n  }\n};\n\nvar touch = function(i) {\n  if (!env.supportsTouch && !env.supportsIePointer) {\n    return;\n  }\n\n  var element = i.element;\n\n  function shouldPrevent(deltaX, deltaY) {\n    var scrollTop = element.scrollTop;\n    var scrollLeft = element.scrollLeft;\n    var magnitudeX = Math.abs(deltaX);\n    var magnitudeY = Math.abs(deltaY);\n\n    if (magnitudeY > magnitudeX) {\n      // user is perhaps trying to swipe up/down the page\n\n      if (\n        (deltaY < 0 && scrollTop === i.contentHeight - i.containerHeight) ||\n        (deltaY > 0 && scrollTop === 0)\n      ) {\n        // set prevent for mobile Chrome refresh\n        return window.scrollY === 0 && deltaY > 0 && env.isChrome;\n      }\n    } else if (magnitudeX > magnitudeY) {\n      // user is perhaps trying to swipe left/right across the page\n\n      if (\n        (deltaX < 0 && scrollLeft === i.contentWidth - i.containerWidth) ||\n        (deltaX > 0 && scrollLeft === 0)\n      ) {\n        return true;\n      }\n    }\n\n    return true;\n  }\n\n  function applyTouchMove(differenceX, differenceY) {\n    element.scrollTop -= differenceY;\n    element.scrollLeft -= differenceX;\n\n    updateGeometry(i);\n  }\n\n  var startOffset = {};\n  var startTime = 0;\n  var speed = {};\n  var easingLoop = null;\n\n  function getTouch(e) {\n    if (e.targetTouches) {\n      return e.targetTouches[0];\n    } else {\n      // Maybe IE pointer\n      return e;\n    }\n  }\n\n  function shouldHandle(e) {\n    if (e.pointerType && e.pointerType === 'pen' && e.buttons === 0) {\n      return false;\n    }\n    if (e.targetTouches && e.targetTouches.length === 1) {\n      return true;\n    }\n    if (\n      e.pointerType &&\n      e.pointerType !== 'mouse' &&\n      e.pointerType !== e.MSPOINTER_TYPE_MOUSE\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  function touchStart(e) {\n    if (!shouldHandle(e)) {\n      return;\n    }\n\n    var touch = getTouch(e);\n\n    startOffset.pageX = touch.pageX;\n    startOffset.pageY = touch.pageY;\n\n    startTime = new Date().getTime();\n\n    if (easingLoop !== null) {\n      clearInterval(easingLoop);\n    }\n  }\n\n  function shouldBeConsumedByChild(target, deltaX, deltaY) {\n    if (!element.contains(target)) {\n      return false;\n    }\n\n    var cursor = target;\n\n    while (cursor && cursor !== element) {\n      if (cursor.classList.contains(cls.element.consuming)) {\n        return true;\n      }\n\n      var style = get(cursor);\n      var overflow = [style.overflow, style.overflowX, style.overflowY].join(\n        ''\n      );\n\n      // if scrollable\n      if (overflow.match(/(scroll|auto)/)) {\n        var maxScrollTop = cursor.scrollHeight - cursor.clientHeight;\n        if (maxScrollTop > 0) {\n          if (\n            !(cursor.scrollTop === 0 && deltaY > 0) &&\n            !(cursor.scrollTop === maxScrollTop && deltaY < 0)\n          ) {\n            return true;\n          }\n        }\n        var maxScrollLeft = cursor.scrollLeft - cursor.clientWidth;\n        if (maxScrollLeft > 0) {\n          if (\n            !(cursor.scrollLeft === 0 && deltaX < 0) &&\n            !(cursor.scrollLeft === maxScrollLeft && deltaX > 0)\n          ) {\n            return true;\n          }\n        }\n      }\n\n      cursor = cursor.parentNode;\n    }\n\n    return false;\n  }\n\n  function touchMove(e) {\n    if (shouldHandle(e)) {\n      var touch = getTouch(e);\n\n      var currentOffset = { pageX: touch.pageX, pageY: touch.pageY };\n\n      var differenceX = currentOffset.pageX - startOffset.pageX;\n      var differenceY = currentOffset.pageY - startOffset.pageY;\n\n      if (shouldBeConsumedByChild(e.target, differenceX, differenceY)) {\n        return;\n      }\n\n      applyTouchMove(differenceX, differenceY);\n      startOffset = currentOffset;\n\n      var currentTime = new Date().getTime();\n\n      var timeGap = currentTime - startTime;\n      if (timeGap > 0) {\n        speed.x = differenceX / timeGap;\n        speed.y = differenceY / timeGap;\n        startTime = currentTime;\n      }\n\n      if (shouldPrevent(differenceX, differenceY)) {\n        e.preventDefault();\n      }\n    }\n  }\n  function touchEnd() {\n    if (i.settings.swipeEasing) {\n      clearInterval(easingLoop);\n      easingLoop = setInterval(function() {\n        if (i.isInitialized) {\n          clearInterval(easingLoop);\n          return;\n        }\n\n        if (!speed.x && !speed.y) {\n          clearInterval(easingLoop);\n          return;\n        }\n\n        if (Math.abs(speed.x) < 0.01 && Math.abs(speed.y) < 0.01) {\n          clearInterval(easingLoop);\n          return;\n        }\n\n        applyTouchMove(speed.x * 30, speed.y * 30);\n\n        speed.x *= 0.8;\n        speed.y *= 0.8;\n      }, 10);\n    }\n  }\n\n  if (env.supportsTouch) {\n    i.event.bind(element, 'touchstart', touchStart);\n    i.event.bind(element, 'touchmove', touchMove);\n    i.event.bind(element, 'touchend', touchEnd);\n  } else if (env.supportsIePointer) {\n    if (window.PointerEvent) {\n      i.event.bind(element, 'pointerdown', touchStart);\n      i.event.bind(element, 'pointermove', touchMove);\n      i.event.bind(element, 'pointerup', touchEnd);\n    } else if (window.MSPointerEvent) {\n      i.event.bind(element, 'MSPointerDown', touchStart);\n      i.event.bind(element, 'MSPointerMove', touchMove);\n      i.event.bind(element, 'MSPointerUp', touchEnd);\n    }\n  }\n};\n\nvar defaultSettings = function () { return ({\n  handlers: ['click-rail', 'drag-thumb', 'keyboard', 'wheel', 'touch'],\n  maxScrollbarLength: null,\n  minScrollbarLength: null,\n  scrollingThreshold: 1000,\n  scrollXMarginOffset: 0,\n  scrollYMarginOffset: 0,\n  suppressScrollX: false,\n  suppressScrollY: false,\n  swipeEasing: true,\n  useBothWheelAxes: false,\n  wheelPropagation: false,\n  wheelSpeed: 1,\n}); };\n\nvar handlers = {\n  'click-rail': clickRail,\n  'drag-thumb': dragThumb,\n  keyboard: keyboard,\n  wheel: wheel,\n  touch: touch,\n};\n\nvar PerfectScrollbar = function PerfectScrollbar(element, userSettings) {\n  var this$1 = this;\n  if ( userSettings === void 0 ) userSettings = {};\n\n  if (typeof element === 'string') {\n    element = document.querySelector(element);\n  }\n\n  if (!element || !element.nodeName) {\n    throw new Error('no element is specified to initialize PerfectScrollbar');\n  }\n\n  this.element = element;\n\n  element.classList.add(cls.main);\n\n  this.settings = defaultSettings();\n  for (var key in userSettings) {\n    this$1.settings[key] = userSettings[key];\n  }\n\n  this.containerWidth = null;\n  this.containerHeight = null;\n  this.contentWidth = null;\n  this.contentHeight = null;\n\n  var focus = function () { return element.classList.add(cls.state.focus); };\n  var blur = function () { return element.classList.remove(cls.state.focus); };\n\n  this.isRtl = get(element).direction === 'rtl';\n  this.isNegativeScroll = (function () {\n    var originalScrollLeft = element.scrollLeft;\n    var result = null;\n    element.scrollLeft = -1;\n    result = element.scrollLeft < 0;\n    element.scrollLeft = originalScrollLeft;\n    return result;\n  })();\n  this.negativeScrollAdjustment = this.isNegativeScroll\n    ? element.scrollWidth - element.clientWidth\n    : 0;\n  this.event = new EventManager();\n  this.ownerDocument = element.ownerDocument || document;\n\n  this.scrollbarXRail = div(cls.element.rail('x'));\n  element.appendChild(this.scrollbarXRail);\n  this.scrollbarX = div(cls.element.thumb('x'));\n  this.scrollbarXRail.appendChild(this.scrollbarX);\n  this.scrollbarX.setAttribute('tabindex', 0);\n  this.event.bind(this.scrollbarX, 'focus', focus);\n  this.event.bind(this.scrollbarX, 'blur', blur);\n  this.scrollbarXActive = null;\n  this.scrollbarXWidth = null;\n  this.scrollbarXLeft = null;\n  var railXStyle = get(this.scrollbarXRail);\n  this.scrollbarXBottom = parseInt(railXStyle.bottom, 10);\n  if (isNaN(this.scrollbarXBottom)) {\n    this.isScrollbarXUsingBottom = false;\n    this.scrollbarXTop = toInt(railXStyle.top);\n  } else {\n    this.isScrollbarXUsingBottom = true;\n  }\n  this.railBorderXWidth =\n    toInt(railXStyle.borderLeftWidth) + toInt(railXStyle.borderRightWidth);\n  // Set rail to display:block to calculate margins\n  set(this.scrollbarXRail, { display: 'block' });\n  this.railXMarginWidth =\n    toInt(railXStyle.marginLeft) + toInt(railXStyle.marginRight);\n  set(this.scrollbarXRail, { display: '' });\n  this.railXWidth = null;\n  this.railXRatio = null;\n\n  this.scrollbarYRail = div(cls.element.rail('y'));\n  element.appendChild(this.scrollbarYRail);\n  this.scrollbarY = div(cls.element.thumb('y'));\n  this.scrollbarYRail.appendChild(this.scrollbarY);\n  this.scrollbarY.setAttribute('tabindex', 0);\n  this.event.bind(this.scrollbarY, 'focus', focus);\n  this.event.bind(this.scrollbarY, 'blur', blur);\n  this.scrollbarYActive = null;\n  this.scrollbarYHeight = null;\n  this.scrollbarYTop = null;\n  var railYStyle = get(this.scrollbarYRail);\n  this.scrollbarYRight = parseInt(railYStyle.right, 10);\n  if (isNaN(this.scrollbarYRight)) {\n    this.isScrollbarYUsingRight = false;\n    this.scrollbarYLeft = toInt(railYStyle.left);\n  } else {\n    this.isScrollbarYUsingRight = true;\n  }\n  this.scrollbarYOuterWidth = this.isRtl ? outerWidth(this.scrollbarY) : null;\n  this.railBorderYWidth =\n    toInt(railYStyle.borderTopWidth) + toInt(railYStyle.borderBottomWidth);\n  set(this.scrollbarYRail, { display: 'block' });\n  this.railYMarginHeight =\n    toInt(railYStyle.marginTop) + toInt(railYStyle.marginBottom);\n  set(this.scrollbarYRail, { display: '' });\n  this.railYHeight = null;\n  this.railYRatio = null;\n\n  this.reach = {\n    x:\n      element.scrollLeft <= 0\n        ? 'start'\n        : element.scrollLeft >= this.contentWidth - this.containerWidth\n          ? 'end'\n          : null,\n    y:\n      element.scrollTop <= 0\n        ? 'start'\n        : element.scrollTop >= this.contentHeight - this.containerHeight\n          ? 'end'\n          : null,\n  };\n\n  this.isAlive = true;\n\n  this.settings.handlers.forEach(function (handlerName) { return handlers[handlerName](this$1); });\n\n  this.lastScrollTop = element.scrollTop; // for onScroll only\n  this.lastScrollLeft = element.scrollLeft; // for onScroll only\n  this.event.bind(this.element, 'scroll', function (e) { return this$1.onScroll(e); });\n  updateGeometry(this);\n};\n\nPerfectScrollbar.prototype.update = function update () {\n  if (!this.isAlive) {\n    return;\n  }\n\n  // Recalcuate negative scrollLeft adjustment\n  this.negativeScrollAdjustment = this.isNegativeScroll\n    ? this.element.scrollWidth - this.element.clientWidth\n    : 0;\n\n  // Recalculate rail margins\n  set(this.scrollbarXRail, { display: 'block' });\n  set(this.scrollbarYRail, { display: 'block' });\n  this.railXMarginWidth =\n    toInt(get(this.scrollbarXRail).marginLeft) +\n    toInt(get(this.scrollbarXRail).marginRight);\n  this.railYMarginHeight =\n    toInt(get(this.scrollbarYRail).marginTop) +\n    toInt(get(this.scrollbarYRail).marginBottom);\n\n  // Hide scrollbars not to affect scrollWidth and scrollHeight\n  set(this.scrollbarXRail, { display: 'none' });\n  set(this.scrollbarYRail, { display: 'none' });\n\n  updateGeometry(this);\n\n  processScrollDiff(this, 'top', 0, false, true);\n  processScrollDiff(this, 'left', 0, false, true);\n\n  set(this.scrollbarXRail, { display: '' });\n  set(this.scrollbarYRail, { display: '' });\n};\n\nPerfectScrollbar.prototype.onScroll = function onScroll (e) {\n  if (!this.isAlive) {\n    return;\n  }\n\n  updateGeometry(this);\n  processScrollDiff(this, 'top', this.element.scrollTop - this.lastScrollTop);\n  processScrollDiff(\n    this,\n    'left',\n    this.element.scrollLeft - this.lastScrollLeft\n  );\n\n  this.lastScrollTop = this.element.scrollTop;\n  this.lastScrollLeft = this.element.scrollLeft;\n};\n\nPerfectScrollbar.prototype.destroy = function destroy () {\n  if (!this.isAlive) {\n    return;\n  }\n\n  this.event.unbindAll();\n  remove(this.scrollbarX);\n  remove(this.scrollbarY);\n  remove(this.scrollbarXRail);\n  remove(this.scrollbarYRail);\n  this.removePsClasses();\n\n  // unset elements\n  this.element = null;\n  this.scrollbarX = null;\n  this.scrollbarY = null;\n  this.scrollbarXRail = null;\n  this.scrollbarYRail = null;\n\n  this.isAlive = false;\n};\n\nPerfectScrollbar.prototype.removePsClasses = function removePsClasses () {\n  this.element.className = this.element.className\n    .split(' ')\n    .filter(function (name) { return !name.match(/^ps([-_].+|)$/); })\n    .join(' ');\n};\n\nexport default PerfectScrollbar;\n","function select(element) {\n    var selectedText;\n\n    if (element.nodeName === 'SELECT') {\n        element.focus();\n\n        selectedText = element.value;\n    }\n    else if (element.nodeName === 'INPUT' || element.nodeName === 'TEXTAREA') {\n        var isReadOnly = element.hasAttribute('readonly');\n\n        if (!isReadOnly) {\n            element.setAttribute('readonly', '');\n        }\n\n        element.select();\n        element.setSelectionRange(0, element.value.length);\n\n        if (!isReadOnly) {\n            element.removeAttribute('readonly');\n        }\n\n        selectedText = element.value;\n    }\n    else {\n        if (element.hasAttribute('contenteditable')) {\n            element.focus();\n        }\n\n        var selection = window.getSelection();\n        var range = document.createRange();\n\n        range.selectNodeContents(element);\n        selection.removeAllRanges();\n        selection.addRange(range);\n\n        selectedText = selection.toString();\n    }\n\n    return selectedText;\n}\n\nmodule.exports = select;\n","(function (global, factory) {\n    if (typeof define === \"function\" && define.amd) {\n        define(['module', 'select'], factory);\n    } else if (typeof exports !== \"undefined\") {\n        factory(module, require('select'));\n    } else {\n        var mod = {\n            exports: {}\n        };\n        factory(mod, global.select);\n        global.clipboardAction = mod.exports;\n    }\n})(this, function (module, _select) {\n    'use strict';\n\n    var _select2 = _interopRequireDefault(_select);\n\n    function _interopRequireDefault(obj) {\n        return obj && obj.__esModule ? obj : {\n            default: obj\n        };\n    }\n\n    var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n        return typeof obj;\n    } : function (obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n\n    function _classCallCheck(instance, Constructor) {\n        if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n        }\n    }\n\n    var _createClass = function () {\n        function defineProperties(target, props) {\n            for (var i = 0; i < props.length; i++) {\n                var descriptor = props[i];\n                descriptor.enumerable = descriptor.enumerable || false;\n                descriptor.configurable = true;\n                if (\"value\" in descriptor) descriptor.writable = true;\n                Object.defineProperty(target, descriptor.key, descriptor);\n            }\n        }\n\n        return function (Constructor, protoProps, staticProps) {\n            if (protoProps) defineProperties(Constructor.prototype, protoProps);\n            if (staticProps) defineProperties(Constructor, staticProps);\n            return Constructor;\n        };\n    }();\n\n    var ClipboardAction = function () {\n        /**\n         * @param {Object} options\n         */\n        function ClipboardAction(options) {\n            _classCallCheck(this, ClipboardAction);\n\n            this.resolveOptions(options);\n            this.initSelection();\n        }\n\n        /**\n         * Defines base properties passed from constructor.\n         * @param {Object} options\n         */\n\n\n        _createClass(ClipboardAction, [{\n            key: 'resolveOptions',\n            value: function resolveOptions() {\n                var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n                this.action = options.action;\n                this.container = options.container;\n                this.emitter = options.emitter;\n                this.target = options.target;\n                this.text = options.text;\n                this.trigger = options.trigger;\n\n                this.selectedText = '';\n            }\n        }, {\n            key: 'initSelection',\n            value: function initSelection() {\n                if (this.text) {\n                    this.selectFake();\n                } else if (this.target) {\n                    this.selectTarget();\n                }\n            }\n        }, {\n            key: 'selectFake',\n            value: function selectFake() {\n                var _this = this;\n\n                var isRTL = document.documentElement.getAttribute('dir') == 'rtl';\n\n                this.removeFake();\n\n                this.fakeHandlerCallback = function () {\n                    return _this.removeFake();\n                };\n                this.fakeHandler = this.container.addEventListener('click', this.fakeHandlerCallback) || true;\n\n                this.fakeElem = document.createElement('textarea');\n                // Prevent zooming on iOS\n                this.fakeElem.style.fontSize = '12pt';\n                // Reset box model\n                this.fakeElem.style.border = '0';\n                this.fakeElem.style.padding = '0';\n                this.fakeElem.style.margin = '0';\n                // Move element out of screen horizontally\n                this.fakeElem.style.position = 'absolute';\n                this.fakeElem.style[isRTL ? 'right' : 'left'] = '-9999px';\n                // Move element to the same position vertically\n                var yPosition = window.pageYOffset || document.documentElement.scrollTop;\n                this.fakeElem.style.top = yPosition + 'px';\n\n                this.fakeElem.setAttribute('readonly', '');\n                this.fakeElem.value = this.text;\n\n                this.container.appendChild(this.fakeElem);\n\n                this.selectedText = (0, _select2.default)(this.fakeElem);\n                this.copyText();\n            }\n        }, {\n            key: 'removeFake',\n            value: function removeFake() {\n                if (this.fakeHandler) {\n                    this.container.removeEventListener('click', this.fakeHandlerCallback);\n                    this.fakeHandler = null;\n                    this.fakeHandlerCallback = null;\n                }\n\n                if (this.fakeElem) {\n                    this.container.removeChild(this.fakeElem);\n                    this.fakeElem = null;\n                }\n            }\n        }, {\n            key: 'selectTarget',\n            value: function selectTarget() {\n                this.selectedText = (0, _select2.default)(this.target);\n                this.copyText();\n            }\n        }, {\n            key: 'copyText',\n            value: function copyText() {\n                var succeeded = void 0;\n\n                try {\n                    succeeded = document.execCommand(this.action);\n                } catch (err) {\n                    succeeded = false;\n                }\n\n                this.handleResult(succeeded);\n            }\n        }, {\n            key: 'handleResult',\n            value: function handleResult(succeeded) {\n                this.emitter.emit(succeeded ? 'success' : 'error', {\n                    action: this.action,\n                    text: this.selectedText,\n                    trigger: this.trigger,\n                    clearSelection: this.clearSelection.bind(this)\n                });\n            }\n        }, {\n            key: 'clearSelection',\n            value: function clearSelection() {\n                if (this.trigger) {\n                    this.trigger.focus();\n                }\n\n                window.getSelection().removeAllRanges();\n            }\n        }, {\n            key: 'destroy',\n            value: function destroy() {\n                this.removeFake();\n            }\n        }, {\n            key: 'action',\n            set: function set() {\n                var action = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'copy';\n\n                this._action = action;\n\n                if (this._action !== 'copy' && this._action !== 'cut') {\n                    throw new Error('Invalid \"action\" value, use either \"copy\" or \"cut\"');\n                }\n            },\n            get: function get() {\n                return this._action;\n            }\n        }, {\n            key: 'target',\n            set: function set(target) {\n                if (target !== undefined) {\n                    if (target && (typeof target === 'undefined' ? 'undefined' : _typeof(target)) === 'object' && target.nodeType === 1) {\n                        if (this.action === 'copy' && target.hasAttribute('disabled')) {\n                            throw new Error('Invalid \"target\" attribute. Please use \"readonly\" instead of \"disabled\" attribute');\n                        }\n\n                        if (this.action === 'cut' && (target.hasAttribute('readonly') || target.hasAttribute('disabled'))) {\n                            throw new Error('Invalid \"target\" attribute. You can\\'t cut text from elements with \"readonly\" or \"disabled\" attributes');\n                        }\n\n                        this._target = target;\n                    } else {\n                        throw new Error('Invalid \"target\" value, use a valid Element');\n                    }\n                }\n            },\n            get: function get() {\n                return this._target;\n            }\n        }]);\n\n        return ClipboardAction;\n    }();\n\n    module.exports = ClipboardAction;\n});","function E () {\n  // Keep this empty so it's easier to inherit from\n  // (via https://github.com/lipsmack from https://github.com/scottcorgan/tiny-emitter/issues/3)\n}\n\nE.prototype = {\n  on: function (name, callback, ctx) {\n    var e = this.e || (this.e = {});\n\n    (e[name] || (e[name] = [])).push({\n      fn: callback,\n      ctx: ctx\n    });\n\n    return this;\n  },\n\n  once: function (name, callback, ctx) {\n    var self = this;\n    function listener () {\n      self.off(name, listener);\n      callback.apply(ctx, arguments);\n    };\n\n    listener._ = callback\n    return this.on(name, listener, ctx);\n  },\n\n  emit: function (name) {\n    var data = [].slice.call(arguments, 1);\n    var evtArr = ((this.e || (this.e = {}))[name] || []).slice();\n    var i = 0;\n    var len = evtArr.length;\n\n    for (i; i < len; i++) {\n      evtArr[i].fn.apply(evtArr[i].ctx, data);\n    }\n\n    return this;\n  },\n\n  off: function (name, callback) {\n    var e = this.e || (this.e = {});\n    var evts = e[name];\n    var liveEvents = [];\n\n    if (evts && callback) {\n      for (var i = 0, len = evts.length; i < len; i++) {\n        if (evts[i].fn !== callback && evts[i].fn._ !== callback)\n          liveEvents.push(evts[i]);\n      }\n    }\n\n    // Remove event from queue to prevent memory leak\n    // Suggested by https://github.com/lazd\n    // Ref: https://github.com/scottcorgan/tiny-emitter/commit/c6ebfaa9bc973b33d110a84a307742b7cf94c953#commitcomment-5024910\n\n    (liveEvents.length)\n      ? e[name] = liveEvents\n      : delete e[name];\n\n    return this;\n  }\n};\n\nmodule.exports = E;\n","/**\n * Check if argument is a HTML element.\n *\n * @param {Object} value\n * @return {Boolean}\n */\nexports.node = function(value) {\n    return value !== undefined\n        && value instanceof HTMLElement\n        && value.nodeType === 1;\n};\n\n/**\n * Check if argument is a list of HTML elements.\n *\n * @param {Object} value\n * @return {Boolean}\n */\nexports.nodeList = function(value) {\n    var type = Object.prototype.toString.call(value);\n\n    return value !== undefined\n        && (type === '[object NodeList]' || type === '[object HTMLCollection]')\n        && ('length' in value)\n        && (value.length === 0 || exports.node(value[0]));\n};\n\n/**\n * Check if argument is a string.\n *\n * @param {Object} value\n * @return {Boolean}\n */\nexports.string = function(value) {\n    return typeof value === 'string'\n        || value instanceof String;\n};\n\n/**\n * Check if argument is a function.\n *\n * @param {Object} value\n * @return {Boolean}\n */\nexports.fn = function(value) {\n    var type = Object.prototype.toString.call(value);\n\n    return type === '[object Function]';\n};\n","var DOCUMENT_NODE_TYPE = 9;\n\n/**\n * A polyfill for Element.matches()\n */\nif (typeof Element !== 'undefined' && !Element.prototype.matches) {\n    var proto = Element.prototype;\n\n    proto.matches = proto.matchesSelector ||\n                    proto.mozMatchesSelector ||\n                    proto.msMatchesSelector ||\n                    proto.oMatchesSelector ||\n                    proto.webkitMatchesSelector;\n}\n\n/**\n * Finds the closest parent that matches a selector.\n *\n * @param {Element} element\n * @param {String} selector\n * @return {Function}\n */\nfunction closest (element, selector) {\n    while (element && element.nodeType !== DOCUMENT_NODE_TYPE) {\n        if (typeof element.matches === 'function' &&\n            element.matches(selector)) {\n          return element;\n        }\n        element = element.parentNode;\n    }\n}\n\nmodule.exports = closest;\n","var closest = require('./closest');\n\n/**\n * Delegates event to a selector.\n *\n * @param {Element} element\n * @param {String} selector\n * @param {String} type\n * @param {Function} callback\n * @param {Boolean} useCapture\n * @return {Object}\n */\nfunction delegate(element, selector, type, callback, useCapture) {\n    var listenerFn = listener.apply(this, arguments);\n\n    element.addEventListener(type, listenerFn, useCapture);\n\n    return {\n        destroy: function() {\n            element.removeEventListener(type, listenerFn, useCapture);\n        }\n    }\n}\n\n/**\n * Finds closest match and invokes callback.\n *\n * @param {Element} element\n * @param {String} selector\n * @param {String} type\n * @param {Function} callback\n * @return {Function}\n */\nfunction listener(element, selector, type, callback) {\n    return function(e) {\n        e.delegateTarget = closest(e.target, selector);\n\n        if (e.delegateTarget) {\n            callback.call(element, e);\n        }\n    }\n}\n\nmodule.exports = delegate;\n","var is = require('./is');\nvar delegate = require('delegate');\n\n/**\n * Validates all params and calls the right\n * listener function based on its target type.\n *\n * @param {String|HTMLElement|HTMLCollection|NodeList} target\n * @param {String} type\n * @param {Function} callback\n * @return {Object}\n */\nfunction listen(target, type, callback) {\n    if (!target && !type && !callback) {\n        throw new Error('Missing required arguments');\n    }\n\n    if (!is.string(type)) {\n        throw new TypeError('Second argument must be a String');\n    }\n\n    if (!is.fn(callback)) {\n        throw new TypeError('Third argument must be a Function');\n    }\n\n    if (is.node(target)) {\n        return listenNode(target, type, callback);\n    }\n    else if (is.nodeList(target)) {\n        return listenNodeList(target, type, callback);\n    }\n    else if (is.string(target)) {\n        return listenSelector(target, type, callback);\n    }\n    else {\n        throw new TypeError('First argument must be a String, HTMLElement, HTMLCollection, or NodeList');\n    }\n}\n\n/**\n * Adds an event listener to a HTML element\n * and returns a remove listener function.\n *\n * @param {HTMLElement} node\n * @param {String} type\n * @param {Function} callback\n * @return {Object}\n */\nfunction listenNode(node, type, callback) {\n    node.addEventListener(type, callback);\n\n    return {\n        destroy: function() {\n            node.removeEventListener(type, callback);\n        }\n    }\n}\n\n/**\n * Add an event listener to a list of HTML elements\n * and returns a remove listener function.\n *\n * @param {NodeList|HTMLCollection} nodeList\n * @param {String} type\n * @param {Function} callback\n * @return {Object}\n */\nfunction listenNodeList(nodeList, type, callback) {\n    Array.prototype.forEach.call(nodeList, function(node) {\n        node.addEventListener(type, callback);\n    });\n\n    return {\n        destroy: function() {\n            Array.prototype.forEach.call(nodeList, function(node) {\n                node.removeEventListener(type, callback);\n            });\n        }\n    }\n}\n\n/**\n * Add an event listener to a selector\n * and returns a remove listener function.\n *\n * @param {String} selector\n * @param {String} type\n * @param {Function} callback\n * @return {Object}\n */\nfunction listenSelector(selector, type, callback) {\n    return delegate(document.body, selector, type, callback);\n}\n\nmodule.exports = listen;\n","(function (global, factory) {\n    if (typeof define === \"function\" && define.amd) {\n        define(['module', './clipboard-action', 'tiny-emitter', 'good-listener'], factory);\n    } else if (typeof exports !== \"undefined\") {\n        factory(module, require('./clipboard-action'), require('tiny-emitter'), require('good-listener'));\n    } else {\n        var mod = {\n            exports: {}\n        };\n        factory(mod, global.clipboardAction, global.tinyEmitter, global.goodListener);\n        global.clipboard = mod.exports;\n    }\n})(this, function (module, _clipboardAction, _tinyEmitter, _goodListener) {\n    'use strict';\n\n    var _clipboardAction2 = _interopRequireDefault(_clipboardAction);\n\n    var _tinyEmitter2 = _interopRequireDefault(_tinyEmitter);\n\n    var _goodListener2 = _interopRequireDefault(_goodListener);\n\n    function _interopRequireDefault(obj) {\n        return obj && obj.__esModule ? obj : {\n            default: obj\n        };\n    }\n\n    var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n        return typeof obj;\n    } : function (obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n\n    function _classCallCheck(instance, Constructor) {\n        if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n        }\n    }\n\n    var _createClass = function () {\n        function defineProperties(target, props) {\n            for (var i = 0; i < props.length; i++) {\n                var descriptor = props[i];\n                descriptor.enumerable = descriptor.enumerable || false;\n                descriptor.configurable = true;\n                if (\"value\" in descriptor) descriptor.writable = true;\n                Object.defineProperty(target, descriptor.key, descriptor);\n            }\n        }\n\n        return function (Constructor, protoProps, staticProps) {\n            if (protoProps) defineProperties(Constructor.prototype, protoProps);\n            if (staticProps) defineProperties(Constructor, staticProps);\n            return Constructor;\n        };\n    }();\n\n    function _possibleConstructorReturn(self, call) {\n        if (!self) {\n            throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n        }\n\n        return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n    }\n\n    function _inherits(subClass, superClass) {\n        if (typeof superClass !== \"function\" && superClass !== null) {\n            throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n        }\n\n        subClass.prototype = Object.create(superClass && superClass.prototype, {\n            constructor: {\n                value: subClass,\n                enumerable: false,\n                writable: true,\n                configurable: true\n            }\n        });\n        if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n    }\n\n    var Clipboard = function (_Emitter) {\n        _inherits(Clipboard, _Emitter);\n\n        /**\n         * @param {String|HTMLElement|HTMLCollection|NodeList} trigger\n         * @param {Object} options\n         */\n        function Clipboard(trigger, options) {\n            _classCallCheck(this, Clipboard);\n\n            var _this = _possibleConstructorReturn(this, (Clipboard.__proto__ || Object.getPrototypeOf(Clipboard)).call(this));\n\n            _this.resolveOptions(options);\n            _this.listenClick(trigger);\n            return _this;\n        }\n\n        /**\n         * Defines if attributes would be resolved using internal setter functions\n         * or custom functions that were passed in the constructor.\n         * @param {Object} options\n         */\n\n\n        _createClass(Clipboard, [{\n            key: 'resolveOptions',\n            value: function resolveOptions() {\n                var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n                this.action = typeof options.action === 'function' ? options.action : this.defaultAction;\n                this.target = typeof options.target === 'function' ? options.target : this.defaultTarget;\n                this.text = typeof options.text === 'function' ? options.text : this.defaultText;\n                this.container = _typeof(options.container) === 'object' ? options.container : document.body;\n            }\n        }, {\n            key: 'listenClick',\n            value: function listenClick(trigger) {\n                var _this2 = this;\n\n                this.listener = (0, _goodListener2.default)(trigger, 'click', function (e) {\n                    return _this2.onClick(e);\n                });\n            }\n        }, {\n            key: 'onClick',\n            value: function onClick(e) {\n                var trigger = e.delegateTarget || e.currentTarget;\n\n                if (this.clipboardAction) {\n                    this.clipboardAction = null;\n                }\n\n                this.clipboardAction = new _clipboardAction2.default({\n                    action: this.action(trigger),\n                    target: this.target(trigger),\n                    text: this.text(trigger),\n                    container: this.container,\n                    trigger: trigger,\n                    emitter: this\n                });\n            }\n        }, {\n            key: 'defaultAction',\n            value: function defaultAction(trigger) {\n                return getAttributeValue('action', trigger);\n            }\n        }, {\n            key: 'defaultTarget',\n            value: function defaultTarget(trigger) {\n                var selector = getAttributeValue('target', trigger);\n\n                if (selector) {\n                    return document.querySelector(selector);\n                }\n            }\n        }, {\n            key: 'defaultText',\n            value: function defaultText(trigger) {\n                return getAttributeValue('text', trigger);\n            }\n        }, {\n            key: 'destroy',\n            value: function destroy() {\n                this.listener.destroy();\n\n                if (this.clipboardAction) {\n                    this.clipboardAction.destroy();\n                    this.clipboardAction = null;\n                }\n            }\n        }], [{\n            key: 'isSupported',\n            value: function isSupported() {\n                var action = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : ['copy', 'cut'];\n\n                var actions = typeof action === 'string' ? [action] : action;\n                var support = !!document.queryCommandSupported;\n\n                actions.forEach(function (action) {\n                    support = support && !!document.queryCommandSupported(action);\n                });\n\n                return support;\n            }\n        }]);\n\n        return Clipboard;\n    }(_tinyEmitter2.default);\n\n    /**\n     * Helper function to retrieve attribute value.\n     * @param {String} suffix\n     * @param {Element} element\n     */\n    function getAttributeValue(suffix, element) {\n        var attribute = 'data-clipboard-' + suffix;\n\n        if (!element.hasAttribute(attribute)) {\n            return;\n        }\n\n        return element.getAttribute(attribute);\n    }\n\n    module.exports = Clipboard;\n});","import PerfectScrollbar from 'perfect-scrollbar';\nimport Clipboard from 'clipboard';\nimport Constants from '../configuration/Constants';\n\n/**\n * Smart guide\n * @typedef {Object} SmartGuide\n * @property {Editor} editor - A reference to the current editor.\n * @property {String} wordToChange - Word to change following a click on a word.\n * @property {String} lastWord - Keep the last word of the previous export to compare with the new and scroll if it's different.\n * @property {String} previousLabelExport - Keep the previous label export to know if we should repopulate the prompter text.\n * @property {PerfectScrollbar} perfectScrollbar - Perfect Scrollbar used to get gestures from smart guide using touch-action none anyway and get scrolling too.\n * @property {Object} elements - All the HTML elements of the smart guide.\n * @property {Number} smartGuideTimeOutId - Id of the setTimeOut from fade out animation to clear.\n * @property {String} randomString - Random string used in case of multiple smart guide.\n */\n\n/**\n * Create all the smart guide HTML elements.\n */\nfunction createHTMLElements(randomString) {\n  /**\n   * The smart guide element.\n   * @type {HTMLDivElement}\n   */\n  const smartGuideElement = document.createElement('div');\n  smartGuideElement.id = 'smartguide' + randomString;\n  smartGuideElement.classList.add('smartguide');\n\n  /**\n   * The prompter text element that contains the text to get the overflow working.\n   * @type {HTMLDivElement}\n   */\n  const textElement = document.createElement('div');\n  textElement.id = 'prompter-text' + randomString;\n  textElement.classList.add('prompter-text');\n  textElement.setAttribute('touch-action', 'none');\n\n  /**\n   * The text container element that contains the text element.\n   * @type {HTMLDivElement}\n   */\n  const textContainer = document.createElement('div');\n  textContainer.id = 'prompter-text-container' + randomString;\n  textContainer.classList.add('prompter-text-container');\n  textContainer.appendChild(textElement);\n\n  /**\n   * The actions menu represented by the ellipsis character.\n   * @type {HTMLDivElement}\n   */\n  const ellipsisElement = document.createElement('div');\n  ellipsisElement.id = 'ellipsis' + randomString;\n  ellipsisElement.classList.add('ellipsis');\n  ellipsisElement.innerHTML = '...';\n\n  /**\n   * The tag element.\n   * @type {HTMLDivElement}\n   */\n  const tagElement = document.createElement('div');\n  tagElement.id = 'tag-icon' + randomString;\n  tagElement.classList.add('tag-icon');\n  tagElement.innerHTML = '&#182;';\n\n  /**\n   * The candidates element that contains the candidates for a word.\n   * @type {HTMLDivElement}\n   */\n  const candidatesElement = document.createElement('div');\n  candidatesElement.id = 'candidates' + randomString;\n  candidatesElement.classList.add('candidates');\n\n  /**\n   * The menu element that contains the actions.\n   * @type {HTMLDivElement}\n   */\n  const menuElement = document.createElement('div');\n  menuElement.id = 'more-menu' + randomString;\n  menuElement.classList.add('more-menu');\n\n  /**\n   * The convert button from actions menu.\n   * @type {HTMLButtonElement}\n   */\n  const convertElement = document.createElement('button');\n  convertElement.classList.add('options-label-button');\n  convertElement.id = 'convert' + randomString;\n  convertElement.innerHTML = 'Convert';\n\n  /**\n   * The copy button from actions menu.\n   * @type {HTMLButtonElement}\n   */\n  const copyElement = document.createElement('button');\n  copyElement.classList.add('options-label-button');\n  copyElement.id = 'copy' + randomString;\n  copyElement.innerHTML = 'Copy';\n\n  /**\n   * The delete button from actions menu.\n   * @type {HTMLButtonElement}\n   */\n  const deleteElement = document.createElement('button');\n  deleteElement.classList.add('options-label-button');\n  deleteElement.id = 'delete' + randomString;\n  deleteElement.innerHTML = 'Delete';\n\n  return {\n    smartGuideElement,\n    textElement,\n    textContainer,\n    candidatesElement,\n    menuElement,\n    tagElement,\n    ellipsisElement,\n    convertElement,\n    copyElement,\n    deleteElement,\n  };\n}\n\n/**\n * Check if node is in shadow dom\n * @param {Node} node - A node element.\n * @returns {boolean} true if is in shadow dom, false otherwise.\n */\nfunction isInShadow(node) {\n  let parent = (node && node.parentNode);\n  while (parent) {\n    if (parent.toString() === '[object ShadowRoot]') {\n      return true;\n    }\n    parent = parent.parentNode;\n  }\n  return false;\n}\n\n/**\n * Show the actions of the action menu.\n * @param {Event} evt - Event used to insert the option div using the event's target.\n * @param {Object} elements - All the elements of the smart guide.\n * @param {SmartGuide} smartGuide\n */\nfunction showActions(evt, elements) {\n  const elementsRef = elements;\n\n  const insertActions = () => {\n    elementsRef.menuElement.appendChild(elementsRef.convertElement);\n    elementsRef.menuElement.appendChild(elementsRef.copyElement);\n    elementsRef.menuElement.appendChild(elementsRef.deleteElement);\n\n    const parent = evt.target.parentNode;\n    parent.insertBefore(elementsRef.menuElement, evt.target);\n  };\n\n  const positionActions = () => {\n    // 48 to get the boundary of smart guide element.\n    const left = evt.target.offsetLeft - 68;\n    elementsRef.menuElement.style.left = `${left}px`;\n  };\n\n  const isMenuInDocument = document.contains(elementsRef.menuElement);\n  if (!isInShadow(elementsRef.menuElement) && !isMenuInDocument) {\n    elementsRef.menuElement.style.display = 'flex';\n    positionActions();\n    insertActions();\n  } else if (elementsRef.menuElement.style.display === 'none') {\n    positionActions();\n    elementsRef.menuElement.style.display = 'flex';\n  }\n}\n\n/**\n * Show the candidates of the clicked word.\n * @param {Event} evt - Event used to determine the clicked word.\n * @param {Editor} editor - A reference to the editor.\n * @param {SmartGuide} smartGuide - A reference to the smart guide.\n */\nfunction showCandidates(evt, editor, smartGuide) {\n  const smartGuideRef = smartGuide;\n  const elementsRef = smartGuide.elements;\n\n  if (evt.target.id !== `prompter-text${smartGuide.randomString}`) {\n    const id = evt.target.id.replace('word-', '').replace(smartGuide.randomString, '');\n    const words = JSON.parse(editor.exports[Constants.Exports.JIIX]).words;\n    smartGuideRef.wordToChange = words[id];\n    smartGuideRef.wordToChange.id = id;\n    elementsRef.candidatesElement.innerHTML = '';\n    if (smartGuideRef.wordToChange && smartGuideRef.wordToChange.candidates) {\n      elementsRef.candidatesElement.style.display = 'flex';\n      smartGuideRef.wordToChange.candidates.forEach((word, index) => {\n        if (smartGuideRef.wordToChange.label === word) {\n          elementsRef.candidatesElement.innerHTML += `<span id=\"cdt-${index}${smartGuide.randomString}\" class=\"selected-word\">${word}</span>`;\n        } else {\n          elementsRef.candidatesElement.innerHTML += `<span id=\"cdt-${index}${smartGuide.randomString}\">${word}</span>`;\n        }\n      });\n      // get the parent parent of word to insert just before smart guide, 48 to get the boundary of smart guide element.\n      const top = 48;\n      const left = evt.target.getBoundingClientRect().left - 60;\n      elementsRef.candidatesElement.style.top = `${top}px`;\n      elementsRef.candidatesElement.style.left = `${left}px`;\n\n      const parent = evt.target.parentNode.parentNode.parentNode;\n      parent.insertBefore(elementsRef.candidatesElement, evt.target.parentNode.parentNode);\n    }\n  }\n}\n\n/**\n * Call the import_ function of the editor to import the modified Jiix with the new label.\n * @param {Event} evt - Event to determine the clicked candidate.\n * @param {Editor} editor - A reference to the editor.\n * @param {SmartGuide} smartGuide - A reference to the smart guide.\n */\nfunction clickCandidate(evt, editor, smartGuide) {\n  const smartGuideRef = smartGuide;\n  const elementsRef = smartGuide.elements;\n  const candidate = evt.target.innerText;\n\n  if (candidate !== smartGuideRef.wordToChange.label && smartGuideRef.wordToChange.candidates.includes(candidate)) {\n    const jiixToImport = JSON.parse(editor.exports[Constants.Exports.JIIX]);\n    jiixToImport.words[smartGuideRef.wordToChange.id].label = candidate;\n    // eslint-disable-next-line no-underscore-dangle\n    editor.import_(JSON.stringify(jiixToImport), Constants.Exports.JIIX);\n  }\n  elementsRef.candidatesElement.style.display = 'none';\n}\n\n/**\n * Add the listeners to the smart guide elements.\n * @param {Editor} editor - A reference to the editor.\n * @param {SmartGuide} smartGuide - A reference to the smart guide.\n */\nfunction addListeners(editor, smartGuide) {\n  const elementsRef = smartGuide.elements;\n\n  elementsRef.textElement.addEventListener('click', evt => showCandidates(evt, editor, smartGuide));\n  elementsRef.candidatesElement.addEventListener('click', evt => clickCandidate(evt, editor, smartGuide));\n  elementsRef.ellipsisElement.addEventListener('click', evt => showActions(evt, elementsRef));\n  elementsRef.copyElement.addEventListener('click', () => {\n    elementsRef.menuElement.style.display = 'none';\n  });\n  elementsRef.convertElement.addEventListener('click', () => {\n    elementsRef.menuElement.style.display = 'none';\n    editor.convert();\n  });\n  elementsRef.deleteElement.addEventListener('click', () => {\n    elementsRef.menuElement.style.display = 'none';\n    editor.clear();\n  });\n}\n\n/**\n * Call mutation observer to trigger fade out animation.\n * @param {number} [duration=10000] - the duration in milliseconds before calling the fade out animation.\n * @param {SmartGuide} smartGuide - A reference to the smart guide.\n */\nfunction callFadeOutObserver(duration = 10000, smartGuide) {\n  const smartGuideRef = smartGuide;\n  const elementsRef = smartGuide.elements;\n  // eslint-disable-next-line no-undef\n  const observer = new MutationObserver((mutations) => {\n    mutations.forEach(() => {\n      if (smartGuideRef.smartGuideTimeOutId) {\n        clearTimeout(smartGuideRef.smartGuideTimeOutId);\n      }\n      if (elementsRef.candidatesElement.style.display === 'none' && elementsRef.menuElement.style.display === 'none') {\n        smartGuideRef.smartGuideTimeOutId = setTimeout(() => {\n          elementsRef.smartGuideElement.classList.add('smartguide-out');\n          elementsRef.smartGuideElement.classList.remove('smartguide-in');\n        }, duration);\n      } else if (!document.contains(elementsRef.candidatesElement) && !document.contains(elementsRef.menuElement)) {\n        smartGuideRef.smartGuideTimeOutId = setTimeout(() => {\n          elementsRef.smartGuideElement.classList.add('smartguide-out');\n          elementsRef.smartGuideElement.classList.remove('smartguide-in');\n        }, duration);\n      }\n    });\n  });\n  observer.observe(elementsRef.smartGuideElement, { childList: true, subtree: true, attributes: true });\n}\n\n/**\n * Create a new smart guide\n * @param {Editor} editor - A reference to the editor.\n * @returns {SmartGuide} New smart guide\n */\nexport function createSmartGuide(editor) {\n  const randomString = '-' + Math.random().toString(10).substring(2, 12);\n  const elements = createHTMLElements(randomString);\n\n  /**\n   * Clipboard from clipboard.js used to get copy across all browsers.\n   * @type {Clipboard}\n   */\n  const clipboard = new Clipboard(elements.copyElement);\n  const perfectScrollbar = new PerfectScrollbar(elements.textContainer, { suppressScrollY: true, scrollXMarginOffset: 1 });\n\n  const smartGuide = {\n    editor,\n    wordToChange: '',\n    lastWord: '',\n    previousLabelExport: ' ',\n    perfectScrollbar,\n    elements,\n    smartGuideTimeOutId: 0,\n    randomString\n  };\n  addListeners(editor, smartGuide);\n\n  if (editor.configuration.recognitionParams.v4.text.smartGuideFadeOut.enable) {\n    callFadeOutObserver(editor.configuration.recognitionParams.v4.text.smartGuideFadeOut.duration, smartGuide);\n  }\n\n  return smartGuide;\n}\n\nexport function resize(smartGuide) {\n  const smartGuideRef = smartGuide;\n  const elementsRef = smartGuide.elements;\n\n  const mmToPixels = 3.779527559;\n  let left = smartGuideRef.editor.configuration.recognitionParams.v4.text.margin.left * mmToPixels;\n\n  const maxWidthTextContainer = smartGuideRef.editor.domElement.clientWidth - left - elementsRef.tagElement.offsetWidth - 35 - left;\n\n  // Assign a max width to the smartguide based on the editor width, the left position and a small margin for the ellipsis (48px)\n  elementsRef.textContainer.style.width = `${maxWidthTextContainer}px`;\n  elementsRef.textContainer.style.maxWidth = `${maxWidthTextContainer}px`;\n\n  left = elementsRef.tagElement.offsetWidth;\n  left += maxWidthTextContainer;\n  elementsRef.ellipsisElement.style.left = `${left}px`;\n\n  elementsRef.smartGuideElement.style.width = `${elementsRef.tagElement.offsetWidth + elementsRef.textContainer.offsetWidth + elementsRef.ellipsisElement.offsetWidth}px`;\n  smartGuideRef.perfectScrollbar.update();\n}\n\n/**\n * Insert the smart guide HTML elements in the DOM.\n * @param {SmartGuide} smartGuide - A reference to the smart guide.\n */\nexport function insertSmartGuide(smartGuide) {\n  const smartGuideRef = smartGuide;\n  const elementsRef = smartGuide.elements;\n\n  const insertSmartGuideElement = (left, top) => {\n    elementsRef.smartGuideElement.style.top = `${top}px`;\n    elementsRef.smartGuideElement.style.left = `${left}px`;\n    elementsRef.smartGuideElement.style.visibility = 'hidden';\n\n    const parent = smartGuideRef.editor.domElement;\n    parent.insertBefore(elementsRef.smartGuideElement, smartGuideRef.editor.loader);\n  };\n  const insertTag = () => {\n    elementsRef.smartGuideElement.appendChild(elementsRef.tagElement);\n  };\n  const insertTextContainer = (left, maxWidth) => {\n    elementsRef.textContainer.style.left = `${left}px`;\n\n    // Assign a max width to the smartguide based on the editor width, the left position and a small margin for the ellipsis (48px)\n    elementsRef.textContainer.style.width = `${maxWidth}px`;\n    elementsRef.textContainer.style.maxWidth = `${maxWidth}px`;\n\n    elementsRef.smartGuideElement.appendChild(elementsRef.textContainer);\n  };\n  const insertEllipsis = (left) => {\n    elementsRef.ellipsisElement.style.left = `${left}px`;\n\n    elementsRef.smartGuideElement.appendChild(elementsRef.ellipsisElement);\n  };\n\n\n  // FIXME Use value from contentChanged when available\n\n  const mmToPixels = 3.779527559;\n\n  const marginTop = smartGuideRef.editor.configuration.recognitionParams.v4.text.margin.top * mmToPixels;\n  const marginLeft = smartGuideRef.editor.configuration.recognitionParams.v4.text.margin.left * mmToPixels;\n\n  // 12 is the space between line in mm\n  const top = marginTop - (12 * mmToPixels);\n  let left = marginLeft;\n\n  insertSmartGuideElement(left, top);\n  insertTag();\n\n  // 35 is the ellipsis element width\n  const maxWidthTextContainer = smartGuideRef.editor.domElement.clientWidth - left - elementsRef.tagElement.offsetWidth - 35 - left;\n  left = elementsRef.tagElement.offsetWidth;\n  insertTextContainer(left, maxWidthTextContainer);\n\n  left += maxWidthTextContainer;\n  insertEllipsis(left);\n\n  elementsRef.menuElement.style.display = 'none';\n  elementsRef.menuElement.appendChild(elementsRef.convertElement);\n  elementsRef.menuElement.appendChild(elementsRef.copyElement);\n  elementsRef.menuElement.appendChild(elementsRef.deleteElement);\n  elementsRef.smartGuideElement.appendChild(elementsRef.menuElement);\n\n  elementsRef.candidatesElement.style.display = 'none';\n  elementsRef.smartGuideElement.appendChild(elementsRef.candidatesElement);\n\n  // 48px as set in css\n  elementsRef.smartGuideElement.style.height = '48px';\n  elementsRef.smartGuideElement.style.width = `${elementsRef.tagElement.offsetWidth + elementsRef.textContainer.offsetWidth + elementsRef.ellipsisElement.offsetWidth}px`;\n  smartGuideRef.perfectScrollbar.update();\n}\n\n/**\n * Launch the smartguide.\n * @param {SmartGuide} smartGuide - A reference to the smart guide.\n * @param {Object} exports -  The export from the editor.\n */\nexport function launchSmartGuide(smartGuide, exports) {\n  const smartGuideRef = smartGuide;\n  const elementsRef = smartGuide.elements;\n\n  const isSmartGuideInDocument = document.contains(elementsRef.smartGuideElement);\n\n  if (!isInShadow(elementsRef.smartGuideElement) && !isSmartGuideInDocument) {\n    insertSmartGuide(smartGuide);\n  }\n\n  const addAnimationToModifiedWord = (words) => {\n    if (smartGuideRef.tempWords && smartGuideRef.tempWords.length === words.length) {\n      const labelWordsArray = words.map(word => word.label);\n      const tempLabelWordsArray = smartGuideRef.tempWords.map(word => word.label);\n      const wordChangedId = labelWordsArray.indexOf(labelWordsArray.filter(a => tempLabelWordsArray.indexOf(a) === -1)[0]);\n      if (document.getElementById(`word-${wordChangedId}${smartGuide.randomString}`) && wordChangedId > -1) {\n        document.getElementById(`word-${wordChangedId}${smartGuide.randomString}`).classList.add('modified-word');\n        elementsRef.textContainer.scrollLeft = document.getElementById(`word-${wordChangedId}${smartGuide.randomString}`).offsetLeft - 10;\n      }\n    }\n    smartGuideRef.tempWords = JSON.parse(exports[Constants.Exports.JIIX]).words;\n  };\n\n  const createWordSpan = (empty, index, word) => {\n    const span = document.createElement('span');\n    span.id = `word-${index}${smartGuide.randomString}`;\n    if (empty) {\n      span.innerHTML = '&nbsp;';\n    } else {\n      span.textContent = word.label;\n    }\n    return span;\n  };\n\n  // Possible optimisation ? Check if we can find a way to not repopulate the smartguide every time even if we now use Document fragment\n  const populatePrompter = (words) => {\n    elementsRef.textElement.innerHTML = '';\n    // We use a DocumentFragment to reflow the DOM only one time as it is not part of the DOM\n    const myFragment = document.createDocumentFragment();\n    words.forEach((word, index) => {\n      if (word.label === ' ' || word.label.includes('\\n')) {\n        myFragment.appendChild(createWordSpan(true, index));\n      } else if (index !== words.length - 1) {\n        myFragment.appendChild(createWordSpan(false, index, word));\n      } else {\n        elementsRef.textElement.appendChild(myFragment);\n        smartGuideRef.perfectScrollbar.update();\n        if (smartGuideRef.lastWord === '') {\n          smartGuideRef.lastWord = word;\n        }\n        const span = createWordSpan(false, index, word);\n        // This is used to scroll to last word if last word is modified\n        if ((smartGuideRef.lastWord.candidates !== word.candidates) && (smartGuideRef.lastWord.label !== word.label)) {\n          span.classList.add('added-word');\n          elementsRef.textElement.appendChild(span);\n          elementsRef.textContainer.scrollLeft = span.offsetLeft;\n          smartGuideRef.lastWord = word;\n        } else {\n          elementsRef.textElement.appendChild(span);\n          elementsRef.textContainer.scrollLeft = span.offsetLeft;\n        }\n      }\n    });\n  };\n\n  if (exports && JSON.parse(exports[Constants.Exports.JIIX]).words.length > 0) {\n    elementsRef.smartGuideElement.classList.add('smartguide-in');\n    elementsRef.smartGuideElement.classList.remove('smartguide-out');\n    elementsRef.candidatesElement.style.display = 'none';\n    elementsRef.menuElement.style.display = 'none';\n    if (smartGuideRef.previousLabelExport && smartGuideRef.previousLabelExport !== JSON.parse(exports[Constants.Exports.JIIX]).label) {\n      const words = JSON.parse(exports[Constants.Exports.JIIX]).words;\n      populatePrompter(words);\n      addAnimationToModifiedWord(words);\n    }\n    smartGuideRef.previousLabelExport = JSON.parse(exports[Constants.Exports.JIIX]).label;\n    // This is required by clipboard.js to get the text to be copied.\n    elementsRef.copyElement.setAttribute('data-clipboard-text', JSON.parse(exports[Constants.Exports.JIIX]).label);\n  } else {\n    elementsRef.smartGuideElement.classList.add('smartguide-out');\n    elementsRef.smartGuideElement.classList.remove('smartguide-in');\n  }\n\n  return smartGuideRef;\n}\n","/* eslint-disable no-undef */\nimport { editorLogger as logger } from '../configuration/LoggerConfig';\nimport * as InkModel from '../model/InkModel';\n\n/**\n * Function to copy past to inject ink during tutorial.\n * @param editorParam\n * @param strokes\n * @param delayBetweenStrokes\n * @param lastOneDelay\n */\nexport function inkImporter(editorParam, strokes, delayBetweenStrokes, lastOneDelay) {\n  const editor = editorParam;\n  logger.debug('inkImporter start importing =>', strokes);\n  const origGrabber = Object.assign({}, editor.behavior.grabber);\n  origGrabber.detach = editor.behavior.grabber.detach;\n  editor.behavior.grabber = {};\n  const actions = [];\n  strokes.forEach((stroke) => {\n    if (stroke.convert) {\n      actions.push({ action: 'convert', value: true });\n    } else if (stroke.setDelay) {\n      actions.push({ action: 'setDelay', value: stroke.setDelay });\n    } else {\n      if (stroke.color) {\n        actions.push({ action: 'setColor', value: stroke.color });\n      }\n      stroke.X.forEach((x, idx) => {\n        let action = 'move';\n        if (idx === 0) {\n          action = 'down';\n        } else if (idx === (stroke.X.length - 1)) {\n          action = 'up';\n        }\n        actions.push({ action, point: { x: stroke.X[idx], y: stroke.Y[idx] } });\n      });\n    }\n  });\n  logger.debug('Array of actions =>', actions);\n  const play = (actionsArray, position, delay) => {\n    if (position < actionsArray.length) {\n      const currentAction = actionsArray[position];\n      let nextDelay = delay;\n      if (currentAction.action === 'convert') {\n        editor.convert();\n      } else if (currentAction.action === 'setDelay') {\n        nextDelay = currentAction.value;\n      } else if (currentAction.action === 'setColor') {\n        editor.penStyle = {\n          color: currentAction.value,\n        };\n      } else {\n        currentAction.point.t = new Date().getTime();\n        if (currentAction.action === 'down') {\n          editor.pointerDown(currentAction.point);\n        } else if (currentAction.action === 'up') {\n          editor.pointerUp(currentAction.point);\n        } else if (currentAction.action === 'move') {\n          editor.pointerMove(currentAction.point);\n        }\n      } if (lastOneDelay && position === actionsArray.map(x => x.action).lastIndexOf('down') - 1) {\n        setTimeout(() => {\n          play(actionsArray, position + 1, nextDelay);\n        }, lastOneDelay);\n      } else if (position === actionsArray.length - 1) {\n        const event = new Event('drawEnded');\n        document.dispatchEvent(event);\n        editor.behavior.grabber = origGrabber;\n      } else {\n        setTimeout(() => {\n          play(actionsArray, position + 1, nextDelay);\n        }, nextDelay);\n      }\n    }\n  };\n  play(actions, 0, delayBetweenStrokes);\n}\n\n\nexport function importStrokeGroups(editorParam, strokeGroups) {\n  strokeGroups.forEach((group) => {\n    group.strokes.forEach((strokeFromGroup) => {\n      InkModel.addStroke(editorParam.model, strokeFromGroup);\n      InkModel.addStrokeToGroup(editorParam.model, strokeFromGroup, group.penStyle);\n    });\n  });\n  editorParam.renderer.drawModel(editorParam.rendererContext, editorParam.model, editorParam.stroker);\n}\n","/* eslint-disable no-underscore-dangle */\nimport { editorLogger as logger } from './configuration/LoggerConfig';\nimport * as DefaultBehaviors from './configuration/DefaultBehaviors';\nimport * as DefaultConfiguration from './configuration/DefaultConfiguration';\nimport * as DefaultStyles from './configuration/DefaultPenStyle';\nimport * as DefaultTheme from './configuration/DefaultTheme';\nimport * as InkModel from './model/InkModel';\nimport * as UndoRedoContext from './model/UndoRedoContext';\nimport * as UndoRedoManager from './model/UndoRedoManager';\nimport * as ModelStats from './util/ModelStats';\nimport * as ImageRenderer from './renderer/canvas/ImageRenderer';\nimport * as RecognizerContext from './model/RecognizerContext';\nimport * as SmartGuide from './smartguide/SmartGuide';\nimport Constants from './configuration/Constants';\nimport * as eastereggs from './eastereggs/InkImporter';\n\n\n/**\n * Trigger callbacks\n * @param {Editor} editor\n * @param {Object} data\n * @param {...String} types\n * @return {Model}\n */\nfunction triggerCallbacks(editor, data, ...types) {\n  const editorRef = editor;\n  types.forEach((type) => {\n    switch (type) {\n      case Constants.EventType.RENDERED:\n        break; // Internal use only\n      case Constants.EventType.UNDO:\n      case Constants.EventType.REDO:\n      case Constants.EventType.CLEAR:\n      case Constants.EventType.CONVERT:\n      case Constants.EventType.EXPORT:\n        editor.callbacks.forEach(callback => callback.call(editor.domElement, type));\n        break;\n      case Constants.EventType.LOADED:\n      case Constants.EventType.CHANGED:\n        editor.callbacks.forEach(callback => callback.call(editor.domElement, type, {\n          initialized: editor.initialized,\n          canUndo: editor.canUndo,\n          canRedo: editor.canRedo,\n          canClear: editor.canClear,\n          isEmpty: editor.isEmpty,\n          possibleUndoCount: editor.possibleUndoCount,\n          undoStackIndex: editor.undoStackIndex,\n          canConvert: editor.canConvert,\n          canExport: editor.canExport\n        }));\n        break;\n      case Constants.EventType.EXPORTED:\n        window.clearTimeout(editorRef.notifyTimer);\n        editorRef.notifyTimer = window.setTimeout(() => {\n          editor.callbacks.forEach(callback => callback.call(editor.domElement, type, {\n            exports: editor.exports\n          }));\n        }, editorRef.configuration.processDelay);\n        break;\n      case Constants.EventType.SUPPORTED_IMPORT_MIMETYPES:\n        editor.callbacks.forEach(callback => callback.call(editor.domElement, type, {\n          mimeTypes: editor.supportedImportMimeTypes\n        }));\n        break;\n      case Constants.EventType.ERROR:\n        editor.callbacks.forEach(callback => callback.call(editor.domElement, type, data));\n        break;\n      case Constants.EventType.IDLE:\n        editor.callbacks.forEach(callback => callback.call(editor.domElement, type, {\n          idle: editor.idle\n        }));\n        break;\n      default:\n        logger.debug(`No valid trigger configured for ${type}`);\n        break;\n    }\n  });\n}\n\n/**\n * Check if a clear is required, and does it if it is\n * @param {function(recognizerContext: RecognizerContext, model: Model, callback: RecognizerCallback)} resetFunc\n * @param {function(recognizerContext: RecognizerContext, model: Model, callback: RecognizerCallback)} func\n * @param {RecognizerContext} recognizerContext Current recognizer context\n * @param {Model} model Current model\n * @param {RecognizerCallback} callback\n */\nfunction manageResetState(resetFunc, func, recognizerContext, model, callback, ...params) {\n  // If strokes moved in the undo redo stack then a clear is mandatory before sending strokes.\n  if (resetFunc && RecognizerContext.isResetRequired(recognizerContext, model)) {\n    logger.debug('Reset is needed');\n    resetFunc(recognizerContext, model, (err, resetedModel, ...types) => {\n      if (err) {\n        callback(err, resetedModel, ...types);\n      } else {\n        func(recognizerContext, resetedModel, callback, ...params);\n      }\n    });\n  } else {\n    func(recognizerContext, model, callback, ...params);\n  }\n}\n\n/**\n * Check if the trigger in parameter is valid.\n * @param {Editor} editor\n * @param {String} type\n * @param {String} [trigger]\n * @return {Boolean}\n */\nfunction isTriggerValid(editor, type, trigger = editor.configuration.triggers[type]) {\n  if (editor.recognizer &&\n    editor.recognizer.getInfo().availableTriggers[type].includes(trigger)) {\n    return true;\n  }\n  logger.error(`${trigger} is not a valid trigger for ${type}`);\n  return false;\n}\n\n/**\n * Manage recognized model\n * @param {Editor} editor\n * @param {Model} model\n * @param {...String} types\n */\nfunction manageRecognizedModel(editor, model, ...types) {\n  const editorRef = editor;\n  const modelRef = model;\n  logger.debug(`model changed callback on ${types} event(s)`, model);\n  if (modelRef.creationTime === editor.model.creationTime) {\n    // Merge recognized model if relevant and return current editor model\n    if ((modelRef.rawStrokes.length === editor.model.rawStrokes.length) &&\n      (modelRef.lastPositions.lastSentPosition >= editor.model.lastPositions.lastReceivedPosition)) {\n      editorRef.model = InkModel.mergeModels(editorRef.model, modelRef);\n      if (InkModel.needRedraw(editorRef.model) || types.includes(Constants.EventType.RENDERED)) {\n        editor.renderer.drawModel(editor.rendererContext, editorRef.model, editor.stroker);\n      }\n    } else {\n      editorRef.model = modelRef;\n      editor.renderer.drawModel(editor.rendererContext, editorRef.model, editor.stroker);\n    }\n    triggerCallbacks(editor, undefined, ...types);\n  }\n\n  if (editor.configuration.recognitionParams.type === 'TEXT'\n    && editor.configuration.recognitionParams.apiVersion === 'V4'\n    && editor.configuration.recognitionParams.protocol !== 'REST'\n    && editor.configuration.recognitionParams.v4.text.mimeTypes.includes(Constants.Exports.JIIX)\n    && editor.configuration.recognitionParams.v4.text.smartGuide) {\n    // eslint-disable-next-line no-use-before-define\n    launchSmartGuide(editorRef, modelRef.exports);\n  }\n\n  if ((InkModel.extractPendingStrokes(model).length > 0) &&\n    (!editor.recognizer.addStrokes) && // FIXME: Ugly hack to avoid double export (addStrokes + export)\n    (editor.configuration.triggers.exportContent !== Constants.Trigger.DEMAND)) {\n    /* eslint-disable no-use-before-define */\n    launchExport(editor, model);\n    /* eslint-enable no-use-before-define */\n  }\n}\n\n/**\n * Recognizer callback\n * @param {Editor} editor\n * @param {Object} error\n * @param {Model} model\n * @param {...String} events\n */\nfunction recognizerCallback(editor, error, model, ...events) {\n  const editorRef = editor;\n\n  const handleResult = (err, res, ...types) => {\n    if (err) {\n      if (err.type !== 'close') {\n        logger.error('Error while firing the recognition', err.stack || err); // Handle any error from all above steps\n      }\n      if (\n        // IInk error managment before refactor\n        (err.message === 'Invalid application key.') || (err.message === 'Invalid HMAC') ||\n        // CDK error managment\n        (err.error &&\n          err.error.result &&\n          err.error.result.error &&\n          (err.error.result.error === 'InvalidApplicationKeyException' || err.error.result.error === 'InvalidHMACSignatureException')) ||\n        // IInk error managment after refactor\n        (err.code && err.code === 'access.not.granted')) {\n        editorRef.error.innerText = Constants.Error.WRONG_CREDENTIALS;\n      } else if (err.message === 'Session is too old. Max Session Duration Reached' ||\n        (err.code && err.code === 'session.too.old')) {\n        editorRef.error.innerText = Constants.Error.TOO_OLD;\n      } else if ((err.message || err.code === 1006) && editorRef.error.style.display === 'none') {\n        editorRef.error.innerText = Constants.Error.NOT_REACHABLE;\n      }\n      if ((editorRef.error.innerText === Constants.Error.TOO_OLD || err.code === 1000 || err.reason === 'CLOSE_RECOGNIZER') && RecognizerContext.canReconnect(editor.recognizerContext)) {\n        logger.info('Reconnection is available', err.stack || err);\n        editorRef.error.style.display = 'none';\n      } else {\n        editorRef.error.style.display = 'initial';\n        triggerCallbacks(editor, err, Constants.EventType.ERROR, ...types);\n      }\n    } else {\n      manageRecognizedModel(editorRef, res, ...[...events, ...types].filter((el, i, a) => i === a.indexOf(el))); // Remove duplicate events\n    }\n  };\n\n  logger.debug('recognition callback');\n  if (editor.undoRedoManager.updateModel && !error) {\n    editor.undoRedoManager.updateModel(editor.undoRedoContext, model, handleResult);\n  } else {\n    handleResult(error, model, ...events);\n  }\n}\n\n/**\n * Launch the recognition with all editor relative configuration and state.\n * @param {Editor} editor\n * @param {Model} model\n * @param {String} [trigger]\n */\nfunction addStrokes(editor, model, trigger = editor.configuration.triggers.addStrokes) {\n  if (editor.recognizer && editor.recognizer.addStrokes) {\n    editor.recognizerContext.initPromise\n      .then(() => {\n        // Firing addStrokes only if recognizer is configure to do it\n        if (isTriggerValid(editor, 'addStrokes', trigger)) {\n          manageResetState(editor.recognizer.reset, editor.recognizer.addStrokes, editor.recognizerContext, model, (err, res, ...types) => {\n            recognizerCallback(editor, err, res, ...types);\n          });\n        }\n      });\n  }\n}\n\n/**\n * Launch smartguide.\n * @param {Editor} editor\n * @param {Object} exports\n */\nfunction launchSmartGuide(editor, exports) {\n  const editorRef = editor;\n  editorRef.smartGuide = SmartGuide.launchSmartGuide(editor.smartGuide, exports);\n}\n\n/**\n * Launch ink import.\n * @param {Editor} editor\n * @param {Model} model\n * @param {PointerEvents} events\n */\nfunction launchPointerEvents(editor, model, events) {\n  if (editor.recognizer && editor.recognizer.pointerEvents) {\n    editor.recognizerContext.initPromise\n      .then(() => {\n        editor.recognizer.pointerEvents(editor.recognizerContext, model, events, (err, res, ...types) => {\n          recognizerCallback(editor, err, res, ...types);\n        });\n      });\n  }\n}\n\n/**\n * Launch the recognition with all editor relative configuration and state.\n * @param {Editor} editor\n * @param {Model} model\n * @param {String} [requestedMimeTypes]\n * @param {String} [trigger]\n */\nfunction launchExport(editor, model, requestedMimeTypes, trigger = editor.configuration.triggers.exportContent) {\n  if (editor.recognizer && editor.recognizer.export_) {\n    editor.recognizerContext.initPromise\n      .then(() => {\n        // Firing export only if recognizer is configure to do it\n        if (isTriggerValid(editor, 'exportContent', trigger)) {\n          const editorRef = editor;\n          window.clearTimeout(editor.exportTimer);\n          editorRef.exportTimer = window.setTimeout(() => {\n            manageResetState(editor.recognizer.reset, editor.recognizer.export_, editor.recognizerContext, model, (err, res, ...types) => {\n              recognizerCallback(editor, err, res, ...types);\n            }, requestedMimeTypes);\n          }, trigger === Constants.Trigger.QUIET_PERIOD ? editor.configuration.triggerDelay : 0);\n        }\n      });\n  }\n}\n\n/**\n * Launch the import.\n * @param {Editor} editor\n * @param {Model} model\n * @param {Blob} data\n */\nfunction launchImport(editor, model, data) {\n  if (editor.recognizer && editor.recognizer.import_) {\n    editor.recognizerContext.initPromise\n      .then(() => {\n        editor.recognizer.import_(editor.recognizerContext, model, data, (err, res, ...types) => {\n          recognizerCallback(editor, err, res, ...types);\n        });\n      });\n  }\n}\n\nfunction launchGetSupportedImportMimeTypes(editor, model) {\n  if (editor.recognizer && editor.recognizer.getSupportedImportMimeTypes) {\n    editor.recognizerContext.initPromise\n      .then(() => {\n        editor.recognizer.getSupportedImportMimeTypes(editor.recognizerContext, model, (err, res, ...types) => {\n          recognizerCallback(editor, err, res, ...types);\n        });\n      });\n  }\n}\n\n/**\n * Launch the convert with all editor relative configuration and state.\n * @param {Editor} editor\n * @param {Model} model\n * @param {String} conversionState\n */\nfunction launchConvert(editor, model, conversionState) {\n  if (editor.recognizer && editor.recognizer.convert) {\n    editor.recognizerContext.initPromise\n      .then(() => {\n        editor.recognizer.convert(editor.recognizerContext, model, (err, res, ...types) => {\n          recognizerCallback(editor, err, res, ...types);\n        }, conversionState);\n      });\n  }\n}\n\nfunction launchConfig(editor, model) {\n  if (editor.recognizer && editor.recognizer.sendConfiguration) {\n    editor.recognizerContext.initPromise\n      .then(() => {\n        editor.recognizer.sendConfiguration(editor.recognizerContext, model, (err, res, ...types) => {\n          recognizerCallback(editor, err, res, ...types);\n        });\n      });\n  }\n}\n\n/**\n * Launch the resize.\n * @param {Editor} editor\n * @param {Model} model\n */\nfunction launchResize(editor, model) {\n  if (editor.recognizer && editor.recognizer.resize) {\n    editor.recognizerContext.initPromise\n      .then(() => {\n        const editorRef = editor;\n        window.clearTimeout(editor.resizeTimer);\n        editorRef.resizeTimer = window.setTimeout(() => {\n          editor.recognizer.resize(editor.recognizerContext, model, (err, res, ...types) => {\n            recognizerCallback(editor, err, res, ...types);\n          }, editor.domElement);\n        }, editor.configuration.resizeTriggerDelay);\n      });\n    SmartGuide.resize(editor.smartGuide);\n  }\n}\n\n/**\n * Launch wait for idle\n * @param {Editor} editor\n * @param {Model} model\n */\nfunction launchWaitForIdle(editor, model) {\n  if (editor.recognizer && editor.recognizer.waitForIdle) {\n    editor.recognizerContext.initPromise\n      .then(() => {\n        editor.recognizer.waitForIdle(editor.recognizerContext, model, (err, res, ...types) => {\n          recognizerCallback(editor, err, res, ...types);\n        });\n      });\n  }\n}\n\n/**\n * Set pen style.\n * @param {Editor} editor\n * @param {Model} model\n */\nfunction setPenStyle(editor, model) {\n  if (editor.recognizer && editor.recognizer.setPenStyle) {\n    editor.recognizerContext.initPromise\n      .then(() => {\n        editor.recognizer.setPenStyle(editor.recognizerContext, model, editor.penStyle, (err, res, ...types) => {\n          recognizerCallback(editor, err, res, ...types);\n        });\n      });\n  }\n}\n\n/**\n * Set pen style.\n * @param {Editor} editor\n * @param {Model} model\n */\nfunction setPenStyleClasses(editor, model) {\n  if (editor.recognizer && editor.recognizer.setPenStyleClasses) {\n    editor.recognizerContext.initPromise\n      .then(() => {\n        editor.recognizer.setPenStyleClasses(editor.recognizerContext, model, editor.penStyleClasses, (err, res, ...types) => {\n          recognizerCallback(editor, err, res, ...types);\n        });\n      });\n  }\n}\n\n/**\n * Set theme.\n * @param {Editor} editor\n * @param {Model} model\n */\nfunction setTheme(editor, model) {\n  if (editor.recognizer && editor.recognizer.setTheme) {\n    editor.recognizerContext.initPromise\n      .then(() => {\n        editor.recognizer.setTheme(editor.recognizerContext, model, editor.theme, (err, res, ...types) => {\n          recognizerCallback(editor, err, res, ...types);\n        });\n      });\n  }\n}\n\n/**\n * Editor\n */\nexport class Editor {\n  /**\n   * @param {Element} element DOM element to attach this editor\n   * @param {Configuration} [configuration] Configuration to apply\n   * @param {Theme} [theme] Custom theme to apply\n   * @param {PenStyle} [penStyle] Custom style to apply\n   * @param {Behaviors} [behaviors] Custom behaviors to apply\n   */\n  constructor(element, configuration, penStyle, theme, behaviors) {\n    /**\n     * Inner reference to the DOM Element\n     * @type {Element}\n     */\n    this.domElement = element;\n    this.domElement.classList.add('ms-editor');\n\n    // eslint-disable-next-line no-undef\n    this.loader = document.createElement('div');\n    this.loader.classList.add('loader');\n    this.loader = this.domElement.appendChild(this.loader);\n\n    // eslint-disable-next-line no-undef\n    this.error = document.createElement('div');\n    this.error.classList.add('error-msg');\n    this.error = this.domElement.appendChild(this.error);\n\n    /**\n     * Launch export timer\n     * @type {Number}\n     */\n    this.exportTimer = undefined;\n\n    /**\n     * Launch resize timer\n     * @type {Number}\n     */\n    this.resizeTimer = undefined;\n\n    /**\n     * Notify delay timer\n     * @type {Number}\n     */\n    this.notifyTimer = undefined;\n\n\n    /**\n     * @private\n     * @type {Behaviors}\n     */\n    this.innerBehaviors = DefaultBehaviors.overrideDefaultBehaviors(behaviors);\n    this.configuration = configuration;\n    this.smartGuide = SmartGuide.createSmartGuide(this);\n\n    /**\n     * Pen color used only for pending stroke\n     * @type {string}\n     */\n    this.localTheme = '';\n\n    this.theme = theme;\n    this.penStyle = penStyle;\n    this.penStyleClasses = '';\n\n    this.domElement.editor = this;\n  }\n\n  /**\n   * Set the recognition parameters\n   * WARNING : Need to fire a clear if user have already input some strokes.\n   * @param {Configuration} configuration\n   */\n  set configuration(configuration) {\n    this.loader.style.display = 'initial';\n    this.error.style.display = 'none';\n    /**\n     * @private\n     * @type {Configuration}\n     */\n    this.innerConfiguration = DefaultConfiguration.overrideDefaultConfiguration(configuration);\n    this.setThemeForFont(this.innerConfiguration.recognitionParams.v4.lang);\n    this.behavior = this.behaviors.getBehaviorFromConfiguration(this.behaviors, this.innerConfiguration);\n  }\n\n  /**\n   * Get the current recognition parameters\n   * @return {Configuration}\n   */\n  get configuration() {\n    return this.innerConfiguration;\n  }\n\n  /**\n   * Set the pen style\n   * @param {PenStyle} penStyle\n   */\n  set penStyle(penStyle) {\n    /**\n     * @private\n     * @type {PenStyle}\n     */\n    this.innerPenStyle = DefaultStyles.overrideDefaultPenStyle(penStyle);\n    this.localPenStyle = this.innerPenStyle;\n    setPenStyle(this, this.model);\n  }\n\n  /**\n   * Get the pen style\n   * @return {PenStyle}\n   */\n  get penStyle() {\n    return this.innerPenStyle;\n  }\n\n  /**\n   * Set the pen style\n   * @param {String} penStyleClasses\n   */\n  set penStyleClasses(penStyleClasses) {\n    /**\n     * @private\n     * @type {String}\n     */\n    this.innerPenStyleClasses = penStyleClasses;\n    this.localPenStyle = this.theme[`.${this.innerPenStyleClasses}`];\n    setPenStyleClasses(this, this.model);\n  }\n\n  /**\n   * Get the pen style\n   * @return {String}\n   */\n  get penStyleClasses() {\n    return this.innerPenStyleClasses;\n  }\n\n  /**\n   * Set the theme\n   * @param {Theme} theme\n   */\n  set theme(theme) {\n    /**\n     * @private\n     * @type {Theme}\n     */\n    this.innerTheme = DefaultTheme.overrideDefaultTheme(theme);\n    setTheme(this, this.model);\n  }\n\n  /**\n   * Get the theme\n   * @return {Theme}\n   */\n  get theme() {\n    return this.innerTheme;\n  }\n\n  /**\n   * Get behaviors\n   * @return {Behaviors}\n   */\n  get behaviors() {\n    return this.innerBehaviors;\n  }\n\n  /**\n   * @private\n   * @param {Behavior} behavior\n   */\n  set behavior(behavior) {\n    if (behavior) {\n      if (this.grabber) { // Remove event handlers to avoid multiplication (detach grabber)\n        this.grabber.detach(this.domElement, this.grabberContext);\n      }\n      /**\n       * @private\n       * @type {Behavior}\n       */\n      this.innerBehavior = behavior;\n      this.renderer = this.innerBehavior.renderer;\n      this.recognizer = this.innerBehavior.recognizer;\n      /**\n       * Current grabber context\n       * @type {GrabberContext}\n       */\n      this.grabberContext = this.grabber.attach(this.domElement, this);\n    }\n  }\n\n  /**\n   * Get current behavior\n   * @return {Behavior}\n   */\n  get behavior() {\n    return this.innerBehavior;\n  }\n\n  /**\n   * Set the current recognizer\n   * @private\n   * @param {Recognizer} recognizer\n   */\n  set recognizer(recognizer) {\n    this.undoRedoContext = UndoRedoContext.createUndoRedoContext(this.configuration);\n    this.undoRedoManager = UndoRedoManager;\n\n    const initialize = (model) => {\n      /**\n       * @private\n       * @type {Recognizer}\n       */\n      this.innerRecognizer = recognizer;\n      if (this.innerRecognizer) {\n        /**\n         * Current recognition context\n         * @type {RecognizerContext}\n         */\n        this.recognizerContext = RecognizerContext.createEmptyRecognizerContext(this);\n        // FIXME: merge undo/redo manager with default recognizer\n        if (this.innerRecognizer.undo && this.innerRecognizer.redo && this.innerRecognizer.clear) {\n          this.undoRedoContext = this.recognizerContext;\n          this.undoRedoManager = this.innerRecognizer;\n        }\n\n        this.innerRecognizer.init(this.recognizerContext, model, (err, res, ...types) => {\n          logger.debug('Recognizer initialized', res);\n          this.loader.style.display = 'none';\n          recognizerCallback(this, err, res, ...types);\n        });\n      }\n    };\n\n    if (recognizer) {\n      if (this.innerRecognizer) {\n        this.innerRecognizer.close(this.recognizerContext, this.model, (err, res, ...types) => {\n          logger.info('Recognizer closed');\n          recognizerCallback(this, err, res, ...types);\n          initialize(InkModel.clearModel(res));\n        });\n      } else {\n        /**\n         * Current model\n         * @type {Model}\n         */\n        this.model = InkModel.createModel(this.configuration);\n\n        // INFO: Recognizer needs model to be initialized\n        initialize(this.model);\n      }\n    }\n  }\n\n  /**\n   * Get current recognizer\n   * @return {Recognizer}\n   */\n  get recognizer() {\n    return this.innerRecognizer;\n  }\n\n  /**\n   * Set the current renderer\n   * @private\n   * @param {Renderer} renderer\n   */\n  set renderer(renderer) {\n    if (renderer) {\n      if (this.innerRenderer) {\n        this.innerRenderer.detach(this.domElement, this.rendererContext);\n      }\n\n      /**\n       * @private\n       * @type {Renderer}\n       */\n      this.innerRenderer = renderer;\n      if (this.innerRenderer) {\n        /**\n         * Current rendering context\n         * @type {Object}\n         */\n        this.rendererContext = this.innerRenderer.attach(this.domElement, this.configuration.renderingParams.minHeight, this.configuration.renderingParams.minWidth);\n      }\n    }\n  }\n\n  /**\n   * Get current renderer\n   * @return {Renderer}\n   */\n  get renderer() {\n    return this.innerRenderer;\n  }\n\n  /**\n   * Get current grabber\n   * @return {Grabber}\n   */\n  get grabber() {\n    return this.behavior ? this.behavior.grabber : undefined;\n  }\n\n  /**\n   * Get current stroker\n   * @return {Stroker}\n   */\n  get stroker() {\n    return this.behavior ? this.behavior.stroker : undefined;\n  }\n\n  /**\n   * Get current callbacks\n   * @return {Array}\n   */\n  get callbacks() {\n    return this.behavior ? this.behavior.callbacks : undefined;\n  }\n\n  /**\n   * Get a PNG image data url from the data model\n   * @return {String}\n   */\n  get png() {\n    return ImageRenderer.getImage(this.model, this.stroker);\n  }\n\n  /**\n   * Get statistics to monitor what ink size is send to the server.\n   * @return {Stats}\n   */\n  getStats() {\n    return ModelStats.computeStats(this.model);\n  }\n\n  /**\n   * True if initialized, false otherwise\n   * @return {Boolean}\n   */\n  get initialized() {\n    return this.recognizerContext ? this.recognizerContext.initialized : false;\n  }\n\n  /**\n   * Handle a pointer down\n   * @param {{x: Number, y: Number, t: Number}} point Captured point coordinates\n   * @param {String} [pointerType=mouse] Current pointer type\n   * @param {String} [pointerId] Current pointer id\n   */\n  pointerDown(point, pointerType = 'pen', pointerId) {\n    logger.trace('Pointer down', point);\n    window.clearTimeout(this.notifyTimer);\n    window.clearTimeout(this.exportTimer);\n    this.model = InkModel.initPendingStroke(this.model, point, Object.assign({ pointerType, pointerId }, this.theme.ink, this.localPenStyle));\n    this.renderer.drawCurrentStroke(this.rendererContext, this.model, this.stroker);\n    // Currently no recognition on pointer down\n  }\n\n  /**\n   * Handle a pointer move\n   * @param {{x: Number, y: Number, t: Number}} point Captured point coordinates\n   */\n  pointerMove(point) {\n    logger.trace('Pointer move', point);\n    this.model = InkModel.appendToPendingStroke(this.model, point);\n    this.renderer.drawCurrentStroke(this.rendererContext, this.model, this.stroker);\n    // Currently no recognition on pointer move\n  }\n\n  /**\n   * Handle a pointer up\n   * @param {{x: Number, y: Number, t: Number}} point Captured point coordinates\n   */\n  pointerUp(point) {\n    logger.trace('Pointer up', point);\n    this.model = InkModel.endPendingStroke(this.model, point, this.penStyle);\n    this.renderer.drawModel(this.rendererContext, this.model, this.stroker);\n\n    if (this.recognizer.addStrokes) {\n      addStrokes(this, this.model);\n    } else {\n      // Push model in undo redo manager\n      recognizerCallback(this, undefined, this.model);\n    }\n  }\n\n  removeStroke(stroke) {\n    this.model.strokeGroups.forEach((group) => {\n      const stringStrokes = group.strokes.map(strokeFromGroup => JSON.stringify(strokeFromGroup));\n      const strokeIndex = stringStrokes.indexOf(JSON.stringify(stroke));\n      if (strokeIndex !== -1) {\n        group.strokes.splice(strokeIndex, 1);\n      }\n    });\n    const stringRawStrokes = this.model.rawStrokes.map(strokes => JSON.stringify(strokes));\n    const strokeIndex = stringRawStrokes.indexOf(JSON.stringify(stroke));\n    if (strokeIndex !== -1) {\n      this.model.rawStrokes.splice(strokeIndex, 1);\n    }\n    this.renderer.drawModel(this.rendererContext, this.model, this.stroker);\n    recognizerCallback(this, undefined, this.model);\n    if (!(this.configuration.triggers.exportContent === 'DEMAND')) {\n      launchExport(this, this.model);\n    }\n  }\n\n  /**\n   * @Deprecated\n   * @param rawStrokes\n   * @param strokeGroups\n   */\n  reDraw(rawStrokes, strokeGroups) {\n    rawStrokes.forEach((stroke) => {\n      InkModel.addStroke(this.model, stroke);\n    });\n    strokeGroups.forEach((group) => {\n      group.strokes.forEach((strokeFromGroup) => {\n        InkModel.addStrokeToGroup(this.model, strokeFromGroup, group.penStyle);\n      });\n    });\n    this.renderer.drawModel(this.rendererContext, this.model, this.stroker);\n    recognizerCallback(this, undefined, this.model);\n  }\n\n  /**\n   * True if idle state\n   * @return {Boolean}\n   */\n  get idle() {\n    return this.recognizerContext.idle;\n  }\n\n  /**\n   * Wait for idle state.\n   */\n  waitForIdle() {\n    triggerCallbacks(this, undefined, Constants.EventType.IDLE);\n    launchWaitForIdle(this, this.model);\n  }\n\n  /**\n   * True if can undo, false otherwise.\n   * @return {Boolean}\n   */\n  get canUndo() {\n    return this.undoRedoContext.canUndo;\n  }\n\n  /**\n   * Undo the last action.\n   */\n  undo() {\n    logger.debug('Undo current model', this.model);\n    triggerCallbacks(this, undefined, Constants.EventType.UNDO);\n    this.undoRedoManager.undo(this.undoRedoContext, this.model, (err, res, ...types) => {\n      manageRecognizedModel(this, res, ...types);\n    });\n  }\n\n  /**\n   * True if can redo, false otherwise.\n   * @return {Boolean}\n   */\n  get canRedo() {\n    return this.undoRedoContext.canRedo;\n  }\n\n  /**\n   * Redo the last action.\n   */\n  redo() {\n    logger.debug('Redo current model', this.model);\n    triggerCallbacks(this, undefined, Constants.EventType.REDO);\n    this.undoRedoManager.redo(this.undoRedoContext, this.model, (err, res, ...types) => {\n      manageRecognizedModel(this, res, ...types);\n    });\n  }\n\n  /**\n   * True if empty, false otherwise\n   * @returns {boolean}\n   */\n  get isEmpty() {\n    return this.recognizerContext.isEmpty;\n  }\n\n  /**\n   * True if can clear, false otherwise.\n   * @return {Boolean}\n   */\n  get canClear() {\n    return this.canUndo && this.model.rawStrokes.length > 0;\n  }\n\n  /**\n   * Clear the output and the recognition result.\n   */\n  clear() {\n    logger.debug('Clear current model', this.model);\n    triggerCallbacks(this, undefined, Constants.EventType.CLEAR);\n    this.recognizer.clear(this.recognizerContext, this.model, (err, res, ...types) => {\n      recognizerCallback(this, err, res, ...types);\n    });\n  }\n\n  /**\n   * True if can convert, false otherwise.\n   * @return {Boolean}\n   */\n  get canConvert() {\n    return this.canUndo && this.canClear && this.recognizer && this.recognizer.convert;\n  }\n\n  /**\n   * Convert the current content\n   */\n  convert(conversionState = 'DIGITAL_EDIT') {\n    if (this.canConvert) {\n      triggerCallbacks(this, undefined, Constants.EventType.CONVERT);\n      launchConvert(this, this.model, conversionState);\n    }\n  }\n\n  /**\n   * Set the guides for text\n   * @param {Boolean} [enable]\n   */\n  setGuides(enable = true) {\n    this.configuration.recognitionParams.v4.text.guides.enable = enable;\n    launchConfig(this, this.model);\n  }\n\n  /**\n   * Return the position of the cursor identifying the current state in the internal iink undo/redo stack.\n   * @returns {Number}\n   */\n  get possibleUndoCount() {\n    return this.recognizerContext.possibleUndoCount;\n  }\n\n  /**\n   * The number of operations that it is currently possible to undo.\n   * @returns {Number}\n   */\n  get undoStackIndex() {\n    return this.recognizerContext.undoStackIndex;\n  }\n\n  /**\n   * True if can export, false otherwise.\n   * @return {Boolean}\n   */\n  get canExport() {\n    return this.canUndo && this.canClear && this.recognizer && this.recognizer.getInfo().availableTriggers.exportContent.includes(Constants.Trigger.DEMAND);\n  }\n\n  /**\n   * Explicitly ask to perform an export. You have to listen to events to get the content as this function is non blocking and does not have a return type.\n   * @param {Array<String>} requestedMimeTypes Requested mime-types. Be sure to ask all the types required by the listeners of exported event.\n   */\n  export_(requestedMimeTypes) {\n    if (this.canExport) {\n      triggerCallbacks(this, undefined, Constants.EventType.EXPORT);\n      launchExport(this, this.model, requestedMimeTypes, Constants.Trigger.DEMAND);\n    }\n  }\n\n  /**\n   * Import content.\n   * @param {Blob|*} data Data to import\n   * @param {String} [mimetype] Mimetype of the data, needed if data is not a Blob\n   */\n  import_(data, mimetype) {\n    triggerCallbacks(this, undefined, Constants.EventType.IMPORT);\n    launchImport(this, this.model, !(data instanceof Blob) ? new Blob([data], { type: mimetype }) : data);\n  }\n\n  /**\n   * Get supported import mime types\n   */\n  getSupportedImportMimeTypes() {\n    launchGetSupportedImportMimeTypes(this, this.model);\n  }\n\n  /**\n   * pointer events\n   * @param {PointerEvents} events\n   */\n  pointerEvents(events) {\n    launchPointerEvents(this, this.model, events);\n  }\n\n  /**\n   * Get current state exports\n   * @return {Object}\n   */\n  get exports() {\n    return this.model ? this.model.exports : undefined;\n  }\n\n  get supportedImportMimeTypes() {\n    return this.recognizerContext.supportedImportMimeTypes;\n  }\n\n  /**\n   * Function to call when the dom element link to the current ink paper has been resize.\n   */\n  resize() {\n    logger.debug('Resizing editor');\n    this.renderer.resize(this.rendererContext, this.model, this.stroker, this.configuration.renderingParams.minHeight, this.configuration.renderingParams.minWidth);\n    launchResize(this, this.model);\n  }\n\n  /**\n   * Set the theme (font family, font size and line height) depending on the language\n   * @param lang\n   */\n  setThemeForFont(lang) {\n    const defaultLang = !Object.keys(Constants.Languages).includes(lang);\n    const armenian = lang === 'hy_AM';\n    const fontFamily = defaultLang || armenian ? Constants.Languages.default : Constants.Languages[lang];\n    const lineHeight = defaultLang || armenian ? '1.2' : '1.8';\n    this.theme = {\n      '.text': {\n        'font-family': fontFamily,\n        'line-height': lineHeight\n      }\n    };\n  }\n\n  /**\n   * Detach event listeners from the DOM element created at editor creation.\n   */\n  unload() {\n    if (this.grabber) { // Remove event handlers to avoid multiplication (detach grabber)\n      this.grabber.detach(this.domElement, this.grabberContext);\n    }\n    if (this.innerRenderer) {\n      this.innerRenderer.detach(this.domElement, this.rendererContext);\n    }\n  }\n\n  /**\n   * Trigger the change callbacks (and by default send a change event).\n   */\n  forceChange() {\n    triggerCallbacks(this, undefined, Constants.EventType.CHANGED);\n  }\n\n  /* eslint-disable class-methods-use-this */\n  /**\n   * Get access to some easter egg features link ink injection. Use at your own risk (less tested and may be removed without notice).\n   */\n  get eastereggs() {\n    return eastereggs;\n  }\n  /* eslint-enable class-methods-use-this */\n}\n","import { utilLogger as logger } from '../configuration/LoggerConfig';\nimport * as Cdkv3RestTextRecognizer from '../recognizer/rest/v3/Cdkv3RestTextRecognizer';\nimport * as RecognizerContext from '../model/RecognizerContext';\nimport defaultConfiguration from '../configuration/DefaultConfiguration';\n\n/**\n * @typedef {Object} Stats\n * @property {Number} strokesCount=0\n * @property {Number} pointsCount=0\n * @property {Number} byteSize=0\n * @property {Number} humanSize=0\n * @property {String} humanUnit=BYTE\n */\n\n/**\n * @param {Model} model Current model\n * @return {Stats} Statistics about recognition\n */\nexport function computeStats(model) {\n  const stats = { strokesCount: 0, pointsCount: 0, byteSize: 0, humanSize: 0, humanUnit: 'BYTE' };\n  if (model.rawStrokes) {\n    stats.strokesCount = model.rawStrokes.length;\n\n    const restMessage = Cdkv3RestTextRecognizer.buildInput(RecognizerContext.createEmptyRecognizerContext({ configuration: defaultConfiguration }), model);\n    stats.pointsCount = model.rawStrokes.map(stroke => stroke.x.length).reduce((a, b) => a + b, 0);\n    // We start with 270 as it is the size in bytes. Make a real computation implies to recode a doRecognition\n    const byteSize = restMessage.textInput.length;\n    stats.byteSize = byteSize;\n    if (byteSize < 270) {\n      stats.humanUnit = 'BYTE';\n      stats.byteSize = 0;\n      stats.humanSize = 0;\n    } else if (byteSize < 2048) {\n      stats.humanUnit = 'BYTES';\n      stats.humanSize = byteSize;\n    } else if (byteSize < 1024 * 1024) {\n      stats.humanUnit = 'KiB';\n      stats.humanSize = (byteSize / 1024).toFixed(2);\n    } else {\n      stats.humanUnit = 'MiB';\n      stats.humanSize = (byteSize / 1024 / 1024).toFixed(2);\n    }\n  }\n  logger.info('Stats', stats);\n  return stats;\n}\n","import * as languagesJson from './configuration/languages.json';\nimport * as languagesJsonV3 from './configuration/languagesV3.json';\nimport { editorLogger as logger } from './configuration/LoggerConfig';\nimport { Editor } from './Editor';\nimport * as DefaultConfiguration from './configuration/DefaultConfiguration';\n\n/**\n * Attach an Editor to a DOMElement\n * @param {Element} element DOM element to attach an editor\n * @param {Configuration} [configuration] Configuration to apply\n * @param {PenStyle} [penStyle] Pen style to apply\n * @param {Theme} [theme] Theme to apply\n * @param {Behaviors} [behaviors] Custom behaviors to apply\n * @return {Editor} New editor\n */\nexport function register(element, configuration, penStyle, theme, behaviors) {\n  logger.debug('Registering a new editor');\n  return new Editor(element, configuration, penStyle, theme, behaviors);\n}\n\n/**\n * Return the list of available recognition languages\n * @param {Configuration} [configuration] Configuration to get the languages\n * @return {JSON} A list of available languages\n */\nexport function getAvailableLanguageList(configuration) {\n  const innerConfiguration = DefaultConfiguration.overrideDefaultConfiguration(configuration);\n  return innerConfiguration.recognitionParams.apiVersion === 'V4' ? languagesJson : languagesJsonV3;\n}\n","import Constants from './configuration/Constants';\nimport LoggerConfig from './configuration/LoggerConfig';\nimport DefaultConfiguration from './configuration/DefaultConfiguration';\nimport DefaultPenStyle from './configuration/DefaultPenStyle';\nimport DefaultTheme from './configuration/DefaultTheme';\nimport DefaultBehaviors from './configuration/DefaultBehaviors';\nimport * as InkModel from './model/InkModel';\nimport { Editor } from './Editor';\nimport { register, getAvailableLanguageList } from './EditorFacade';\nimport * as RecognizerContext from './model/RecognizerContext';\n\nconst MyScript = {\n  Constants,\n  // Default instantiations\n  DefaultConfiguration,\n  DefaultBehaviors,\n  DefaultPenStyle,\n  DefaultTheme,\n  // Helper functions\n  register,\n  getAvailableLanguageList,\n  // Internals\n  LoggerConfig,\n  Editor,\n  InkModel,\n  RecognizerContext,\n};\n\nexport {\n  MyScript as default,\n  Constants,\n  // Default instantiations\n  DefaultConfiguration,\n  DefaultBehaviors,\n  DefaultPenStyle,\n  DefaultTheme,\n  // Helper functions\n  register,\n  getAvailableLanguageList,\n  // Internals\n  LoggerConfig,\n  Editor,\n  InkModel,\n  RecognizerContext,\n};\n\n"],"names":["Constants","log","loglevel","root","definition","this","noop","undefinedType","logMethods","bindMethod","obj","methodName","method","bind","Function","prototype","call","e","apply","arguments","replaceLoggingMethods","level","loggerName","i","length","methodFactory","debug","defaultMethodFactory","console","undefined","realMethod","Logger","name","defaultLevel","factory","currentLevel","self","storageKey","getPersistedLevel","storedLevel","window","localStorage","ignore","cookie","document","location","indexOf","encodeURIComponent","exec","slice","levels","TRACE","DEBUG","INFO","WARN","ERROR","SILENT","getLevel","setLevel","persist","toUpperCase","levelNum","levelName","persistLevelIfPossible","setDefaultLevel","enableAll","disableAll","initialLevel","defaultLogger","_loggersByName","getLogger","TypeError","logger","_log","noConflict","getLoggers","module","exports","editorLogger","EDITOR","LogLevel","SMARTGUIDE","modelLogger","MODEL","grabberLogger","GRABBER","rendererLogger","RENDERER","recognizerLogger","RECOGNIZER","callbackLogger","CALLBACK","utilLogger","UTIL","value","receiver","objects","Symbol","Object","getOwnPropertySymbols","isEnumerable","propertyIsEnumerable","target","len","provider","names","j","key","toString","val","type","Boolean","String","Number","constructor","Array","isArray","RegExp","Date","isBuffer","assign","isPrimitive","isObject","extend","assignSymbols","hasOwn","typeOf","hasOwnProperty","defaultConfiguration","overrideDefaultConfiguration","configuration","confRef","currentConfiguration","recognitionParams","server","useWindowLocation","scheme","protocol","host","t","o","n","r","l","m","c","d","defineProperty","configurable","enumerable","get","__esModule","default","p","s","iterator","toJSON","error","u","split","forEach","trim","substring","replace","_trimSemiColon","toCSS","defaultPenStyle","parser","JsonCSS","penStyle","css","defaultTheme","theme","floatPrecisionArray","roundFloat","oneFloat","requestedFloatPrecision","floatPrecision","Math","round","extractPoint","event","domElement","offsetTop","offsetLeft","eventRef","changedTouches","rect","getBoundingClientRect","clientX","left","clientLeft","xyFloatPrecision","clientY","top","clientTop","now","timestampFloatPrecision","element","editor","mMaxDiffX","unfocus","getSelection","removeAllRanges","hideMenu","evt","moreMenuInDocument","querySelector","classList","contains","style","display","hideCandidates","candidatesInDocument","tagName","context","listenerOptions","pointerDownOnEditor","id","activePointerId","pointerId","trace","button","buttons","stopPropagation","pointerDown","pointerType","smartGuidePointerDown","downSmartGuidePoint","pointerMove","point","diffX","abs","x","diffY","y","max","smartGuideIds","scrollbarClasses","pointerEnteredSmartGuide","relatedTarget","includes","className","pointerExitedSmartGuide","pointerMovedWords","pointerUp","listeners","item","types","addEventListener","listener","options","removeEventListener","drawStroke","stroke","stroker","ShapeSymbols","phi","angle","returnedAngle","PI","drawArrowHead","headPoint","alpha","beta","contextReference","save","fillStyle","strokeStyle","moveTo","beginPath","lineTo","cos","sin","fill","restore","drawShapeEllipse","shapeEllipse","points","centerPoint","maxRadius","minRadius","orientation","startAngle","sweepAngle","z1","z3","z2","z4","floor","boundariesPoints","atan2","cosAlpha","sinAlpha","push","drawEllipseArc","center","beginDecoration","beginTangentAngle","endDecoration","endTangentAngle","drawLine","p1","p2","drawShapeSymbol","symbol","lineWidth","width","color","elementType","shape","candidates","selectedCandidateIndex","table","lines","line","data","ellipse","shapeLine","firstPoint","lastPoint","recognizedShape","primitives","primitive","TextSymbols","drawTextLine","textLine","label","font","textHeight","textAlign","justificationType","textBaseline","fillText","topLeftPoint","height","underlineList","underline","delta","firstCharacter","lastCharacter","MusicClefs","gap","xAnchor","yAnchor","MusicSymbols","getMusicClefElements","keys","map","clef","src","svg","img","createElement","dataset","drawMusicSymbol","drawImage","canvas","parentElement","boundingBox","staff","count","computeDistance","xArray","yArray","lastIndexPoint","distance","sqrt","pow","isNaN","computeLength","lArray","createStrokeComponent","properties","addPoint","ret","strokeReference","ratio","pressure","parseFloat","computePressure","start","end","slicedStroke","getPointByIndex","index","mergeBounds","boundsA","boundsB","min","minX","maxX","minY","maxY","getLineBounds","getEllipseBounds","getTextLineBounds","getClefBounds","getStrokeBounds","getSymbolsBounds","symbols","boundsRef","MAX_VALUE","MIN_VALUE","filter","reduce","getDefaultSymbols","RecognitionType","MUSIC","defaultStaff","v3","musicParameter","defaultClef","getBoundingBox","getDefaultMusicSymbols","createModel","getTime","clearModel","model","modelReference","currentStroke","rawStrokes","strokeGroups","lastPositions","lastSentPosition","lastReceivedPosition","lastRenderedPosition","recognizedSymbols","rawResults","convert","needRedraw","addStroke","addStrokeToGroup","strokePenStyle","lastGroup","strokes","newStrokeGroup","strokeCopy","extractPendingStrokes","position","initPendingStroke","dpi","pxWidth","StrokeComponent","appendToPendingStroke","endPendingStroke","getBorderCoordinates","modelBounds","defaultSymbols","extractStrokesFromInkRange","firstStroke","lastStroke","slicedStrokes","updateModelSentPosition","updateModelReceivedPosition","resetModelPositions","updateModelRenderedPosition","extractPendingRecognizedSymbols","cloneModel","clonedModel","JSON","parse","stringify","mergeModels","models","a","b","modelRef","detectPixelRatio","getContext","devicePixelRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","getPixelRatio","createCanvas","add","appendChild","resizeContent","renderingCanvas","capturingCanvas","parentNode","clientWidth","minWidth","clientHeight","minHeight","pixelRatio","scale","drawSymbol","warn","drawModel","renderingCanvasContext","clearRect","InkModel","capturingCanvasContext","resources","removeChild","res","computeLinksPoints","radius","computeMiddlePoint","point1","point2","computeAxeAngle","begin","renderArc","arc","renderLine","linkPoints1","linkPoints2","renderQuadratic","ctrl","linkPoints3","quadraticCurveTo","nbquadratics","linkPoints","newAngle","closePath","xhtml","xlink","xml","xmlns","prefix","namespaces","space","local","fullname","namespace","ownerDocument","createElementNS","uri","namespaceURI","documentElement","none","selector","empty","matcher","matches","vendorMatches","webkitMatchesSelector","msMatchesSelector","mozMatchesSelector","oMatchesSelector","update","EnterNode","parent","datum","_next","_parent","__data__","child","insertBefore","next","querySelectorAll","keyPrefix","bindIndex","group","enter","exit","node","groupLength","dataLength","bindKey","keyValue","nodeByKeyValue","keyValues","ascending","NaN","defaultView","classArray","string","ClassList","_node","_names","getAttribute","classedAdd","list","classedRemove","remove","textRemove","textContent","htmlRemove","innerHTML","raise","nextSibling","lower","previousSibling","firstChild","constantNull","selection_cloneShallow","cloneNode","selection_cloneDeep","setAttribute","join","splice","filterEvents","mouseenter","mouseleave","filterContextListener","contextListener","related","compareDocumentPosition","event1","onRemove","typename","on","__on","capture","onAdd","wrap","dispatchEvent","params","CustomEvent","createEvent","initEvent","bubbles","cancelable","detail","Selection","groups","parents","_groups","_parents","insertAdjacentSVG","html","container","toLowerCase","lastChild","select","subgroups","subnode","subgroup","selectAll","match","size","each","enterGroup","updateGroup","previous","i0","i1","_enter","_exit","sparse","merge","selection","groups0","groups1","m0","m1","merges","group0","group1","order","sort","compare","compareNode","sortgroups","sortgroup","callback","nodes","attr","getAttributeNS","removeAttributeNS","removeAttribute","v","setAttributeNS","priority","removeProperty","setProperty","getPropertyValue","getComputedStyle","styleValue","property","classed","text","append","create","creator","insert","before","clone","deep","typenames","parseTypenames","dispatch","elementRef","fontSize","pendingRecognizedSymbols","patchUpdate","patch","updates","svgElementSelector","layer","insertAdjacentHTML","outerHTML","parentId","refId","pendingStrokes","symbolContext","parts","renderFinal","svgPath","CryptoJS","F","subtype","C","C_lib","lib","Base","overrides","mixIn","init","$super","instance","propertyName","WordArray","words","sigBytes","encoder","Hex","concat","wordArray","thisWords","thatWords","thisSigBytes","thatSigBytes","clamp","thatByte","ceil","random","nBytes","rcache","m_w","m_z","mask","result","_r","C_enc","enc","hexChars","bite","hexStr","hexStrLength","parseInt","substr","Latin1","latin1Chars","fromCharCode","latin1Str","latin1StrLength","charCodeAt","Utf8","decodeURIComponent","escape","Error","utf8Str","unescape","BufferedBlockAlgorithm","reset","_data","_nDataBytes","_append","_process","doFlush","dataWords","dataSigBytes","blockSize","blockSizeBytes","nBlocksReady","nWordsReady","_minBufferSize","nBytesReady","offset","_doProcessBlock","processedWords","C_algo","Hasher","cfg","_doReset","messageUpdate","finalize","hash","_doFinalize","_createHelper","hasher","message","_createHmacHelper","HMAC","algo","require$$0","X32WordArray","C_x64","x64","Word","high","low","toX32","x64Words","x64WordsLength","x32Words","x64Word","wordsLength","X64Word","X64WordArray","X64Word_create","K","W","SHA512","_hash","M","H","H0","H1","H2","H3","H4","H5","H6","H7","H0h","H0l","H1h","H1l","H2h","H2l","H3h","H3l","H4h","H4l","H5h","H5l","H6h","H6l","H7h","H7l","ah","al","bh","bl","ch","cl","dh","dl","eh","el","fh","fl","gh","gl","hh","hl","Wi","Wih","Wil","gamma0x","gamma0xh","gamma0xl","gamma0h","gamma0l","gamma1x","gamma1xh","gamma1xl","gamma1h","gamma1l","Wi7","Wi7h","Wi7l","Wi16","Wi16h","Wi16l","t1l","chh","chl","majh","majl","sigma0h","sigma0l","sigma1h","sigma1l","Ki","Kih","Kil","t1h","t2l","nBitsTotal","nBitsLeft","HmacSHA512","_hasher","hasherBlockSize","hasherBlockSizeBytes","oKey","_oKey","iKey","_iKey","oKeyWords","iKeyWords","innerHash","hmac","computeHmac","input","applicationKey","hmacKey","jsonInput","req","responseText","xhr","url","recognizerContext","apiVersion","mimeType","recognizerContextRef","Promise","resolve","reject","request","XMLHttpRequest","open","withCredentials","setRequestHeader","CryptoHelper","str","isBlobType","startsWith","responseType","onerror","msg","recoverable","onload","status","response","onreadystatechange","readyState","idle","send","then","post","createEmptyRecognizerContext","info","isResetRequired","updateRecognitionPositions","positions","instanceId","setRecognitionContext","recognitionContext","recognitionContexts","canReconnect","websocket","autoReconnect","currentReconnectionCount","maxRetryCount","shouldAttemptImmediateReconnect","LOST_CONNEXION_MESSAGE","CLOSE_RECOGNIZER_MESSAGE","postMessage","suffixUrl","buildMessage","NetworkInterface","recognizerContextReference","RecognizerContext","extractExports","textSegmentResult","selectedCandidateIdx","initPromise","initialized","EventType","LOADED","clear","CHANGED","EXPORTED","RENDERED","close","textRestV3Configuration","TEXT","Protocol","REST","Trigger","QUIET_PERIOD","DEMAND","buildInput","textParameter","inputUnits","components","textInput","Cdkv3CommonTextRecognizer","IDLE","resultCallback","catch","err","results","extractRecognizedSymbols","strokeList","scratchOutResults","inkRanges","scratchOutResult","erasedInkRanges","find","inkRange","component","mathRestV3Configuration","MATH","mathParameter","mathInput","Cdkv3RestRecognizerUtil","Cdkv3CommonMathRecognizer","CdkCommonUtil","getStyleFromInkRanges","extractShapeSymbols","segment","selectedCandidate","analyzerRestV3Configuration","ANALYZER","parameter","analyzerParameter","analyzerInput","extractRecognizedSymbolsFromAnalyzerResult","shapes","tables","textLines","extractSymbols","CONVERTED","shapeRestV3Configuration","SHAPE","shapeParameter","shapeInput","buildReset","segments","Cdkv3CommonShapeRecognizer","musicRestV3Configuration","musicInput","iinkRestConfiguration","DIAGRAM","RAWCONTENT","conversionState","buildData","dataConf","v4","lang","export","buildTextConf","math","buildMathConf","diagram","buildDiagramConf","recognition","buildRawContentConf","newStrokes","newGroup","DefaultPenStyle","charAt","DefaultTheme","requestedMimeTypes","callPostMessage","restConversionState","mimeTypes","openWebSocket","socket","WebSocket","websocketConfiguration","pingEnabled","pingDelay","maxPingLost","maxPingLostCount","pingLostCount","infinitePing","websocketRef","onopen","websocketCallback","onclose","onmessage","callBackParam","buildWebSocketCallback","destructuredPromise","challenge","buildHmacMessage","commonCallback","reconnect","buildUrl","destructuredInitPromise","promise","resolveParam","rejectParam","NetworkWSInterface","retry","func","sendMessage","code","reason","mathWebSocketV3Configuration","WEBSOCKET","POINTER_UP","buildMathInput","buildResetMessage","mathCallback","CdkWSRecognizerUtil","Cdkv3WSWebsocketBuilder","export_","err1","res1","textWebSocketV3Configuration","buildTextInput","textCallback","UUIDjs","getRandomInt","maxFromBits","bits","limitUI04","limitUI06","limitUI08","limitUI12","limitUI14","limitUI16","limitUI32","limitUI40","limitUI48","randomUI04","randomUI06","randomUI08","randomUI12","randomUI14","randomUI16","randomUI32","randomUI40","randomUI48","paddedString","z","fromParts","timeLow","timeMid","timeHiAndVersion","clockSeqHiAndReserved","clockSeqLow","version","hex","toURN","toBytes","ints","intPos","equals","uuid","UUID","getTimeFieldValues","time","ts","UTC","hm","mid","hi","timestamp","_create4","_create1","sequence","tick","tf","tl","thav","cshar","csl","fromTime","last","firstFromTime","lastFromTime","fromURN","strId","fromBytes","pos","octet","fromBinary","binary","new","newTS","sessionId","buildRestoreIInkSessionInput","buildNewContentPackageInput","hmacChallenge","iinkSessionId","contentPartCount","buildConfiguration","currentPartId","buildOpenContentPart","buildNewContentPart","partId","buildSetTheme","buildSetPenStyle","buildSetPenStyleClasses","penStyleClasses","canUndo","canRedo","isEmpty","possibleUndoCount","undoStackIndex","supportedImportMimeTypes","IInkWebSocketV4Configuration","NEBO","renderingParams","triggers","exportContent","buildAddStrokes","buildUndo","buildRedo","buildClear","buildConvert","state","buildZoom","buildResize","buildExport","requestedMimeType","buildImportFile","mimetype","buildImportChunk","lastChunk","buildPointerEvents","events","buildWaitForIdle","buildGetSupportedImportMimeTypes","iinkCallback","SUPPORTED_IMPORT_MIMETYPES","defaultBehaviors","PointerEventGrabber","QuadraticCanvasStroker","QuadraticSVGStroker","CanvasRenderer","SVGRenderer","Cdkv3RestTextRecognizer","Cdkv3RestMathRecognizer","Cdkv3RestAnalyzerRecognizer","Cdkv3RestShapeRecognizer","Cdkv3RestMusicRecognizer","iinkRestRecognizer","Cdkv3WSTextRecognizer","Cdkv3WSMathRecognizer","Cdkv4WSWebsocketBuilder","newContentPart","openContentPart","sendConfiguration","pointerEvents","addStrokes","undo","redo","noerr","newModel","import_","chunkSize","fileChunkSize","importFileId","blob","fileReader","FileReader","_this","readAsText","getSupportedImportMimeTypes","waitForIdle","resize","zoom","setPenStyle","setPenStyleClasses","setTheme","composed","behaviors","behavior","grabber","strokerList","getInfo","renderer","rendererList","recognizer","recognizerList","callbacks","updateUndoRedoState","undoRedoContext","undoRedoContextRef","currentPosition","stack","getModel","modelIndex","findIndex","modificationTime","undoRedoContextReference","maxSize","shift","borderCoordinates","margin","set","div","elMatches","Element","query","queryChildren","children","cls","main","thumb","rail","consuming","focus","active","scrolling","scrollingClassTimeout","addScrollingClass","clearTimeout","removeScrollingClass","setTimeout","isAlive","settings","scrollingThreshold","EventElement","handlers","prototypeAccessors","eventName","handler","unbind","this$1","unbindAll","every","defineProperties","EventManager","eventElements","initCustomEvent","eventElement","ee","once","onceHandler","processScrollDiff","axis","diff","useScrollingClass","forceFireReachEvent","fields","ref","contentHeight","containerHeight","scrollTop","up","down","reach","setScrollingClassInstantly","processScrollDiff$1","toInt","env","isWebKit","supportsTouch","DocumentTouch","supportsIePointer","navigator","msMaxTouchPoints","isChrome","test","userAgent","updateGeometry","containerWidth","contentWidth","scrollWidth","scrollHeight","scrollbarXRail","scrollbarYRail","suppressScrollX","scrollXMarginOffset","scrollbarXActive","railXWidth","railXMarginWidth","railXRatio","scrollbarXWidth","getThumbSize","scrollbarXLeft","negativeScrollAdjustment","scrollLeft","suppressScrollY","scrollYMarginOffset","scrollbarYActive","railYHeight","railYMarginHeight","railYRatio","scrollbarYHeight","scrollbarYTop","xRailOffset","isRtl","isScrollbarXUsingBottom","bottom","scrollbarXBottom","scrollbarXTop","yRailOffset","isScrollbarYUsingRight","right","scrollbarYRight","scrollbarYOuterWidth","scrollbarYLeft","scrollbarX","railBorderXWidth","scrollbarY","railBorderYWidth","updateCss","thumbSize","minScrollbarLength","maxScrollbarLength","bindMouseScrollHandler","pageY","startingScrollTop","startingMousePageY","scrollBy","mouseMoveHandler","preventDefault","mouseUpHandler","click-rail","direction","pageYOffset","pageX","pageXOffset","drag-thumb","keyboard","isDefaultPrevented","defaultPrevented","activeElement","contentDocument","shadowRoot","deltaX","deltaY","which","metaKey","altKey","shiftKey","wheelPropagation","shouldPreventDefault","wheel","mousewheelHandler","wheelDeltaX","wheelDeltaY","deltaMode","wheelDelta","getDeltaFromEvent","cursor","overflow","overflowX","overflowY","maxScrollTop","maxScrollLeft","shouldBeConsumedByChild","shouldPrevent","useBothWheelAxes","wheelSpeed","isTop","isBottom","offsetHeight","isLeft","isRight","offsetWidth","ctrlKey","onwheel","onmousewheel","touch","startOffset","startTime","speed","easingLoop","touchStart","touchMove","touchEnd","PointerEvent","MSPointerEvent","applyTouchMove","differenceX","differenceY","getTouch","targetTouches","shouldHandle","MSPOINTER_TYPE_MOUSE","clearInterval","currentOffset","currentTime","timeGap","magnitudeX","magnitudeY","scrollY","swipeEasing","setInterval","isInitialized","PerfectScrollbar","userSettings","nodeName","originalScrollLeft","blur","isNegativeScroll","railXStyle","borderLeftWidth","borderRightWidth","marginLeft","marginRight","railYStyle","styles","paddingLeft","paddingRight","outerWidth","borderTopWidth","borderBottomWidth","marginTop","marginBottom","handlerName","lastScrollTop","lastScrollLeft","onScroll","destroy","removePsClasses","selectedText","isReadOnly","hasAttribute","setSelectionRange","range","createRange","selectNodeContents","addRange","_select","_select2","_typeof","_createClass","props","descriptor","writable","Constructor","protoProps","staticProps","ClipboardAction","_classCallCheck","resolveOptions","initSelection","action","emitter","trigger","selectFake","selectTarget","isRTL","removeFake","fakeHandlerCallback","fakeHandler","fakeElem","border","padding","yPosition","copyText","succeeded","execCommand","handleResult","emit","clearSelection","_action","nodeType","_target","E","ctx","fn","off","_","evtArr","evts","liveEvents","HTMLElement","DOCUMENT_NODE_TYPE","proto","matchesSelector","useCapture","listenerFn","delegateTarget","closest","is","listenNode","nodeList","listenNodeList","delegate","body","listenSelector","_clipboardAction","_tinyEmitter","_goodListener","_clipboardAction2","_interopRequireDefault","_tinyEmitter2","_goodListener2","Clipboard","_Emitter","ReferenceError","_possibleConstructorReturn","__proto__","getPrototypeOf","listenClick","subClass","superClass","setPrototypeOf","_inherits","defaultAction","defaultTarget","defaultText","_this2","onClick","currentTarget","clipboardAction","getAttributeValue","actions","support","queryCommandSupported","suffix","attribute","require$$1","require$$2","isInShadow","addListeners","smartGuide","elementsRef","elements","textElement","smartGuideRef","randomString","Exports","JIIX","wordToChange","candidatesElement","word","showCandidates","candidate","innerText","jiixToImport","clickCandidate","ellipsisElement","positionActions","menuElement","isMenuInDocument","convertElement","copyElement","deleteElement","showActions","createSmartGuide","smartGuideElement","textContainer","tagElement","createHTMLElements","smartGuideFadeOut","enable","duration","MutationObserver","mutations","smartGuideTimeOutId","observe","childList","subtree","attributes","editorParam","delayBetweenStrokes","lastOneDelay","origGrabber","detach","setDelay","X","idx","Y","play","actionsArray","delay","currentAction","nextDelay","lastIndexOf","Event","strokeFromGroup","rendererContext","triggerCallbacks","editorRef","UNDO","REDO","CLEAR","CONVERT","EXPORT","canClear","canConvert","canExport","notifyTimer","processDelay","manageResetState","resetFunc","resetedModel","isTriggerValid","availableTriggers","manageRecognizedModel","creationTime","isSmartGuideInDocument","visibility","loader","maxWidthTextContainer","maxWidth","perfectScrollbar","createWordSpan","span","previousLabelExport","myFragment","createDocumentFragment","lastWord","tempWords","labelWordsArray","tempLabelWordsArray","wordChangedId","getElementById","SmartGuide","recognizerCallback","WRONG_CREDENTIALS","TOO_OLD","NOT_REACHABLE","undoRedoManager","updateModel","launchExport","exportTimer","triggerDelay","Editor","resizeTimer","innerBehaviors","currentBehaviors","getBehaviorFromConfiguration","DefaultBehaviors","localTheme","stats","strokesCount","pointsCount","byteSize","humanSize","humanUnit","restMessage","toFixed","ModelStats","ink","localPenStyle","drawCurrentStroke","strokeIndex","_this3","_this4","guides","IMPORT","Blob","resizeTriggerDelay","defaultLang","Languages","armenian","fontFamily","lineHeight","grabberContext","innerRenderer","innerConfiguration","DefaultConfiguration","setThemeForFont","currentStyle","innerPenStyle","innerPenStyleClasses","innerTheme","currentTheme","innerBehavior","attach","undoRedoMaxStackSize","UndoRedoManager","initialize","innerRecognizer","_this5","renderStructure","translate","toDataURL","ImageRenderer","eastereggs","register","getAvailableLanguageList","languagesJson","languagesJsonV3","MyScript"],"mappings":"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"}